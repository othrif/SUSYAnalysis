#pragma once

namespace
{

	template<typename T> inline T& select_period_array(int runnumber,T& D15, T& E15, T& F15, T& G15, T& H15, T& J15, T& A16, T& B16)
	{
		if(runnumber<=276954) return D15;
		if(runnumber<=279928) return E15;
		if(runnumber<=280422) return F15;
		if(runnumber<=281075) return G15;
		if(runnumber<=281411) return H15;
		if(runnumber<=284484) return J15;
		if(runnumber<=300287) return A16;
		if(runnumber<=300908) return B16;
		return B16;
	}

	double scalefactor_2eX_anyelectron(double pt_in_gev, double eta, double& unc,int runnumber, bool fullsim)
	{  // dumped from efficiencySF.DI_E_2015_e12_lhloose_L1EM10VH_2016_e17_lhvloose_nod0.MediumLLH_d0z0_v11_isolGradient.root
		static const double bins_pt[] = {7.0,10.0,13.0,15.0,16.0,18.0,21.0,25.0,27.0,30.0,32.5,35.0,37.5,40.0,42.5,45.0,50.0,60.0,80.0,1000.0};
		const int nbins_pt = sizeof(bins_pt)/sizeof(*bins_pt)-1;
		static const double bins_eta[] = {-2.47,-2.37,-2.01,-1.81,-1.52,-1.37,-1.15,-0.80,-0.60,-0.10,0.00,0.10,0.60,0.80,1.15,1.37,1.52,1.81,2.01,2.37,2.47};
		const int nbins_eta = sizeof(bins_eta)/sizeof(*bins_eta)-1;
		static const double fullsim_2015_val[nbins_pt][nbins_eta] = {
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.771,0.875,0.843,0.826,0.857,0.973,0.974,0.909,0.945,0.982,0.973,0.975,0.915,0.997,0.980,1.023,0.771,0.920,0.837,0.801},
			{0.872,0.929,0.950,0.880,0.801,0.957,0.953,0.925,0.977,0.970,1.020,0.975,0.957,0.943,0.979,0.926,0.864,0.970,0.928,0.945},
			{0.946,0.923,0.948,0.956,0.849,0.956,0.984,0.954,0.986,0.968,0.985,0.989,0.978,0.980,0.995,0.901,0.945,1.013,0.935,0.924},
			{0.952,0.957,0.960,0.975,0.894,0.978,0.987,0.961,0.988,0.997,1.000,0.995,0.985,0.989,0.985,0.921,0.978,0.996,0.956,0.935},
			{0.924,0.977,0.969,0.991,0.928,0.979,0.986,0.971,0.992,0.993,0.993,0.994,0.985,0.986,0.982,0.938,0.985,0.994,0.964,0.922},
			{0.956,0.967,0.972,0.997,0.949,0.969,0.975,0.969,0.991,0.987,0.989,0.996,0.982,0.983,0.983,0.954,0.988,0.996,0.960,0.971},
			{0.925,0.980,0.973,0.989,0.962,0.986,0.993,0.973,0.990,0.993,0.988,0.993,0.991,0.992,0.984,0.955,0.992,1.007,0.977,0.928},
			{0.924,0.990,0.974,0.995,0.945,0.982,0.983,0.974,0.993,0.990,0.990,0.994,0.983,0.988,0.982,0.951,1.005,1.005,0.998,0.957},
			{0.923,1.001,0.984,1.002,0.962,0.983,0.992,0.975,0.995,0.988,0.995,0.997,0.990,0.990,0.987,0.953,0.998,1.004,0.993,0.932},
			{0.930,0.991,0.985,1.001,0.955,0.995,0.990,0.978,0.992,0.992,1.000,0.996,0.989,0.991,0.993,0.960,0.999,1.004,0.998,0.958},
			{0.921,0.994,0.983,1.004,0.972,0.992,0.993,0.979,0.995,0.994,0.989,0.995,0.991,0.994,0.994,0.965,1.000,1.003,0.994,0.942},
			{0.916,1.000,0.986,1.002,0.963,0.992,0.991,0.981,0.995,0.993,0.989,0.994,0.990,0.993,0.995,0.962,0.999,1.004,0.996,0.919},
			{0.943,1.000,0.986,0.998,0.968,0.993,0.991,0.983,0.995,0.994,0.991,0.998,0.993,0.993,0.995,0.973,0.998,1.002,0.997,0.936},
			{0.941,0.993,0.982,1.001,0.976,0.994,0.993,0.982,0.996,0.996,0.991,0.998,0.994,0.991,0.995,0.966,0.997,1.003,0.995,0.949},
			{0.943,0.997,0.982,1.001,0.978,0.997,0.995,0.987,0.997,0.997,0.995,0.998,0.996,0.993,0.994,0.963,1.002,1.004,0.992,0.932},
			{0.918,0.997,0.979,1.005,0.977,1.000,0.995,0.984,0.998,0.999,0.995,1.000,0.997,1.001,1.002,0.973,1.003,1.004,0.993,0.960},
			{0.951,0.988,0.968,1.012,0.981,0.991,0.996,0.987,0.996,0.994,0.992,0.997,0.993,0.994,1.002,0.989,1.005,0.997,1.003,0.915}};

		static const double fullsim_2015_err[nbins_pt][nbins_eta] = {
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.038,0.016,0.026,0.024,0.055,0.017,0.013,0.028,0.015,0.043,0.036,0.013,0.028,0.015,0.018,0.060,0.023,0.023,0.016,0.037},
			{0.042,0.019,0.023,0.025,0.054,0.021,0.017,0.023,0.012,0.027,0.028,0.012,0.023,0.018,0.022,0.054,0.028,0.024,0.020,0.040},
			{0.026,0.012,0.016,0.013,0.036,0.012,0.009,0.011,0.006,0.015,0.017,0.006,0.011,0.009,0.011,0.031,0.013,0.015,0.011,0.023},
			{0.018,0.007,0.011,0.008,0.023,0.008,0.006,0.007,0.004,0.008,0.008,0.003,0.006,0.005,0.007,0.020,0.008,0.010,0.007,0.017},
			{0.012,0.005,0.007,0.005,0.013,0.005,0.004,0.004,0.002,0.004,0.004,0.002,0.004,0.003,0.005,0.011,0.005,0.006,0.005,0.012},
			{0.014,0.006,0.008,0.006,0.014,0.006,0.004,0.005,0.002,0.004,0.005,0.002,0.005,0.004,0.005,0.012,0.005,0.007,0.006,0.015},
			{0.011,0.004,0.006,0.004,0.010,0.004,0.002,0.003,0.001,0.003,0.003,0.002,0.003,0.002,0.004,0.008,0.004,0.005,0.004,0.011},
			{0.011,0.003,0.006,0.004,0.010,0.004,0.002,0.003,0.001,0.003,0.003,0.001,0.003,0.002,0.004,0.007,0.004,0.005,0.003,0.011},
			{0.010,0.003,0.005,0.003,0.007,0.003,0.002,0.002,0.001,0.003,0.003,0.001,0.002,0.002,0.003,0.006,0.003,0.004,0.003,0.011},
			{0.010,0.003,0.004,0.003,0.006,0.002,0.002,0.002,0.001,0.003,0.003,0.001,0.002,0.002,0.002,0.005,0.003,0.004,0.003,0.010},
			{0.010,0.003,0.004,0.003,0.005,0.002,0.001,0.002,0.001,0.002,0.002,0.001,0.002,0.001,0.002,0.005,0.003,0.004,0.003,0.010},
			{0.009,0.002,0.004,0.002,0.004,0.002,0.001,0.002,0.001,0.002,0.002,0.001,0.002,0.001,0.002,0.004,0.002,0.003,0.002,0.009},
			{0.008,0.002,0.003,0.002,0.004,0.002,0.001,0.002,0.001,0.002,0.002,0.001,0.001,0.001,0.002,0.004,0.002,0.003,0.002,0.009},
			{0.007,0.002,0.003,0.002,0.003,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.003,0.002,0.003,0.002,0.007},
			{0.009,0.002,0.004,0.002,0.004,0.002,0.001,0.002,0.001,0.002,0.002,0.001,0.001,0.001,0.002,0.004,0.002,0.003,0.003,0.010},
			{0.015,0.004,0.006,0.003,0.006,0.003,0.002,0.003,0.001,0.002,0.002,0.001,0.002,0.002,0.002,0.006,0.003,0.005,0.004,0.014},
			{0.025,0.007,0.011,0.006,0.011,0.005,0.003,0.004,0.002,0.004,0.005,0.002,0.004,0.003,0.004,0.009,0.006,0.009,0.007,0.028}};

		static const double fastsim_2015_val[nbins_pt][nbins_eta] = {
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.895,0.989,1.007,1.083,1.494,1.068,1.083,1.183,1.093,1.207,1.144,1.128,1.178,1.152,1.093,1.795,0.961,1.073,0.951,0.942},
			{0.969,1.047,1.058,1.015,1.135,1.036,1.031,1.010,1.045,1.030,1.108,1.043,1.056,1.039,1.078,1.298,1.027,1.083,1.046,1.054},
			{1.065,1.001,1.061,1.073,1.180,1.018,1.057,1.002,1.039,1.019,1.048,1.040,1.043,1.041,1.065,1.223,1.055,1.146,1.021,1.010},
			{1.081,1.027,1.072,1.076,1.180,1.044,1.042,1.002,1.026,1.039,1.045,1.033,1.028,1.043,1.049,1.173,1.082,1.103,1.038,1.050},
			{1.021,1.048,1.071,1.077,1.174,1.031,1.030,1.005,1.021,1.020,1.021,1.023,1.021,1.030,1.034,1.129,1.066,1.082,1.036,1.033},
			{1.055,1.045,1.068,1.077,1.144,1.020,1.009,1.005,1.016,1.009,1.020,1.022,1.018,1.021,1.035,1.114,1.061,1.080,1.032,1.108},
			{1.024,1.045,1.061,1.059,1.132,1.032,1.030,1.004,1.012,1.014,1.011,1.017,1.023,1.024,1.029,1.087,1.062,1.093,1.042,1.045},
			{1.028,1.047,1.063,1.060,1.078,1.031,1.016,1.003,1.015,1.012,1.010,1.017,1.013,1.021,1.029,1.061,1.074,1.084,1.058,1.082},
			{1.025,1.055,1.066,1.064,1.085,1.023,1.020,1.002,1.016,1.005,1.019,1.018,1.015,1.019,1.028,1.053,1.058,1.075,1.047,1.047},
			{1.037,1.039,1.063,1.063,1.056,1.033,1.017,1.002,1.012,1.010,1.024,1.017,1.012,1.017,1.028,1.050,1.059,1.070,1.047,1.073},
			{1.021,1.039,1.054,1.062,1.062,1.023,1.018,1.002,1.015,1.012,1.007,1.014,1.014,1.018,1.026,1.045,1.055,1.064,1.042,1.052},
			{1.002,1.047,1.055,1.056,1.035,1.021,1.014,1.002,1.012,1.009,1.004,1.011,1.010,1.016,1.025,1.029,1.050,1.062,1.041,1.007},
			{1.024,1.042,1.044,1.042,1.029,1.019,1.010,1.000,1.008,1.007,1.002,1.011,1.009,1.011,1.020,1.029,1.042,1.055,1.039,1.020},
			{1.013,1.026,1.033,1.041,1.031,1.015,1.010,0.997,1.007,1.006,1.001,1.010,1.009,1.007,1.016,1.015,1.034,1.049,1.032,1.030},
			{1.018,1.034,1.035,1.040,1.033,1.018,1.012,1.001,1.007,1.006,1.005,1.008,1.010,1.008,1.014,1.009,1.039,1.050,1.029,1.010},
			{0.981,1.032,1.027,1.045,1.024,1.021,1.011,0.998,1.009,1.006,1.002,1.011,1.010,1.018,1.022,1.013,1.043,1.052,1.030,1.037},
			{1.012,1.021,1.009,1.055,1.030,1.008,1.008,1.000,1.005,1.003,1.004,1.005,1.004,1.008,1.020,1.032,1.042,1.045,1.041,0.970}};

		static const double fastsim_2015_err[nbins_pt][nbins_eta] = {
			{4.560,2.250,3.329,2.669,4.116,2.977,12.679,3.936,3.304,8.566,7.755,3.307,3.783,2.522,2.984,5.383,2.711,3.229,2.305,4.554},
			{0.199,0.126,0.198,0.133,0.499,0.128,0.107,0.655,0.156,0.373,0.441,0.159,0.451,0.127,0.128,0.465,0.127,0.164,0.130,0.227},
			{0.048,0.020,0.034,0.036,0.110,0.021,0.017,0.041,0.019,0.060,0.048,0.018,0.040,0.020,0.022,0.120,0.032,0.030,0.021,0.048},
			{0.051,0.025,0.029,0.032,0.086,0.026,0.020,0.027,0.014,0.032,0.035,0.015,0.028,0.023,0.027,0.086,0.037,0.030,0.026,0.050},
			{0.033,0.014,0.020,0.017,0.056,0.015,0.011,0.013,0.007,0.018,0.020,0.008,0.014,0.011,0.014,0.048,0.016,0.020,0.014,0.028},
			{0.024,0.008,0.014,0.010,0.034,0.009,0.007,0.008,0.004,0.009,0.009,0.004,0.008,0.007,0.009,0.028,0.010,0.012,0.009,0.022},
			{0.015,0.006,0.009,0.006,0.019,0.006,0.004,0.005,0.002,0.005,0.005,0.002,0.005,0.004,0.005,0.015,0.006,0.008,0.006,0.016},
			{0.017,0.007,0.010,0.007,0.019,0.007,0.004,0.006,0.003,0.005,0.006,0.003,0.006,0.004,0.006,0.016,0.007,0.009,0.007,0.019},
			{0.013,0.005,0.007,0.005,0.013,0.004,0.003,0.004,0.002,0.003,0.004,0.002,0.003,0.003,0.004,0.011,0.005,0.006,0.005,0.014},
			{0.014,0.004,0.007,0.005,0.012,0.004,0.003,0.003,0.002,0.004,0.004,0.002,0.003,0.003,0.004,0.009,0.004,0.006,0.004,0.014},
			{0.013,0.004,0.006,0.004,0.009,0.004,0.002,0.003,0.001,0.003,0.003,0.001,0.002,0.002,0.003,0.008,0.004,0.005,0.004,0.013},
			{0.012,0.003,0.006,0.004,0.007,0.003,0.002,0.002,0.001,0.003,0.003,0.001,0.002,0.002,0.003,0.006,0.003,0.005,0.003,0.012},
			{0.012,0.003,0.005,0.003,0.006,0.002,0.002,0.002,0.001,0.003,0.003,0.001,0.002,0.002,0.002,0.006,0.003,0.004,0.003,0.012},
			{0.011,0.003,0.005,0.003,0.005,0.002,0.002,0.002,0.001,0.002,0.002,0.001,0.002,0.001,0.002,0.005,0.003,0.004,0.003,0.011},
			{0.010,0.003,0.004,0.003,0.005,0.002,0.001,0.002,0.001,0.002,0.002,0.001,0.002,0.001,0.002,0.005,0.003,0.004,0.003,0.010},
			{0.009,0.002,0.004,0.002,0.004,0.002,0.001,0.002,0.001,0.002,0.002,0.001,0.001,0.001,0.002,0.004,0.002,0.003,0.002,0.009},
			{0.011,0.003,0.005,0.003,0.005,0.002,0.001,0.002,0.001,0.002,0.002,0.001,0.002,0.001,0.002,0.005,0.003,0.004,0.003,0.012},
			{0.017,0.004,0.007,0.004,0.007,0.003,0.002,0.003,0.001,0.002,0.003,0.001,0.002,0.002,0.003,0.006,0.004,0.006,0.005,0.017},
			{0.030,0.009,0.012,0.007,0.012,0.005,0.003,0.005,0.002,0.005,0.006,0.002,0.004,0.004,0.005,0.011,0.007,0.011,0.009,0.033}};

		static const double fullsim_2016_val[nbins_pt][nbins_eta] = {
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.556,0.738,0.720,0.717,1.269,0.983,0.986,0.808,0.873,0.762,0.811,0.843,0.880,1.020,0.961,1.427,0.702,0.700,0.740,0.575},
			{0.951,0.977,0.967,0.916,1.034,1.002,0.995,0.983,0.994,0.972,0.984,0.991,0.996,1.003,1.001,1.002,0.897,0.974,0.963,0.925},
			{0.988,0.991,0.971,0.978,1.018,0.995,0.993,0.980,0.994,0.978,0.994,1.003,0.995,1.001,0.997,0.976,0.979,1.010,0.984,0.991},
			{0.958,0.989,0.984,0.996,0.996,1.004,1.002,0.987,0.996,0.989,0.997,0.998,0.996,1.000,1.004,0.989,0.991,1.014,1.005,0.968},
			{0.967,1.003,0.987,0.995,0.972,1.003,0.999,0.991,0.997,0.989,0.998,1.002,1.004,1.006,0.996,0.970,1.004,1.014,1.003,0.998},
			{0.993,1.006,0.985,1.009,0.991,1.003,0.998,0.990,0.999,0.985,0.999,1.001,1.000,1.004,1.009,0.978,1.000,1.007,1.006,0.999},
			{0.993,1.005,0.987,1.003,0.980,1.006,0.999,0.989,0.997,0.987,1.000,1.000,1.001,1.000,1.007,0.984,1.004,1.005,1.001,1.010},
			{0.966,1.001,0.990,1.004,1.004,1.004,0.999,0.992,0.999,0.995,0.996,1.000,1.000,1.002,1.004,1.000,1.001,1.008,1.006,0.984},
			{0.972,1.002,0.982,1.002,1.016,1.002,1.000,0.995,0.998,0.999,0.992,1.000,1.000,1.002,1.001,1.008,1.004,1.012,1.010,0.998},
			{0.975,1.000,0.986,1.006,1.016,1.004,0.998,0.993,0.999,0.999,0.995,1.000,1.001,1.002,1.002,1.007,1.004,1.010,0.998,1.002},
			{0.975,1.002,0.992,1.004,1.015,1.003,0.998,0.992,1.000,0.999,0.998,1.000,1.001,1.001,1.000,1.008,1.000,1.008,1.004,0.994},
			{0.979,1.002,0.990,1.005,1.016,1.004,1.000,0.992,0.999,1.000,0.999,1.001,1.001,0.999,1.002,1.001,1.002,1.011,1.001,0.994},
			{0.959,0.994,0.993,1.006,0.999,1.001,0.995,0.997,1.000,1.004,0.998,1.002,1.002,1.004,1.001,0.999,1.005,1.006,0.999,0.985},
			{0.950,0.988,0.989,1.008,0.999,1.005,1.002,0.988,1.000,0.997,1.004,1.002,0.996,1.003,1.004,1.002,1.002,1.013,0.998,0.980}};

		static const double fullsim_2016_err[nbins_pt][nbins_eta] = {
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.034,0.015,0.022,0.020,0.051,0.014,0.015,0.021,0.012,0.028,0.028,0.012,0.022,0.016,0.014,0.061,0.019,0.020,0.015,0.032},
			{0.015,0.005,0.008,0.008,0.020,0.005,0.004,0.006,0.003,0.007,0.007,0.003,0.005,0.004,0.005,0.020,0.008,0.007,0.005,0.015},
			{0.013,0.005,0.007,0.007,0.018,0.004,0.003,0.005,0.002,0.005,0.005,0.002,0.004,0.003,0.004,0.017,0.006,0.006,0.005,0.013},
			{0.012,0.004,0.006,0.005,0.015,0.003,0.002,0.003,0.002,0.004,0.004,0.002,0.003,0.002,0.003,0.013,0.005,0.006,0.004,0.012},
			{0.010,0.003,0.006,0.004,0.013,0.003,0.002,0.003,0.002,0.004,0.003,0.001,0.002,0.002,0.003,0.010,0.004,0.005,0.003,0.010},
			{0.009,0.003,0.005,0.003,0.010,0.003,0.002,0.002,0.001,0.003,0.003,0.001,0.002,0.002,0.002,0.008,0.003,0.004,0.003,0.010},
			{0.009,0.002,0.004,0.003,0.008,0.002,0.001,0.002,0.001,0.003,0.003,0.001,0.002,0.001,0.002,0.007,0.003,0.004,0.002,0.009},
			{0.009,0.002,0.004,0.003,0.007,0.002,0.001,0.002,0.001,0.002,0.002,0.001,0.002,0.001,0.002,0.005,0.003,0.003,0.002,0.008},
			{0.009,0.002,0.004,0.002,0.005,0.002,0.001,0.002,0.001,0.002,0.002,0.001,0.001,0.001,0.002,0.005,0.002,0.003,0.002,0.008},
			{0.008,0.002,0.004,0.002,0.005,0.002,0.001,0.002,0.001,0.002,0.002,0.001,0.001,0.001,0.002,0.004,0.002,0.003,0.002,0.008},
			{0.007,0.002,0.003,0.002,0.004,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.003,0.002,0.002,0.002,0.007},
			{0.009,0.002,0.004,0.002,0.004,0.002,0.001,0.002,0.001,0.002,0.002,0.001,0.001,0.001,0.002,0.004,0.002,0.003,0.002,0.008},
			{0.014,0.004,0.006,0.003,0.005,0.002,0.002,0.002,0.001,0.002,0.002,0.001,0.002,0.002,0.002,0.005,0.003,0.004,0.004,0.013},
			{0.026,0.006,0.009,0.006,0.009,0.004,0.003,0.004,0.002,0.004,0.004,0.002,0.003,0.003,0.004,0.008,0.005,0.008,0.006,0.025}};

		static const double fastsim_2016_val[nbins_pt][nbins_eta] = {
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.782,0.948,0.968,1.122,3.174,1.166,1.352,1.152,1.231,1.100,1.175,1.164,1.309,1.413,1.148,4.132,1.031,0.939,0.960,0.806},
			{1.066,1.047,1.072,1.052,1.634,1.058,1.055,1.039,1.041,1.029,1.042,1.037,1.055,1.072,1.064,1.548,0.995,1.053,1.032,1.032},
			{1.083,1.049,1.046,1.059,1.454,1.032,1.025,1.013,1.020,1.002,1.026,1.032,1.029,1.037,1.037,1.353,1.055,1.084,1.040,1.095},
			{1.043,1.034,1.062,1.065,1.335,1.038,1.032,1.014,1.017,1.014,1.020,1.022,1.021,1.030,1.036,1.277,1.052,1.084,1.059,1.061},
			{1.050,1.044,1.060,1.046,1.235,1.035,1.025,1.013,1.018,1.009,1.020,1.023,1.030,1.034,1.026,1.187,1.059,1.083,1.047,1.094},
			{1.082,1.047,1.049,1.064,1.230,1.033,1.022,1.011,1.019,1.002,1.020,1.021,1.021,1.029,1.041,1.141,1.050,1.062,1.046,1.103},
			{1.068,1.039,1.048,1.051,1.159,1.036,1.021,1.008,1.016,1.005,1.024,1.019,1.022,1.021,1.034,1.122,1.055,1.055,1.035,1.102},
			{1.037,1.034,1.051,1.053,1.162,1.029,1.019,1.011,1.017,1.013,1.016,1.017,1.017,1.023,1.028,1.108,1.046,1.055,1.040,1.056},
			{1.046,1.036,1.039,1.043,1.133,1.025,1.018,1.012,1.014,1.017,1.005,1.016,1.018,1.020,1.025,1.094,1.049,1.059,1.046,1.074},
			{1.040,1.031,1.035,1.044,1.113,1.026,1.013,1.009,1.012,1.009,1.007,1.012,1.015,1.018,1.022,1.072,1.042,1.052,1.028,1.081},
			{1.040,1.028,1.040,1.037,1.091,1.020,1.010,1.004,1.010,1.007,1.009,1.010,1.011,1.013,1.015,1.063,1.031,1.043,1.034,1.064},
			{1.046,1.030,1.037,1.037,1.077,1.021,1.014,1.003,1.008,1.010,1.007,1.011,1.011,1.011,1.019,1.045,1.032,1.048,1.027,1.061},
			{1.005,1.020,1.035,1.036,1.037,1.019,1.009,1.008,1.009,1.013,1.005,1.012,1.014,1.019,1.018,1.033,1.037,1.040,1.028,1.040},
			{0.997,1.007,1.024,1.040,1.035,1.021,1.014,0.994,1.007,1.003,1.016,1.010,1.004,1.017,1.023,1.032,1.029,1.050,1.022,1.037}};

		static const double fastsim_2016_err[nbins_pt][nbins_eta] = {
			{3.992,2.100,2.874,2.404,3.761,2.706,2.310,3.452,2.872,7.369,7.612,2.871,3.390,2.325,2.732,3.888,2.392,2.918,2.083,3.991},
			{3.334,1.591,2.147,1.889,2.991,2.221,1.650,2.263,1.697,4.308,4.260,1.713,2.291,1.639,2.227,2.957,1.797,2.116,1.594,3.131},
			{3.313,1.634,2.201,6.460,2.732,2.169,5.420,2.178,1.506,3.610,3.670,1.494,8.486,1.632,2.138,2.833,6.835,2.195,1.590,3.287},
			{4.331,2.202,2.792,19.941,3.515,19.610,12.205,2.835,1.892,4.491,4.427,1.852,2.920,2.202,7.480,3.516,24.980,2.881,2.202,4.327},
			{0.757,0.322,0.424,0.292,2.812,0.144,0.339,0.832,0.722,3.403,1.855,0.582,1.067,0.396,0.140,3.506,0.266,0.411,0.349,0.807},
			{0.053,0.021,0.032,0.035,0.140,0.018,0.024,0.033,0.019,0.046,0.045,0.018,0.037,0.024,0.019,0.194,0.031,0.030,0.021,0.050},
			{0.018,0.006,0.010,0.010,0.035,0.006,0.005,0.007,0.003,0.009,0.008,0.003,0.007,0.005,0.006,0.035,0.009,0.009,0.006,0.018},
			{0.016,0.006,0.009,0.008,0.029,0.005,0.004,0.005,0.002,0.006,0.006,0.002,0.005,0.004,0.005,0.027,0.007,0.008,0.006,0.016},
			{0.014,0.004,0.008,0.006,0.022,0.004,0.003,0.004,0.002,0.005,0.004,0.002,0.003,0.003,0.004,0.019,0.005,0.007,0.005,0.014},
			{0.012,0.004,0.007,0.004,0.018,0.003,0.002,0.003,0.002,0.004,0.004,0.002,0.003,0.002,0.003,0.014,0.004,0.006,0.004,0.012},
			{0.011,0.003,0.006,0.004,0.014,0.003,0.002,0.003,0.001,0.004,0.004,0.001,0.002,0.002,0.003,0.011,0.004,0.005,0.003,0.012},
			{0.010,0.003,0.005,0.003,0.010,0.003,0.002,0.002,0.001,0.003,0.003,0.001,0.002,0.002,0.002,0.009,0.003,0.005,0.003,0.011},
			{0.011,0.003,0.005,0.003,0.009,0.002,0.001,0.002,0.001,0.003,0.003,0.001,0.002,0.001,0.002,0.007,0.003,0.004,0.003,0.010},
			{0.010,0.003,0.005,0.003,0.006,0.002,0.001,0.002,0.001,0.003,0.002,0.001,0.002,0.001,0.002,0.006,0.003,0.004,0.003,0.009},
			{0.009,0.002,0.004,0.003,0.006,0.002,0.001,0.002,0.001,0.002,0.002,0.001,0.001,0.001,0.002,0.005,0.003,0.003,0.003,0.010},
			{0.008,0.002,0.004,0.002,0.004,0.002,0.001,0.001,0.001,0.001,0.002,0.001,0.001,0.001,0.001,0.004,0.002,0.003,0.002,0.008},
			{0.010,0.003,0.005,0.003,0.005,0.002,0.001,0.002,0.001,0.002,0.002,0.001,0.002,0.001,0.002,0.004,0.003,0.004,0.003,0.010},
			{0.016,0.004,0.006,0.004,0.006,0.003,0.002,0.003,0.001,0.002,0.002,0.001,0.002,0.002,0.003,0.006,0.004,0.005,0.004,0.015},
			{0.030,0.007,0.011,0.007,0.010,0.005,0.003,0.004,0.002,0.004,0.005,0.002,0.004,0.003,0.005,0.009,0.006,0.009,0.007,0.029}};

		unc = 0.;
		if(pt_in_gev<bins_pt[0]) return 0.;
		int ipt = std::upper_bound(bins_pt,bins_pt+nbins_pt+1,pt_in_gev) - bins_pt - 1;
		if(ipt>=nbins_pt) ipt = nbins_pt-1;
		int ieta = std::upper_bound(bins_eta,bins_eta+nbins_eta+1,eta) - bins_eta - 1;
		if(ieta>=nbins_eta || ieta<0) return 0.;
		unc = ((runnumber>290000) ? (fullsim ? fullsim_2016_err : fastsim_2016_err) : (fullsim ? fullsim_2015_err : fastsim_2015_err))[ipt][ieta];
		return ((runnumber>290000) ? (fullsim ? fullsim_2016_val : fastsim_2016_val) : (fullsim ? fullsim_2015_val : fastsim_2015_val))[ipt][ieta];
	}
	double efficiency_mc_eXmuY_electron(double pt_in_gev, double eta, double& unc,int runnumber, bool fullsim)
	{  // dumped from efficiency.MULTI_L_2015_e17_lhloose_2016_e17_lhloose_nod0.MediumLLH_d0z0_v11_isolGradient.root
		static const double bins_pt[] = {7.0,10.0,13.0,15.0,16.0,18.0,21.0,25.0,27.0,30.0,32.5,35.0,37.5,40.0,42.5,45.0,50.0,60.0,80.0,1000.0};
		const int nbins_pt = sizeof(bins_pt)/sizeof(*bins_pt)-1;
		static const double bins_eta[] = {-2.47,-2.37,-2.01,-1.81,-1.52,-1.37,-1.15,-0.80,-0.60,-0.10,0.00,0.10,0.60,0.80,1.15,1.37,1.52,1.81,2.01,2.37,2.47};
		const int nbins_eta = sizeof(bins_eta)/sizeof(*bins_eta)-1;
		static const double fullsim_2015_val[nbins_pt][nbins_eta] = {
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.695,0.771,0.736,0.639,0.402,0.835,0.716,0.697,0.710,0.675,0.681,0.719,0.666,0.689,0.827,0.364,0.664,0.739,0.754,0.693},
			{0.886,0.915,0.888,0.864,0.624,0.936,0.934,0.943,0.952,0.944,0.939,0.953,0.939,0.926,0.933,0.636,0.882,0.903,0.914,0.872},
			{0.903,0.919,0.908,0.909,0.697,0.947,0.961,0.957,0.969,0.970,0.959,0.969,0.957,0.957,0.945,0.704,0.922,0.918,0.927,0.872},
			{0.903,0.938,0.917,0.925,0.731,0.955,0.963,0.966,0.977,0.976,0.974,0.974,0.965,0.965,0.955,0.760,0.931,0.921,0.936,0.885},
			{0.900,0.946,0.916,0.936,0.776,0.953,0.967,0.969,0.977,0.978,0.977,0.977,0.969,0.967,0.955,0.816,0.935,0.927,0.943,0.883},
			{0.900,0.949,0.924,0.941,0.801,0.961,0.973,0.973,0.979,0.982,0.976,0.979,0.975,0.972,0.961,0.845,0.942,0.934,0.949,0.894},
			{0.897,0.954,0.927,0.942,0.839,0.964,0.974,0.976,0.980,0.982,0.976,0.980,0.976,0.974,0.966,0.868,0.944,0.938,0.954,0.894},
			{0.902,0.957,0.933,0.945,0.858,0.969,0.975,0.977,0.980,0.982,0.981,0.981,0.978,0.977,0.969,0.887,0.947,0.943,0.954,0.895},
			{0.914,0.955,0.935,0.949,0.883,0.971,0.978,0.979,0.983,0.984,0.984,0.983,0.981,0.977,0.970,0.911,0.952,0.946,0.957,0.912},
			{0.921,0.959,0.944,0.958,0.905,0.975,0.982,0.982,0.987,0.988,0.989,0.987,0.984,0.982,0.975,0.927,0.958,0.950,0.960,0.918},
			{0.929,0.968,0.950,0.962,0.918,0.979,0.983,0.986,0.989,0.990,0.990,0.989,0.985,0.985,0.979,0.941,0.964,0.957,0.965,0.921},
			{0.926,0.965,0.949,0.962,0.932,0.979,0.983,0.986,0.990,0.991,0.990,0.990,0.986,0.985,0.981,0.951,0.964,0.956,0.964,0.925},
			{0.936,0.966,0.953,0.962,0.952,0.979,0.983,0.987,0.990,0.992,0.993,0.989,0.987,0.983,0.980,0.961,0.961,0.955,0.964,0.925},
			{0.943,0.967,0.958,0.960,0.952,0.984,0.987,0.987,0.991,0.992,0.987,0.992,0.989,0.986,0.983,0.958,0.963,0.955,0.963,0.941}};

		static const double fullsim_2015_err[nbins_pt][nbins_eta] = {
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.012,0.006,0.008,0.007,0.014,0.006,0.006,0.008,0.005,0.011,0.011,0.004,0.008,0.006,0.007,0.013,0.008,0.008,0.006,0.013},
			{0.006,0.003,0.004,0.004,0.011,0.003,0.002,0.003,0.001,0.003,0.003,0.001,0.003,0.002,0.003,0.009,0.003,0.004,0.003,0.006},
			{0.007,0.003,0.004,0.004,0.009,0.003,0.002,0.003,0.001,0.003,0.003,0.001,0.003,0.002,0.003,0.009,0.004,0.004,0.003,0.007},
			{0.005,0.002,0.003,0.003,0.006,0.002,0.001,0.002,0.001,0.002,0.002,0.001,0.002,0.001,0.002,0.006,0.002,0.003,0.002,0.005},
			{0.005,0.002,0.003,0.002,0.005,0.002,0.001,0.001,0.001,0.002,0.002,0.001,0.001,0.001,0.002,0.005,0.002,0.003,0.002,0.005},
			{0.005,0.002,0.003,0.002,0.004,0.002,0.001,0.001,0.001,0.001,0.002,0.001,0.001,0.001,0.002,0.004,0.002,0.002,0.002,0.005},
			{0.005,0.002,0.002,0.002,0.004,0.001,0.001,0.001,0.001,0.001,0.002,0.001,0.001,0.001,0.001,0.004,0.002,0.002,0.002,0.005},
			{0.004,0.001,0.002,0.001,0.003,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.003,0.001,0.002,0.001,0.005},
			{0.004,0.001,0.002,0.001,0.003,0.001,0.001,0.001,0.000,0.001,0.001,0.000,0.001,0.001,0.001,0.002,0.001,0.002,0.001,0.004},
			{0.004,0.001,0.002,0.001,0.003,0.001,0.001,0.001,0.000,0.001,0.001,0.000,0.001,0.001,0.001,0.002,0.001,0.002,0.001,0.004},
			{0.003,0.001,0.002,0.001,0.002,0.001,0.001,0.001,0.000,0.001,0.001,0.000,0.001,0.001,0.001,0.002,0.001,0.001,0.001,0.003},
			{0.004,0.001,0.002,0.001,0.002,0.001,0.001,0.001,0.000,0.001,0.001,0.000,0.001,0.001,0.001,0.002,0.001,0.002,0.001,0.004},
			{0.006,0.002,0.003,0.002,0.003,0.002,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.003,0.002,0.003,0.002,0.007},
			{0.012,0.004,0.005,0.004,0.005,0.002,0.002,0.002,0.001,0.002,0.003,0.001,0.002,0.002,0.003,0.005,0.004,0.005,0.004,0.013}};

		static const double fastsim_2015_val[nbins_pt][nbins_eta] = {
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.481,0.595,0.541,0.406,0.156,0.697,0.513,0.486,0.503,0.458,0.463,0.516,0.442,0.475,0.682,0.130,0.438,0.545,0.570,0.481},
			{0.785,0.839,0.789,0.745,0.384,0.876,0.873,0.888,0.907,0.892,0.881,0.909,0.882,0.858,0.870,0.401,0.777,0.815,0.835,0.760},
			{0.815,0.846,0.824,0.824,0.483,0.897,0.924,0.917,0.939,0.942,0.920,0.938,0.915,0.915,0.893,0.493,0.848,0.843,0.859,0.762},
			{0.815,0.878,0.841,0.855,0.532,0.912,0.927,0.933,0.954,0.953,0.948,0.948,0.931,0.931,0.911,0.576,0.867,0.847,0.876,0.784},
			{0.809,0.894,0.839,0.876,0.600,0.908,0.936,0.939,0.955,0.956,0.955,0.954,0.939,0.935,0.911,0.663,0.874,0.860,0.889,0.781},
			{0.811,0.901,0.853,0.885,0.642,0.924,0.946,0.946,0.959,0.965,0.952,0.959,0.951,0.944,0.923,0.713,0.888,0.872,0.900,0.796},
			{0.805,0.911,0.859,0.887,0.703,0.929,0.948,0.952,0.961,0.964,0.952,0.960,0.953,0.949,0.933,0.752,0.891,0.881,0.908,0.798},
			{0.814,0.915,0.871,0.893,0.736,0.939,0.951,0.954,0.961,0.964,0.963,0.963,0.956,0.954,0.939,0.787,0.898,0.889,0.910,0.801},
			{0.836,0.912,0.873,0.900,0.779,0.944,0.956,0.959,0.966,0.968,0.969,0.967,0.962,0.954,0.941,0.829,0.906,0.895,0.915,0.832},
			{0.848,0.920,0.891,0.918,0.818,0.950,0.964,0.965,0.974,0.975,0.978,0.973,0.968,0.964,0.951,0.860,0.917,0.903,0.922,0.842},
			{0.863,0.936,0.903,0.925,0.842,0.958,0.966,0.971,0.978,0.980,0.981,0.977,0.971,0.969,0.959,0.885,0.930,0.915,0.931,0.848},
			{0.858,0.931,0.900,0.926,0.868,0.958,0.966,0.972,0.979,0.982,0.981,0.980,0.972,0.971,0.961,0.904,0.930,0.914,0.930,0.854},
			{0.876,0.933,0.908,0.925,0.906,0.958,0.967,0.973,0.980,0.985,0.986,0.978,0.974,0.966,0.960,0.923,0.925,0.911,0.929,0.856},
			{0.887,0.936,0.920,0.921,0.907,0.967,0.975,0.975,0.982,0.983,0.975,0.983,0.978,0.973,0.966,0.918,0.928,0.912,0.928,0.888}};

		static const double fastsim_2015_err[nbins_pt][nbins_eta] = {
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.001,0.001,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.001,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.001,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.001,0.000,0.001,0.002,0.000,0.001,0.000,0.001,0.000,0.000,0.000,0.000,0.000,0.003,0.000,0.000,0.000},
			{0.012,0.006,0.008,0.007,0.006,0.011,0.006,0.007,0.004,0.008,0.009,0.004,0.006,0.006,0.010,0.006,0.007,0.009,0.006,0.012},
			{0.015,0.007,0.009,0.008,0.011,0.008,0.007,0.009,0.005,0.012,0.012,0.005,0.009,0.007,0.008,0.010,0.008,0.009,0.007,0.015},
			{0.008,0.004,0.005,0.005,0.009,0.004,0.003,0.004,0.002,0.004,0.005,0.002,0.004,0.003,0.004,0.008,0.004,0.005,0.003,0.008},
			{0.009,0.004,0.006,0.005,0.010,0.004,0.003,0.004,0.002,0.004,0.004,0.002,0.004,0.003,0.004,0.009,0.004,0.005,0.004,0.010},
			{0.006,0.003,0.004,0.003,0.007,0.003,0.002,0.002,0.001,0.002,0.002,0.001,0.002,0.002,0.003,0.006,0.003,0.004,0.003,0.007},
			{0.007,0.003,0.004,0.003,0.006,0.003,0.002,0.002,0.001,0.002,0.002,0.001,0.002,0.002,0.003,0.006,0.003,0.004,0.003,0.007},
			{0.006,0.002,0.003,0.003,0.005,0.002,0.001,0.002,0.001,0.002,0.002,0.001,0.002,0.001,0.002,0.005,0.002,0.003,0.002,0.007},
			{0.006,0.002,0.003,0.002,0.005,0.002,0.001,0.001,0.001,0.002,0.002,0.001,0.001,0.001,0.002,0.004,0.002,0.003,0.002,0.006},
			{0.006,0.002,0.003,0.002,0.004,0.002,0.001,0.001,0.001,0.002,0.002,0.001,0.001,0.001,0.002,0.004,0.002,0.003,0.002,0.006},
			{0.005,0.002,0.003,0.002,0.004,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.003,0.002,0.002,0.002,0.005},
			{0.005,0.002,0.002,0.002,0.003,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.003,0.002,0.002,0.002,0.005},
			{0.004,0.001,0.002,0.001,0.003,0.001,0.001,0.001,0.000,0.001,0.001,0.000,0.001,0.001,0.001,0.002,0.001,0.002,0.001,0.005},
			{0.006,0.002,0.003,0.002,0.003,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.003,0.002,0.003,0.002,0.006},
			{0.009,0.003,0.004,0.003,0.004,0.002,0.001,0.002,0.001,0.002,0.002,0.001,0.002,0.001,0.002,0.004,0.003,0.004,0.003,0.009},
			{0.017,0.005,0.007,0.005,0.007,0.003,0.002,0.003,0.001,0.003,0.004,0.001,0.003,0.002,0.004,0.007,0.005,0.007,0.006,0.017}};

		static const double fullsim_2016_val[nbins_pt][nbins_eta] = {
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.699,0.760,0.722,0.632,0.405,0.829,0.720,0.694,0.703,0.686,0.685,0.721,0.664,0.713,0.825,0.355,0.673,0.728,0.753,0.707},
			{0.881,0.915,0.884,0.861,0.634,0.936,0.933,0.940,0.950,0.940,0.940,0.951,0.936,0.925,0.930,0.644,0.890,0.906,0.913,0.880},
			{0.890,0.925,0.916,0.909,0.698,0.947,0.959,0.957,0.970,0.969,0.964,0.966,0.956,0.956,0.944,0.719,0.913,0.916,0.930,0.883},
			{0.903,0.942,0.913,0.924,0.741,0.954,0.964,0.967,0.975,0.972,0.975,0.974,0.968,0.965,0.956,0.765,0.935,0.922,0.934,0.886},
			{0.900,0.947,0.917,0.940,0.778,0.953,0.966,0.966,0.975,0.977,0.974,0.976,0.965,0.963,0.952,0.807,0.936,0.926,0.941,0.882},
			{0.899,0.950,0.925,0.937,0.793,0.960,0.971,0.973,0.978,0.980,0.977,0.978,0.973,0.969,0.956,0.845,0.944,0.933,0.949,0.882},
			{0.897,0.956,0.927,0.945,0.833,0.964,0.973,0.974,0.978,0.979,0.974,0.977,0.972,0.974,0.967,0.865,0.942,0.938,0.956,0.877},
			{0.903,0.957,0.928,0.945,0.852,0.968,0.976,0.976,0.980,0.980,0.977,0.980,0.978,0.975,0.969,0.889,0.948,0.945,0.956,0.896},
			{0.910,0.957,0.934,0.953,0.886,0.970,0.976,0.977,0.982,0.980,0.984,0.981,0.976,0.977,0.969,0.910,0.951,0.944,0.955,0.907},
			{0.926,0.963,0.943,0.958,0.903,0.972,0.981,0.981,0.986,0.988,0.987,0.987,0.983,0.980,0.974,0.928,0.959,0.952,0.963,0.909},
			{0.926,0.967,0.946,0.963,0.920,0.978,0.983,0.984,0.989,0.991,0.988,0.989,0.985,0.984,0.979,0.937,0.966,0.959,0.963,0.925},
			{0.930,0.967,0.947,0.964,0.934,0.979,0.983,0.987,0.990,0.989,0.989,0.989,0.987,0.984,0.979,0.947,0.966,0.957,0.967,0.928},
			{0.948,0.967,0.950,0.964,0.953,0.980,0.984,0.986,0.990,0.990,0.991,0.989,0.985,0.983,0.980,0.959,0.962,0.960,0.964,0.935},
			{0.939,0.978,0.956,0.962,0.959,0.980,0.987,0.990,0.991,0.991,0.986,0.990,0.990,0.983,0.979,0.966,0.970,0.954,0.964,0.931}};

		static const double fullsim_2016_err[nbins_pt][nbins_eta] = {
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.013,0.006,0.008,0.009,0.015,0.007,0.006,0.008,0.005,0.011,0.011,0.005,0.008,0.006,0.006,0.015,0.008,0.008,0.006,0.013},
			{0.006,0.003,0.004,0.005,0.010,0.003,0.003,0.003,0.001,0.004,0.003,0.002,0.003,0.002,0.003,0.009,0.004,0.004,0.003,0.006},
			{0.006,0.003,0.004,0.003,0.010,0.003,0.002,0.002,0.001,0.002,0.003,0.001,0.002,0.002,0.003,0.009,0.003,0.004,0.003,0.007},
			{0.005,0.002,0.004,0.003,0.008,0.002,0.001,0.002,0.001,0.002,0.002,0.001,0.002,0.001,0.002,0.007,0.003,0.003,0.002,0.006},
			{0.005,0.002,0.003,0.002,0.006,0.002,0.001,0.002,0.001,0.002,0.002,0.001,0.002,0.001,0.002,0.006,0.002,0.003,0.002,0.006},
			{0.005,0.002,0.003,0.002,0.005,0.002,0.001,0.001,0.001,0.001,0.002,0.001,0.001,0.001,0.002,0.004,0.002,0.003,0.002,0.005},
			{0.005,0.002,0.002,0.002,0.004,0.002,0.001,0.001,0.001,0.001,0.002,0.001,0.001,0.001,0.001,0.004,0.002,0.002,0.002,0.005},
			{0.005,0.001,0.002,0.002,0.003,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.003,0.001,0.002,0.001,0.005},
			{0.004,0.001,0.002,0.001,0.003,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.003,0.001,0.002,0.001,0.004},
			{0.004,0.001,0.002,0.001,0.003,0.001,0.001,0.001,0.000,0.001,0.001,0.000,0.001,0.001,0.001,0.002,0.001,0.002,0.001,0.004},
			{0.004,0.001,0.002,0.001,0.002,0.001,0.001,0.001,0.000,0.001,0.001,0.000,0.001,0.001,0.001,0.002,0.001,0.001,0.001,0.003},
			{0.004,0.001,0.002,0.001,0.002,0.001,0.001,0.001,0.000,0.001,0.001,0.000,0.001,0.001,0.001,0.002,0.001,0.002,0.001,0.004},
			{0.006,0.002,0.003,0.002,0.003,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.002,0.003,0.002,0.003,0.002,0.007},
			{0.012,0.003,0.006,0.004,0.005,0.003,0.002,0.002,0.001,0.002,0.003,0.001,0.002,0.002,0.003,0.005,0.003,0.006,0.004,0.013}};

		static const double fastsim_2016_val[nbins_pt][nbins_eta] = {
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.489,0.579,0.523,0.397,0.161,0.685,0.518,0.482,0.494,0.473,0.468,0.518,0.441,0.508,0.681,0.122,0.451,0.530,0.567,0.497},
			{0.775,0.837,0.782,0.739,0.397,0.875,0.870,0.881,0.903,0.884,0.883,0.904,0.876,0.856,0.863,0.412,0.789,0.821,0.834,0.775},
			{0.793,0.856,0.839,0.826,0.481,0.897,0.920,0.914,0.941,0.940,0.930,0.932,0.914,0.913,0.891,0.512,0.833,0.840,0.864,0.782},
			{0.816,0.887,0.832,0.854,0.547,0.910,0.928,0.934,0.950,0.945,0.950,0.948,0.936,0.931,0.915,0.584,0.873,0.849,0.872,0.784},
			{0.809,0.897,0.840,0.883,0.604,0.908,0.932,0.933,0.951,0.954,0.948,0.951,0.931,0.927,0.905,0.648,0.877,0.857,0.887,0.777},
			{0.808,0.903,0.856,0.878,0.629,0.921,0.942,0.946,0.957,0.961,0.954,0.956,0.946,0.939,0.915,0.712,0.890,0.871,0.901,0.778},
			{0.805,0.913,0.860,0.894,0.694,0.929,0.946,0.949,0.957,0.959,0.948,0.955,0.945,0.949,0.935,0.746,0.888,0.880,0.914,0.769},
			{0.816,0.916,0.862,0.893,0.725,0.938,0.952,0.952,0.960,0.960,0.955,0.961,0.956,0.951,0.939,0.790,0.899,0.893,0.913,0.802},
			{0.827,0.915,0.873,0.908,0.785,0.941,0.952,0.955,0.964,0.960,0.969,0.963,0.953,0.954,0.939,0.828,0.905,0.891,0.912,0.823},
			{0.858,0.927,0.889,0.918,0.814,0.945,0.963,0.962,0.973,0.977,0.975,0.974,0.965,0.961,0.949,0.861,0.919,0.907,0.927,0.828},
			{0.857,0.936,0.896,0.928,0.846,0.957,0.967,0.968,0.977,0.982,0.977,0.977,0.971,0.968,0.959,0.879,0.933,0.919,0.928,0.856},
			{0.863,0.934,0.897,0.929,0.872,0.958,0.966,0.973,0.979,0.978,0.978,0.978,0.974,0.969,0.959,0.897,0.933,0.917,0.935,0.862},
			{0.900,0.936,0.903,0.930,0.908,0.960,0.969,0.972,0.980,0.981,0.983,0.978,0.971,0.966,0.960,0.918,0.927,0.921,0.929,0.876},
			{0.881,0.955,0.914,0.926,0.920,0.960,0.974,0.981,0.982,0.982,0.973,0.981,0.980,0.965,0.958,0.935,0.940,0.909,0.929,0.868}};

		static const double fastsim_2016_err[nbins_pt][nbins_eta] = {
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.001,0.001,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.001,0.000,0.000,0.001,0.000,0.000,0.000,0.000,0.000,0.001,0.000,0.000,0.000,0.001,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.002,0.000,0.002,0.001,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.001,0.000,0.002,0.000,0.000,0.000},
			{0.012,0.007,0.009,0.007,0.006,0.011,0.006,0.007,0.004,0.007,0.008,0.004,0.006,0.006,0.011,0.006,0.008,0.008,0.006,0.012},
			{0.015,0.007,0.010,0.009,0.011,0.008,0.007,0.009,0.006,0.013,0.013,0.006,0.009,0.007,0.008,0.011,0.009,0.010,0.007,0.016},
			{0.008,0.004,0.005,0.005,0.009,0.004,0.003,0.004,0.002,0.005,0.004,0.002,0.004,0.003,0.004,0.008,0.005,0.005,0.004,0.008},
			{0.008,0.004,0.005,0.004,0.009,0.003,0.002,0.003,0.002,0.003,0.004,0.002,0.003,0.003,0.004,0.009,0.004,0.005,0.004,0.008},
			{0.007,0.003,0.005,0.004,0.008,0.003,0.002,0.003,0.001,0.003,0.003,0.001,0.002,0.002,0.003,0.007,0.003,0.004,0.003,0.008},
			{0.007,0.003,0.004,0.003,0.006,0.003,0.002,0.002,0.001,0.002,0.003,0.001,0.002,0.002,0.003,0.006,0.003,0.004,0.003,0.007},
			{0.006,0.002,0.004,0.003,0.006,0.002,0.001,0.002,0.001,0.002,0.002,0.001,0.002,0.001,0.002,0.005,0.003,0.003,0.002,0.007},
			{0.006,0.002,0.003,0.002,0.005,0.002,0.001,0.001,0.001,0.002,0.002,0.001,0.002,0.001,0.002,0.005,0.002,0.003,0.002,0.007},
			{0.006,0.002,0.003,0.002,0.004,0.002,0.001,0.001,0.001,0.002,0.002,0.001,0.001,0.001,0.002,0.004,0.002,0.003,0.002,0.006},
			{0.006,0.002,0.003,0.002,0.004,0.002,0.001,0.001,0.001,0.002,0.002,0.001,0.001,0.001,0.001,0.003,0.002,0.003,0.002,0.006},
			{0.005,0.002,0.003,0.002,0.003,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.003,0.002,0.002,0.002,0.006},
			{0.005,0.001,0.002,0.001,0.003,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.002,0.001,0.002,0.002,0.005},
			{0.006,0.002,0.003,0.002,0.003,0.002,0.001,0.001,0.001,0.001,0.002,0.001,0.001,0.001,0.001,0.003,0.002,0.003,0.002,0.006},
			{0.008,0.003,0.004,0.003,0.004,0.002,0.001,0.002,0.001,0.002,0.002,0.001,0.002,0.001,0.002,0.004,0.003,0.004,0.003,0.009},
			{0.017,0.004,0.007,0.005,0.007,0.004,0.002,0.002,0.001,0.003,0.004,0.002,0.003,0.003,0.004,0.006,0.005,0.008,0.006,0.017}};

		unc = 0.;
		if(pt_in_gev<bins_pt[0]) return 0.;
		int ipt = std::upper_bound(bins_pt,bins_pt+nbins_pt+1,pt_in_gev) - bins_pt - 1;
		if(ipt>=nbins_pt) ipt = nbins_pt-1;
		int ieta = std::upper_bound(bins_eta,bins_eta+nbins_eta+1,eta) - bins_eta - 1;
		if(ieta>=nbins_eta || ieta<0) return 0.;
		unc = ((runnumber>290000) ? (fullsim ? fullsim_2016_err : fastsim_2016_err) : (fullsim ? fullsim_2015_err : fastsim_2015_err))[ipt][ieta];
		return ((runnumber>290000) ? (fullsim ? fullsim_2016_val : fastsim_2016_val) : (fullsim ? fullsim_2015_val : fastsim_2015_val))[ipt][ieta];
	}
	double efficiency_mc_2eX_anyelectron(double pt_in_gev, double eta, double& unc,int runnumber, bool fullsim)
	{  // dumped from efficiency.DI_E_2015_e12_lhloose_L1EM10VH_2016_e17_lhvloose_nod0.MediumLLH_d0z0_v11_isolGradient.root
		static const double bins_pt[] = {7.0,10.0,13.0,15.0,16.0,18.0,21.0,25.0,27.0,30.0,32.5,35.0,37.5,40.0,42.5,45.0,50.0,60.0,80.0,1000.0};
		const int nbins_pt = sizeof(bins_pt)/sizeof(*bins_pt)-1;
		static const double bins_eta[] = {-2.47,-2.37,-2.01,-1.81,-1.52,-1.37,-1.15,-0.80,-0.60,-0.10,0.00,0.10,0.60,0.80,1.15,1.37,1.52,1.81,2.01,2.37,2.47};
		const int nbins_eta = sizeof(bins_eta)/sizeof(*bins_eta)-1;
		static const double fullsim_2015_val[nbins_pt][nbins_eta] = {
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.864,0.885,0.847,0.763,0.587,0.912,0.902,0.768,0.864,0.811,0.851,0.867,0.780,0.869,0.899,0.577,0.810,0.866,0.880,0.845},
			{0.911,0.889,0.901,0.867,0.728,0.926,0.925,0.918,0.934,0.945,0.923,0.936,0.905,0.908,0.911,0.726,0.845,0.894,0.883,0.897},
			{0.886,0.921,0.895,0.897,0.728,0.939,0.933,0.952,0.949,0.951,0.941,0.950,0.940,0.943,0.934,0.741,0.899,0.886,0.916,0.916},
			{0.878,0.931,0.901,0.908,0.768,0.938,0.948,0.960,0.964,0.961,0.958,0.964,0.959,0.949,0.941,0.791,0.908,0.905,0.922,0.892},
			{0.904,0.932,0.904,0.921,0.798,0.950,0.956,0.966,0.972,0.974,0.973,0.972,0.966,0.957,0.950,0.835,0.925,0.919,0.932,0.892},
			{0.906,0.924,0.911,0.928,0.833,0.950,0.966,0.964,0.975,0.979,0.970,0.974,0.964,0.964,0.950,0.861,0.933,0.922,0.931,0.875},
			{0.904,0.939,0.918,0.935,0.852,0.956,0.965,0.970,0.979,0.980,0.977,0.976,0.970,0.969,0.956,0.880,0.936,0.922,0.937,0.887},
			{0.900,0.946,0.916,0.939,0.879,0.953,0.968,0.971,0.978,0.979,0.980,0.978,0.971,0.968,0.955,0.899,0.936,0.928,0.943,0.883},
			{0.900,0.949,0.924,0.942,0.887,0.961,0.973,0.973,0.980,0.983,0.977,0.979,0.976,0.972,0.961,0.906,0.943,0.934,0.949,0.894},
			{0.897,0.954,0.927,0.942,0.905,0.964,0.974,0.976,0.981,0.982,0.976,0.980,0.977,0.974,0.966,0.915,0.944,0.938,0.954,0.894},
			{0.902,0.957,0.933,0.945,0.915,0.969,0.975,0.977,0.980,0.982,0.982,0.981,0.978,0.977,0.969,0.924,0.947,0.943,0.954,0.895},
			{0.914,0.955,0.935,0.949,0.931,0.971,0.978,0.979,0.983,0.984,0.984,0.983,0.981,0.977,0.970,0.936,0.952,0.946,0.957,0.912},
			{0.921,0.959,0.944,0.958,0.941,0.975,0.982,0.982,0.987,0.988,0.989,0.987,0.984,0.982,0.975,0.946,0.958,0.950,0.960,0.918},
			{0.929,0.968,0.950,0.962,0.947,0.979,0.983,0.986,0.989,0.990,0.990,0.989,0.985,0.985,0.979,0.952,0.964,0.957,0.965,0.921},
			{0.926,0.965,0.949,0.962,0.948,0.979,0.983,0.986,0.990,0.991,0.990,0.990,0.986,0.985,0.981,0.955,0.964,0.956,0.964,0.925},
			{0.936,0.966,0.953,0.962,0.955,0.979,0.983,0.987,0.990,0.992,0.993,0.989,0.987,0.983,0.980,0.961,0.961,0.955,0.964,0.925},
			{0.943,0.967,0.958,0.960,0.952,0.984,0.987,0.987,0.991,0.992,0.987,0.992,0.989,0.986,0.983,0.958,0.963,0.955,0.963,0.941}};

		static const double fullsim_2015_err[nbins_pt][nbins_eta] = {
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.015,0.007,0.013,0.011,0.023,0.009,0.007,0.012,0.007,0.020,0.018,0.007,0.012,0.008,0.009,0.022,0.012,0.011,0.007,0.016},
			{0.018,0.010,0.012,0.012,0.028,0.011,0.008,0.011,0.006,0.013,0.017,0.006,0.011,0.009,0.012,0.025,0.014,0.012,0.010,0.018},
			{0.013,0.005,0.008,0.007,0.016,0.006,0.005,0.005,0.003,0.008,0.009,0.003,0.006,0.005,0.006,0.015,0.007,0.008,0.005,0.010},
			{0.009,0.003,0.006,0.005,0.013,0.004,0.003,0.003,0.002,0.005,0.005,0.002,0.004,0.003,0.004,0.011,0.006,0.005,0.004,0.009},
			{0.006,0.003,0.004,0.003,0.008,0.002,0.002,0.002,0.001,0.002,0.002,0.001,0.002,0.002,0.002,0.007,0.003,0.004,0.002,0.006},
			{0.007,0.003,0.004,0.003,0.007,0.003,0.002,0.002,0.001,0.002,0.003,0.001,0.003,0.002,0.003,0.007,0.003,0.004,0.003,0.007},
			{0.005,0.002,0.003,0.003,0.005,0.002,0.001,0.002,0.001,0.002,0.002,0.001,0.002,0.001,0.002,0.005,0.002,0.003,0.002,0.005},
			{0.005,0.002,0.003,0.002,0.004,0.002,0.001,0.001,0.001,0.002,0.002,0.001,0.001,0.001,0.002,0.004,0.002,0.003,0.002,0.005},
			{0.005,0.002,0.003,0.002,0.003,0.002,0.001,0.001,0.001,0.001,0.002,0.001,0.001,0.001,0.002,0.003,0.002,0.002,0.002,0.005},
			{0.005,0.002,0.002,0.002,0.003,0.001,0.001,0.001,0.001,0.001,0.002,0.001,0.001,0.001,0.001,0.003,0.002,0.002,0.002,0.005},
			{0.004,0.001,0.002,0.001,0.002,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.002,0.001,0.002,0.001,0.005},
			{0.004,0.001,0.002,0.001,0.002,0.001,0.001,0.001,0.000,0.001,0.001,0.000,0.001,0.001,0.001,0.002,0.001,0.002,0.001,0.004},
			{0.004,0.001,0.002,0.001,0.002,0.001,0.001,0.001,0.000,0.001,0.001,0.000,0.001,0.001,0.001,0.002,0.001,0.002,0.001,0.004},
			{0.003,0.001,0.002,0.001,0.002,0.001,0.001,0.001,0.000,0.001,0.001,0.000,0.001,0.001,0.001,0.002,0.001,0.001,0.001,0.003},
			{0.004,0.001,0.002,0.001,0.002,0.001,0.001,0.001,0.000,0.001,0.001,0.000,0.001,0.001,0.001,0.002,0.001,0.002,0.001,0.004},
			{0.006,0.002,0.003,0.002,0.003,0.002,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.003,0.002,0.003,0.002,0.007},
			{0.012,0.004,0.005,0.004,0.005,0.002,0.002,0.002,0.001,0.002,0.003,0.001,0.002,0.002,0.003,0.005,0.004,0.005,0.004,0.013}};

		static const double fastsim_2015_val[nbins_pt][nbins_eta] = {
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.744,0.783,0.709,0.582,0.336,0.830,0.812,0.590,0.747,0.660,0.724,0.750,0.606,0.752,0.806,0.329,0.650,0.742,0.774,0.718},
			{0.820,0.789,0.808,0.752,0.514,0.855,0.855,0.841,0.874,0.890,0.849,0.875,0.820,0.824,0.828,0.518,0.711,0.801,0.783,0.804},
			{0.787,0.849,0.799,0.800,0.523,0.882,0.869,0.906,0.901,0.904,0.884,0.903,0.882,0.888,0.872,0.546,0.806,0.784,0.838,0.837},
			{0.773,0.867,0.807,0.823,0.582,0.879,0.897,0.921,0.928,0.922,0.917,0.928,0.918,0.900,0.884,0.621,0.821,0.818,0.849,0.794},
			{0.819,0.869,0.817,0.847,0.630,0.903,0.915,0.932,0.945,0.948,0.947,0.945,0.932,0.916,0.902,0.694,0.854,0.844,0.867,0.796},
			{0.821,0.855,0.829,0.860,0.691,0.902,0.933,0.929,0.951,0.959,0.941,0.949,0.930,0.928,0.903,0.738,0.869,0.849,0.866,0.766},
			{0.817,0.881,0.842,0.873,0.724,0.914,0.931,0.940,0.958,0.959,0.955,0.953,0.940,0.939,0.914,0.773,0.874,0.850,0.878,0.788},
			{0.809,0.894,0.839,0.881,0.771,0.908,0.937,0.943,0.957,0.958,0.960,0.956,0.942,0.937,0.911,0.806,0.876,0.860,0.889,0.781},
			{0.811,0.901,0.853,0.887,0.787,0.924,0.946,0.947,0.959,0.966,0.955,0.959,0.952,0.945,0.923,0.821,0.888,0.872,0.900,0.796},
			{0.805,0.911,0.859,0.888,0.819,0.929,0.948,0.953,0.961,0.964,0.952,0.960,0.954,0.949,0.933,0.837,0.891,0.881,0.908,0.798},
			{0.814,0.915,0.871,0.893,0.837,0.939,0.951,0.954,0.961,0.965,0.964,0.963,0.956,0.954,0.939,0.853,0.898,0.889,0.910,0.801},
			{0.836,0.912,0.873,0.900,0.866,0.944,0.956,0.959,0.966,0.968,0.969,0.967,0.962,0.954,0.941,0.875,0.906,0.895,0.915,0.832},
			{0.848,0.920,0.891,0.918,0.886,0.950,0.964,0.965,0.974,0.975,0.978,0.973,0.968,0.964,0.951,0.895,0.917,0.903,0.922,0.842},
			{0.863,0.936,0.903,0.925,0.896,0.958,0.966,0.971,0.978,0.980,0.981,0.977,0.971,0.969,0.959,0.906,0.930,0.915,0.931,0.848},
			{0.858,0.931,0.900,0.926,0.898,0.958,0.966,0.972,0.979,0.982,0.981,0.980,0.972,0.971,0.961,0.911,0.930,0.914,0.930,0.854},
			{0.876,0.933,0.908,0.925,0.911,0.958,0.967,0.973,0.980,0.985,0.986,0.978,0.974,0.966,0.960,0.923,0.925,0.911,0.929,0.856},
			{0.887,0.936,0.920,0.921,0.907,0.967,0.975,0.975,0.982,0.983,0.975,0.983,0.978,0.973,0.966,0.918,0.928,0.912,0.928,0.888}};

		static const double fastsim_2015_err[nbins_pt][nbins_eta] = {
			{0.000,0.000,0.000,0.000,0.000,0.000,0.001,0.000,0.000,0.001,0.001,0.000,0.000,0.000,0.000,0.001,0.000,0.000,0.000,0.000},
			{0.019,0.009,0.012,0.011,0.015,0.014,0.010,0.010,0.009,0.025,0.022,0.010,0.011,0.010,0.014,0.014,0.011,0.012,0.009,0.019},
			{0.019,0.009,0.015,0.013,0.022,0.011,0.009,0.015,0.009,0.025,0.023,0.009,0.015,0.010,0.012,0.022,0.013,0.014,0.009,0.020},
			{0.024,0.013,0.016,0.014,0.029,0.014,0.011,0.014,0.008,0.018,0.022,0.008,0.015,0.012,0.015,0.027,0.016,0.016,0.013,0.024},
			{0.016,0.007,0.011,0.009,0.017,0.008,0.007,0.007,0.005,0.011,0.012,0.004,0.008,0.006,0.008,0.016,0.009,0.010,0.007,0.014},
			{0.011,0.004,0.008,0.006,0.013,0.005,0.004,0.005,0.003,0.006,0.006,0.003,0.005,0.004,0.006,0.012,0.007,0.007,0.005,0.011},
			{0.007,0.003,0.005,0.004,0.008,0.003,0.002,0.003,0.001,0.003,0.003,0.002,0.003,0.002,0.003,0.007,0.004,0.005,0.003,0.008},
			{0.009,0.004,0.005,0.004,0.009,0.004,0.002,0.003,0.002,0.003,0.004,0.002,0.003,0.003,0.004,0.008,0.004,0.005,0.004,0.010},
			{0.006,0.003,0.004,0.003,0.006,0.003,0.002,0.002,0.001,0.002,0.002,0.001,0.002,0.002,0.003,0.005,0.003,0.004,0.003,0.007},
			{0.007,0.003,0.004,0.003,0.005,0.003,0.002,0.002,0.001,0.002,0.002,0.001,0.002,0.002,0.003,0.005,0.003,0.004,0.003,0.007},
			{0.006,0.002,0.003,0.003,0.004,0.002,0.001,0.002,0.001,0.002,0.002,0.001,0.002,0.001,0.002,0.004,0.002,0.003,0.002,0.007},
			{0.006,0.002,0.003,0.002,0.004,0.002,0.001,0.001,0.001,0.002,0.002,0.001,0.001,0.001,0.002,0.004,0.002,0.003,0.002,0.006},
			{0.006,0.002,0.003,0.002,0.003,0.002,0.001,0.001,0.001,0.002,0.002,0.001,0.001,0.001,0.002,0.003,0.002,0.003,0.002,0.006},
			{0.005,0.002,0.003,0.002,0.003,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.003,0.002,0.002,0.002,0.005},
			{0.005,0.002,0.002,0.002,0.003,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.003,0.002,0.002,0.002,0.005},
			{0.004,0.001,0.002,0.001,0.002,0.001,0.001,0.001,0.000,0.001,0.001,0.000,0.001,0.001,0.001,0.002,0.001,0.002,0.001,0.005},
			{0.006,0.002,0.003,0.002,0.003,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.003,0.002,0.003,0.002,0.006},
			{0.009,0.003,0.004,0.003,0.004,0.002,0.001,0.002,0.001,0.002,0.002,0.001,0.002,0.001,0.002,0.004,0.003,0.004,0.003,0.009},
			{0.017,0.005,0.007,0.005,0.007,0.003,0.002,0.003,0.001,0.003,0.004,0.001,0.003,0.002,0.004,0.007,0.005,0.007,0.006,0.017}};

		static const double fullsim_2016_val[nbins_pt][nbins_eta] = {
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.711,0.776,0.740,0.642,0.408,0.845,0.730,0.702,0.709,0.690,0.690,0.726,0.673,0.722,0.837,0.357,0.682,0.746,0.771,0.717},
			{0.894,0.933,0.903,0.872,0.642,0.947,0.943,0.948,0.955,0.945,0.944,0.956,0.944,0.936,0.942,0.650,0.904,0.924,0.934,0.896},
			{0.912,0.944,0.929,0.924,0.708,0.963,0.970,0.968,0.975,0.975,0.970,0.972,0.967,0.966,0.962,0.727,0.929,0.931,0.947,0.904},
			{0.919,0.957,0.928,0.936,0.750,0.967,0.971,0.974,0.979,0.976,0.978,0.977,0.975,0.971,0.969,0.777,0.944,0.936,0.949,0.913},
			{0.921,0.960,0.931,0.951,0.789,0.970,0.975,0.978,0.979,0.980,0.979,0.980,0.975,0.973,0.971,0.821,0.947,0.937,0.957,0.912},
			{0.917,0.960,0.937,0.948,0.806,0.971,0.977,0.979,0.981,0.983,0.980,0.980,0.980,0.975,0.969,0.859,0.953,0.948,0.961,0.906},
			{0.929,0.967,0.942,0.954,0.846,0.972,0.979,0.982,0.982,0.982,0.978,0.982,0.980,0.979,0.974,0.879,0.952,0.952,0.967,0.916},
			{0.930,0.967,0.942,0.954,0.865,0.975,0.980,0.981,0.982,0.982,0.980,0.983,0.983,0.979,0.976,0.903,0.957,0.955,0.967,0.932},
			{0.929,0.968,0.946,0.960,0.898,0.978,0.982,0.983,0.984,0.983,0.987,0.984,0.982,0.982,0.977,0.923,0.957,0.956,0.966,0.929},
			{0.938,0.971,0.952,0.963,0.914,0.978,0.985,0.985,0.988,0.990,0.989,0.988,0.986,0.984,0.981,0.939,0.964,0.961,0.971,0.925},
			{0.937,0.974,0.955,0.968,0.930,0.983,0.988,0.989,0.990,0.992,0.990,0.990,0.989,0.988,0.985,0.948,0.970,0.966,0.971,0.933},
			{0.937,0.973,0.954,0.969,0.945,0.983,0.986,0.989,0.991,0.990,0.992,0.990,0.990,0.987,0.984,0.958,0.971,0.964,0.975,0.937},
			{0.953,0.974,0.959,0.971,0.963,0.983,0.987,0.988,0.991,0.991,0.993,0.990,0.988,0.986,0.984,0.967,0.968,0.968,0.972,0.945},
			{0.952,0.982,0.965,0.970,0.966,0.985,0.988,0.993,0.993,0.994,0.989,0.992,0.992,0.986,0.982,0.969,0.974,0.966,0.977,0.944}};

		static const double fullsim_2016_err[nbins_pt][nbins_eta] = {
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.013,0.006,0.008,0.008,0.014,0.006,0.006,0.008,0.005,0.011,0.011,0.005,0.008,0.006,0.006,0.014,0.008,0.008,0.006,0.013},
			{0.006,0.002,0.004,0.004,0.010,0.003,0.002,0.003,0.001,0.004,0.003,0.001,0.003,0.002,0.003,0.008,0.004,0.003,0.002,0.006},
			{0.006,0.002,0.003,0.003,0.009,0.002,0.001,0.002,0.001,0.002,0.003,0.001,0.002,0.002,0.002,0.008,0.003,0.003,0.002,0.006},
			{0.005,0.002,0.003,0.003,0.008,0.002,0.001,0.002,0.001,0.002,0.002,0.001,0.002,0.001,0.002,0.006,0.002,0.003,0.002,0.005},
			{0.004,0.002,0.003,0.002,0.005,0.002,0.001,0.001,0.001,0.002,0.002,0.001,0.001,0.001,0.001,0.006,0.002,0.003,0.002,0.005},
			{0.004,0.002,0.003,0.002,0.005,0.002,0.001,0.001,0.001,0.001,0.002,0.001,0.001,0.001,0.001,0.004,0.002,0.002,0.002,0.005},
			{0.004,0.001,0.002,0.002,0.004,0.001,0.001,0.001,0.001,0.001,0.002,0.001,0.001,0.001,0.001,0.004,0.002,0.002,0.001,0.004},
			{0.004,0.001,0.002,0.001,0.003,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.003,0.001,0.002,0.001,0.004},
			{0.004,0.001,0.002,0.001,0.003,0.001,0.001,0.001,0.000,0.001,0.001,0.000,0.001,0.001,0.001,0.002,0.001,0.002,0.001,0.004},
			{0.003,0.001,0.002,0.001,0.002,0.001,0.001,0.001,0.000,0.001,0.001,0.000,0.001,0.001,0.001,0.002,0.001,0.002,0.001,0.004},
			{0.003,0.001,0.002,0.001,0.002,0.001,0.000,0.001,0.000,0.001,0.001,0.000,0.001,0.000,0.001,0.002,0.001,0.001,0.001,0.003},
			{0.004,0.001,0.002,0.001,0.002,0.001,0.001,0.001,0.000,0.001,0.001,0.000,0.001,0.001,0.001,0.002,0.001,0.002,0.001,0.004},
			{0.006,0.002,0.003,0.002,0.003,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.003,0.002,0.002,0.002,0.006},
			{0.011,0.003,0.005,0.003,0.005,0.003,0.002,0.001,0.001,0.002,0.003,0.001,0.002,0.002,0.003,0.005,0.003,0.005,0.003,0.012}};

		static const double fastsim_2016_val[nbins_pt][nbins_eta] = {
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.506,0.604,0.550,0.410,0.163,0.712,0.532,0.493,0.503,0.478,0.477,0.525,0.452,0.522,0.701,0.123,0.464,0.556,0.594,0.512},
			{0.797,0.870,0.815,0.759,0.406,0.897,0.890,0.897,0.912,0.893,0.891,0.913,0.892,0.875,0.887,0.421,0.814,0.854,0.871,0.803},
			{0.832,0.892,0.862,0.854,0.496,0.928,0.940,0.937,0.950,0.951,0.940,0.945,0.935,0.932,0.925,0.524,0.862,0.868,0.896,0.818},
			{0.845,0.915,0.860,0.875,0.559,0.935,0.943,0.948,0.958,0.952,0.956,0.954,0.951,0.943,0.938,0.602,0.890,0.876,0.900,0.833},
			{0.849,0.922,0.867,0.904,0.621,0.940,0.950,0.956,0.959,0.960,0.958,0.959,0.951,0.947,0.942,0.671,0.897,0.877,0.917,0.832},
			{0.842,0.922,0.880,0.899,0.650,0.943,0.954,0.958,0.962,0.965,0.959,0.960,0.960,0.951,0.938,0.736,0.908,0.900,0.924,0.820},
			{0.864,0.935,0.887,0.910,0.715,0.944,0.958,0.964,0.963,0.964,0.956,0.964,0.960,0.959,0.949,0.771,0.906,0.907,0.935,0.839},
			{0.867,0.936,0.887,0.910,0.747,0.950,0.961,0.963,0.965,0.965,0.962,0.966,0.966,0.959,0.953,0.815,0.916,0.913,0.935,0.869},
			{0.863,0.937,0.894,0.922,0.805,0.957,0.965,0.966,0.969,0.965,0.974,0.969,0.965,0.965,0.954,0.851,0.917,0.913,0.932,0.863},
			{0.880,0.942,0.907,0.928,0.835,0.957,0.971,0.970,0.976,0.979,0.977,0.977,0.972,0.968,0.962,0.883,0.929,0.923,0.942,0.857},
			{0.878,0.949,0.911,0.937,0.865,0.966,0.975,0.977,0.981,0.985,0.980,0.980,0.979,0.977,0.971,0.899,0.941,0.933,0.943,0.872},
			{0.877,0.946,0.911,0.939,0.892,0.966,0.973,0.979,0.982,0.980,0.984,0.981,0.980,0.975,0.968,0.918,0.943,0.931,0.950,0.878},
			{0.909,0.948,0.920,0.942,0.928,0.966,0.974,0.977,0.982,0.982,0.987,0.981,0.976,0.971,0.967,0.935,0.938,0.937,0.946,0.896},
			{0.906,0.964,0.932,0.940,0.932,0.969,0.976,0.987,0.987,0.988,0.977,0.984,0.984,0.972,0.963,0.941,0.948,0.932,0.954,0.893}};

		static const double fastsim_2016_err[nbins_pt][nbins_eta] = {
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.001,0.001,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.001,0.000,0.000,0.001,0.000,0.000,0.000,0.000,0.000,0.001,0.000,0.000,0.000,0.001,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.002,0.000,0.002,0.001,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.001,0.000,0.002,0.000,0.000,0.000},
			{0.012,0.007,0.009,0.007,0.006,0.011,0.007,0.007,0.004,0.007,0.008,0.004,0.006,0.006,0.011,0.006,0.008,0.009,0.006,0.012},
			{0.015,0.007,0.010,0.009,0.011,0.008,0.007,0.009,0.006,0.013,0.013,0.006,0.009,0.007,0.008,0.011,0.009,0.009,0.007,0.016},
			{0.008,0.003,0.005,0.005,0.009,0.003,0.003,0.004,0.002,0.005,0.004,0.002,0.004,0.003,0.004,0.008,0.004,0.004,0.003,0.008},
			{0.008,0.003,0.004,0.004,0.009,0.003,0.002,0.003,0.001,0.003,0.003,0.002,0.003,0.002,0.003,0.009,0.004,0.004,0.003,0.008},
			{0.007,0.003,0.004,0.003,0.008,0.003,0.002,0.002,0.001,0.003,0.003,0.001,0.002,0.002,0.002,0.007,0.003,0.004,0.003,0.007},
			{0.006,0.002,0.004,0.003,0.006,0.002,0.001,0.002,0.001,0.002,0.002,0.001,0.002,0.002,0.002,0.006,0.003,0.004,0.002,0.006},
			{0.006,0.002,0.003,0.002,0.006,0.002,0.001,0.002,0.001,0.002,0.002,0.001,0.001,0.001,0.002,0.005,0.002,0.003,0.002,0.006},
			{0.005,0.002,0.003,0.002,0.005,0.002,0.001,0.001,0.001,0.002,0.002,0.001,0.001,0.001,0.002,0.004,0.002,0.003,0.002,0.006},
			{0.005,0.002,0.003,0.002,0.004,0.002,0.001,0.001,0.001,0.002,0.002,0.001,0.001,0.001,0.001,0.004,0.002,0.002,0.002,0.005},
			{0.005,0.002,0.003,0.002,0.003,0.001,0.001,0.001,0.001,0.002,0.001,0.001,0.001,0.001,0.001,0.003,0.002,0.002,0.002,0.005},
			{0.005,0.002,0.002,0.002,0.003,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.003,0.002,0.002,0.002,0.005},
			{0.005,0.001,0.002,0.001,0.002,0.001,0.001,0.001,0.000,0.001,0.001,0.000,0.001,0.001,0.001,0.002,0.001,0.002,0.001,0.004},
			{0.006,0.002,0.003,0.002,0.003,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.003,0.002,0.002,0.002,0.005},
			{0.007,0.003,0.004,0.002,0.004,0.002,0.001,0.002,0.001,0.002,0.002,0.001,0.002,0.001,0.002,0.004,0.003,0.003,0.003,0.008},
			{0.015,0.004,0.007,0.005,0.006,0.003,0.002,0.002,0.001,0.003,0.004,0.001,0.002,0.002,0.004,0.006,0.004,0.007,0.005,0.015}};

		unc = 0.;
		if(pt_in_gev<bins_pt[0]) return 0.;
		int ipt = std::upper_bound(bins_pt,bins_pt+nbins_pt+1,pt_in_gev) - bins_pt - 1;
		if(ipt>=nbins_pt) ipt = nbins_pt-1;
		int ieta = std::upper_bound(bins_eta,bins_eta+nbins_eta+1,eta) - bins_eta - 1;
		if(ieta>=nbins_eta || ieta<0) return 0.;
		unc = ((runnumber>290000) ? (fullsim ? fullsim_2016_err : fastsim_2016_err) : (fullsim ? fullsim_2015_err : fastsim_2015_err))[ipt][ieta];
		return ((runnumber>290000) ? (fullsim ? fullsim_2016_val : fastsim_2016_val) : (fullsim ? fullsim_2015_val : fastsim_2015_val))[ipt][ieta];
	}
	double scalefactor_eXmuY_electron(double pt_in_gev, double eta, double& unc,int runnumber, bool fullsim)
	{  // dumped from efficiencySF.MULTI_L_2015_e17_lhloose_2016_e17_lhloose_nod0.MediumLLH_d0z0_v11_isolGradient.root
		static const double bins_pt[] = {7.0,10.0,13.0,15.0,16.0,18.0,21.0,25.0,27.0,30.0,32.5,35.0,37.5,40.0,42.5,45.0,50.0,60.0,80.0,1000.0};
		const int nbins_pt = sizeof(bins_pt)/sizeof(*bins_pt)-1;
		static const double bins_eta[] = {-2.47,-2.37,-2.01,-1.81,-1.52,-1.37,-1.15,-0.80,-0.60,-0.10,0.00,0.10,0.60,0.80,1.15,1.37,1.52,1.81,2.01,2.37,2.47};
		const int nbins_eta = sizeof(bins_eta)/sizeof(*bins_eta)-1;
		static const double fullsim_2015_val[nbins_pt][nbins_eta] = {
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.441,0.575,0.480,0.546,1.053,0.892,0.888,0.810,0.806,0.809,0.761,0.829,0.851,0.950,0.884,1.101,0.528,0.484,0.545,0.416},
			{0.844,0.942,0.932,0.841,0.980,0.968,0.973,0.965,0.986,0.987,0.987,0.987,0.975,0.984,0.971,0.956,0.831,0.953,0.930,0.839},
			{0.948,0.959,0.964,0.946,0.929,0.961,0.971,0.968,0.991,0.987,0.984,0.994,0.980,0.980,0.980,0.959,0.929,0.987,0.953,0.952},
			{0.921,0.977,0.970,0.967,0.928,0.979,0.992,0.973,0.989,0.991,0.985,0.993,0.992,0.992,0.983,0.911,0.968,1.004,0.974,0.921},
			{0.922,0.988,0.973,0.985,0.902,0.976,0.983,0.975,0.993,0.990,0.990,0.994,0.983,0.988,0.982,0.899,0.998,1.003,0.995,0.955},
			{0.922,1.000,0.983,0.996,0.935,0.980,0.991,0.975,0.994,0.988,0.995,0.996,0.990,0.990,0.987,0.898,0.994,1.004,0.993,0.932},
			{0.929,0.991,0.984,0.997,0.916,0.990,0.990,0.978,0.992,0.992,0.999,0.996,0.989,0.991,0.993,0.936,0.997,1.004,0.997,0.958},
			{0.921,0.994,0.983,1.002,0.960,0.987,0.993,0.979,0.995,0.994,0.989,0.995,0.991,0.994,0.994,0.955,0.999,1.003,0.994,0.942},
			{0.916,1.000,0.985,1.000,0.963,0.988,0.991,0.981,0.995,0.993,0.989,0.994,0.990,0.993,0.995,0.961,0.998,1.004,0.996,0.919},
			{0.943,1.000,0.986,0.997,0.974,0.990,0.991,0.983,0.995,0.994,0.991,0.998,0.993,0.993,0.995,0.976,0.997,1.002,0.997,0.936},
			{0.941,0.993,0.982,1.000,0.983,0.990,0.993,0.982,0.996,0.996,0.991,0.998,0.994,0.991,0.995,0.969,0.996,1.003,0.995,0.949},
			{0.943,0.997,0.982,1.000,0.985,0.993,0.995,0.987,0.997,0.997,0.995,0.998,0.996,0.993,0.994,0.963,1.001,1.004,0.992,0.932},
			{0.918,0.997,0.979,1.005,0.978,0.998,0.995,0.984,0.998,0.999,0.995,1.000,0.997,1.001,1.002,0.973,1.002,1.004,0.993,0.960},
			{0.951,0.988,0.968,1.012,0.981,0.990,0.996,0.987,0.996,0.994,0.992,0.997,0.993,0.994,1.002,0.989,1.005,0.997,1.003,0.915}};

		static const double fullsim_2015_err[nbins_pt][nbins_eta] = {
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.026,0.012,0.016,0.016,0.044,0.013,0.014,0.018,0.011,0.025,0.025,0.010,0.019,0.015,0.014,0.046,0.015,0.017,0.012,0.026},
			{0.014,0.006,0.008,0.009,0.022,0.005,0.004,0.005,0.003,0.006,0.007,0.003,0.005,0.004,0.005,0.018,0.008,0.007,0.006,0.014},
			{0.014,0.006,0.008,0.007,0.020,0.006,0.004,0.006,0.002,0.005,0.006,0.002,0.005,0.004,0.006,0.019,0.007,0.008,0.006,0.015},
			{0.011,0.004,0.006,0.005,0.015,0.004,0.002,0.003,0.002,0.003,0.004,0.002,0.003,0.002,0.004,0.012,0.004,0.005,0.004,0.011},
			{0.011,0.003,0.006,0.004,0.016,0.004,0.002,0.003,0.001,0.003,0.003,0.001,0.003,0.002,0.004,0.010,0.004,0.005,0.003,0.011},
			{0.010,0.003,0.005,0.003,0.011,0.003,0.002,0.002,0.001,0.003,0.003,0.001,0.002,0.002,0.003,0.008,0.003,0.004,0.003,0.011},
			{0.010,0.003,0.004,0.003,0.008,0.002,0.002,0.002,0.001,0.003,0.003,0.001,0.002,0.002,0.002,0.007,0.003,0.004,0.003,0.010},
			{0.010,0.003,0.004,0.003,0.006,0.002,0.001,0.002,0.001,0.002,0.002,0.001,0.002,0.001,0.002,0.005,0.003,0.004,0.003,0.010},
			{0.009,0.002,0.004,0.002,0.005,0.002,0.001,0.002,0.001,0.002,0.002,0.001,0.002,0.001,0.002,0.005,0.002,0.003,0.002,0.009},
			{0.008,0.002,0.003,0.002,0.005,0.002,0.001,0.002,0.001,0.002,0.002,0.001,0.001,0.001,0.002,0.004,0.002,0.003,0.002,0.009},
			{0.007,0.002,0.003,0.002,0.004,0.002,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.004,0.002,0.003,0.002,0.007},
			{0.009,0.002,0.004,0.002,0.004,0.002,0.001,0.002,0.001,0.002,0.002,0.001,0.001,0.001,0.002,0.004,0.002,0.003,0.003,0.010},
			{0.015,0.004,0.006,0.003,0.006,0.003,0.002,0.003,0.001,0.002,0.002,0.001,0.002,0.002,0.002,0.006,0.004,0.005,0.004,0.014},
			{0.025,0.007,0.011,0.006,0.011,0.005,0.003,0.004,0.002,0.004,0.005,0.002,0.004,0.003,0.004,0.009,0.006,0.009,0.007,0.028}};

		static const double fastsim_2015_val[nbins_pt][nbins_eta] = {
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.638,0.745,0.654,0.859,2.705,1.069,1.238,1.161,1.138,1.194,1.119,1.155,1.283,1.379,1.071,3.087,0.799,0.656,0.721,0.598},
			{0.951,1.028,1.049,0.975,1.594,1.034,1.042,1.024,1.035,1.045,1.053,1.036,1.039,1.062,1.041,1.517,0.944,1.056,1.018,0.962},
			{1.049,1.043,1.062,1.043,1.342,1.015,1.010,1.011,1.023,1.017,1.026,1.026,1.025,1.025,1.037,1.370,1.009,1.076,1.028,1.090},
			{1.021,1.043,1.059,1.047,1.274,1.026,1.031,1.008,1.013,1.016,1.012,1.020,1.029,1.028,1.030,1.203,1.041,1.092,1.041,1.040},
			{1.026,1.045,1.062,1.053,1.165,1.024,1.016,1.005,1.016,1.013,1.013,1.018,1.015,1.022,1.029,1.107,1.067,1.082,1.056,1.081},
			{1.024,1.054,1.065,1.058,1.167,1.019,1.019,1.002,1.016,1.006,1.020,1.018,1.015,1.019,1.027,1.065,1.055,1.074,1.046,1.046},
			{1.035,1.039,1.062,1.058,1.093,1.027,1.017,1.002,1.012,1.010,1.024,1.017,1.012,1.017,1.028,1.080,1.057,1.070,1.047,1.073},
			{1.021,1.039,1.053,1.060,1.119,1.019,1.018,1.002,1.015,1.012,1.008,1.014,1.014,1.018,1.026,1.076,1.054,1.064,1.042,1.052},
			{1.002,1.047,1.054,1.055,1.091,1.017,1.014,1.002,1.012,1.009,1.005,1.011,1.010,1.016,1.025,1.056,1.049,1.062,1.041,1.007},
			{1.024,1.042,1.044,1.040,1.077,1.015,1.010,1.000,1.008,1.007,1.002,1.011,1.009,1.011,1.020,1.053,1.041,1.055,1.039,1.020},
			{1.013,1.026,1.033,1.040,1.071,1.012,1.010,0.997,1.007,1.006,1.001,1.010,1.009,1.007,1.016,1.030,1.033,1.049,1.032,1.030},
			{1.018,1.034,1.034,1.039,1.058,1.015,1.012,1.001,1.007,1.006,1.005,1.008,1.010,1.008,1.014,1.013,1.038,1.050,1.029,1.010},
			{0.981,1.032,1.027,1.044,1.027,1.020,1.011,0.998,1.009,1.006,1.002,1.011,1.010,1.018,1.022,1.013,1.042,1.052,1.030,1.037},
			{1.012,1.021,1.009,1.055,1.030,1.007,1.008,1.000,1.005,1.003,1.004,1.005,1.004,1.008,1.020,1.032,1.042,1.045,1.041,0.970}};

		static const double fastsim_2015_err[nbins_pt][nbins_eta] = {
			{4.560,2.250,3.329,2.669,4.116,2.977,2.510,3.936,3.304,8.566,7.755,3.307,3.783,2.522,2.984,4.396,2.711,3.229,2.305,4.554},
			{3.628,1.738,2.411,2.113,3.317,2.502,1.847,2.615,1.897,4.936,4.526,1.904,2.596,1.854,2.530,3.291,2.037,2.393,1.793,3.630},
			{3.579,1.829,2.435,2.044,3.148,2.464,7.724,2.389,1.683,4.105,4.173,1.652,2.410,1.841,8.526,3.209,2.024,2.432,1.783,3.621},
			{4.881,2.489,3.198,9.681,3.939,13.308,21.316,3.157,6.649,4.736,5.021,2.104,3.228,2.506,3.242,3.970,29.077,3.204,2.456,4.801},
			{0.809,0.350,0.433,0.285,2.846,0.115,0.323,0.854,0.750,2.464,2.014,0.684,0.894,0.389,0.143,2.647,0.237,0.386,0.329,0.785},
			{0.045,0.018,0.026,0.029,0.129,0.018,0.023,0.030,0.017,0.043,0.043,0.017,0.034,0.025,0.019,0.148,0.027,0.026,0.019,0.044},
			{0.017,0.007,0.010,0.011,0.039,0.006,0.005,0.006,0.003,0.007,0.008,0.003,0.006,0.005,0.006,0.033,0.010,0.009,0.007,0.018},
			{0.018,0.008,0.010,0.009,0.033,0.007,0.005,0.006,0.003,0.006,0.007,0.003,0.006,0.005,0.007,0.030,0.008,0.009,0.007,0.020},
			{0.013,0.005,0.007,0.006,0.023,0.004,0.003,0.004,0.002,0.004,0.004,0.002,0.004,0.003,0.004,0.018,0.005,0.007,0.005,0.014},
			{0.014,0.004,0.007,0.005,0.022,0.004,0.003,0.003,0.002,0.004,0.004,0.002,0.003,0.003,0.004,0.014,0.005,0.006,0.004,0.014},
			{0.013,0.004,0.006,0.004,0.015,0.004,0.002,0.003,0.001,0.003,0.003,0.001,0.002,0.002,0.003,0.011,0.004,0.005,0.004,0.013},
			{0.012,0.003,0.006,0.004,0.010,0.003,0.002,0.002,0.001,0.003,0.003,0.001,0.002,0.002,0.003,0.009,0.004,0.005,0.003,0.012},
			{0.012,0.003,0.005,0.003,0.008,0.003,0.002,0.002,0.001,0.003,0.003,0.001,0.002,0.002,0.002,0.007,0.003,0.004,0.003,0.012},
			{0.011,0.003,0.005,0.003,0.007,0.002,0.002,0.002,0.001,0.002,0.002,0.001,0.002,0.001,0.002,0.006,0.003,0.004,0.003,0.011},
			{0.010,0.003,0.004,0.003,0.006,0.002,0.001,0.002,0.001,0.002,0.002,0.001,0.002,0.001,0.002,0.005,0.003,0.004,0.003,0.010},
			{0.009,0.002,0.004,0.002,0.005,0.002,0.001,0.002,0.001,0.002,0.002,0.001,0.001,0.001,0.002,0.004,0.002,0.003,0.002,0.009},
			{0.011,0.003,0.005,0.003,0.005,0.002,0.001,0.002,0.001,0.002,0.002,0.001,0.002,0.001,0.002,0.005,0.003,0.004,0.003,0.012},
			{0.017,0.004,0.007,0.004,0.007,0.003,0.002,0.003,0.001,0.002,0.003,0.001,0.002,0.002,0.003,0.006,0.004,0.006,0.005,0.017},
			{0.030,0.009,0.012,0.007,0.012,0.005,0.003,0.005,0.002,0.005,0.006,0.002,0.004,0.004,0.005,0.011,0.007,0.011,0.009,0.033}};

		static const double fullsim_2016_val[nbins_pt][nbins_eta] = {
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.548,0.730,0.726,0.717,1.259,0.979,0.979,0.802,0.873,0.753,0.804,0.839,0.878,1.013,0.942,1.422,0.704,0.704,0.728,0.576},
			{0.931,0.967,0.968,0.916,1.032,0.985,0.983,0.977,0.992,0.968,0.980,0.989,0.995,0.990,0.987,1.000,0.898,0.977,0.960,0.921},
			{0.991,0.986,0.970,0.983,1.019,0.969,0.985,0.975,0.989,0.977,0.988,1.001,0.985,0.987,0.977,0.973,0.981,1.011,0.973,0.977},
			{0.941,0.980,0.988,0.998,0.992,0.990,0.992,0.979,0.994,0.989,0.995,0.996,0.990,0.992,0.985,0.986,0.991,1.020,0.998,0.961},
			{0.958,1.004,0.990,0.996,0.973,0.983,0.989,0.982,0.994,0.985,0.997,1.000,0.996,0.997,0.985,0.970,1.005,1.014,1.005,0.976},
			{0.974,1.006,0.987,1.010,0.997,0.990,0.991,0.981,0.998,0.983,0.995,0.999,0.994,0.996,1.001,0.974,1.001,1.012,1.006,0.973},
			{0.983,1.005,0.992,1.006,0.979,0.996,0.994,0.983,0.996,0.984,0.997,0.999,0.995,0.994,0.997,0.979,1.008,1.008,1.001,0.993},
			{0.952,1.002,0.996,1.005,1.004,0.998,0.994,0.987,0.997,0.993,0.993,0.998,0.998,0.999,0.998,0.999,1.002,1.010,1.008,0.962},
			{0.946,1.004,0.984,1.003,1.015,0.995,0.995,0.990,0.997,0.996,0.988,0.998,0.996,0.997,0.994,1.007,1.005,1.014,1.012,0.963},
			{0.951,1.001,0.987,1.006,1.018,0.997,0.993,0.991,0.998,0.997,0.991,0.999,0.998,0.997,0.998,1.007,1.005,1.011,0.998,0.968},
			{0.963,1.003,0.994,1.005,1.013,0.995,0.992,0.986,0.999,0.998,0.996,0.999,0.997,0.996,0.995,1.007,1.000,1.007,1.007,0.968},
			{0.960,1.001,0.990,1.008,1.016,0.999,0.996,0.988,0.998,0.999,0.997,0.999,0.997,0.995,0.999,1.002,1.003,1.009,1.003,0.960},
			{0.945,0.991,0.993,1.006,1.000,1.000,0.992,0.991,0.999,1.002,0.996,1.001,1.001,1.003,0.999,0.996,1.006,1.005,1.001,0.944},
			{0.948,0.989,0.993,1.013,0.996,1.005,0.995,0.985,1.001,0.994,1.001,1.000,0.994,1.002,1.001,0.996,1.003,1.012,0.999,0.935}};

		static const double fullsim_2016_err[nbins_pt][nbins_eta] = {
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.034,0.015,0.022,0.020,0.051,0.014,0.016,0.021,0.012,0.028,0.028,0.012,0.022,0.016,0.015,0.061,0.019,0.021,0.015,0.032},
			{0.016,0.006,0.009,0.008,0.021,0.006,0.005,0.006,0.003,0.008,0.007,0.003,0.006,0.005,0.006,0.020,0.008,0.008,0.006,0.016},
			{0.015,0.006,0.008,0.007,0.018,0.006,0.004,0.005,0.002,0.006,0.006,0.002,0.005,0.004,0.006,0.018,0.006,0.007,0.006,0.014},
			{0.013,0.005,0.007,0.005,0.015,0.004,0.003,0.004,0.002,0.004,0.004,0.002,0.004,0.003,0.004,0.014,0.005,0.006,0.005,0.013},
			{0.012,0.004,0.006,0.004,0.013,0.004,0.003,0.003,0.002,0.004,0.004,0.002,0.003,0.002,0.004,0.011,0.004,0.005,0.004,0.013},
			{0.011,0.003,0.005,0.004,0.011,0.004,0.002,0.003,0.001,0.004,0.004,0.001,0.002,0.002,0.003,0.009,0.004,0.005,0.003,0.012},
			{0.011,0.003,0.005,0.003,0.008,0.003,0.002,0.002,0.001,0.003,0.003,0.001,0.002,0.002,0.003,0.007,0.003,0.004,0.003,0.011},
			{0.011,0.003,0.005,0.003,0.007,0.002,0.002,0.002,0.001,0.003,0.003,0.001,0.002,0.001,0.002,0.006,0.003,0.004,0.003,0.011},
			{0.010,0.003,0.004,0.003,0.005,0.002,0.002,0.002,0.001,0.002,0.002,0.001,0.002,0.001,0.002,0.005,0.003,0.003,0.002,0.010},
			{0.009,0.002,0.004,0.002,0.005,0.002,0.001,0.002,0.001,0.002,0.002,0.001,0.002,0.001,0.002,0.004,0.002,0.003,0.002,0.010},
			{0.008,0.002,0.003,0.002,0.004,0.002,0.001,0.002,0.001,0.001,0.002,0.001,0.001,0.001,0.002,0.004,0.002,0.003,0.002,0.008},
			{0.010,0.003,0.005,0.002,0.004,0.002,0.001,0.002,0.001,0.002,0.002,0.001,0.002,0.001,0.002,0.004,0.002,0.003,0.003,0.010},
			{0.015,0.004,0.006,0.003,0.006,0.003,0.002,0.003,0.001,0.002,0.003,0.001,0.002,0.002,0.003,0.006,0.004,0.005,0.004,0.016},
			{0.028,0.007,0.010,0.006,0.010,0.004,0.003,0.005,0.002,0.005,0.005,0.002,0.004,0.003,0.005,0.009,0.006,0.009,0.008,0.031}};

		static const double fastsim_2016_val[nbins_pt][nbins_eta] = {
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.783,0.957,1.003,1.141,3.167,1.184,1.361,1.155,1.241,1.092,1.176,1.168,1.322,1.422,1.141,4.151,1.050,0.968,0.968,0.819},
			{1.059,1.057,1.095,1.067,1.650,1.053,1.054,1.042,1.043,1.030,1.042,1.040,1.063,1.071,1.063,1.562,1.013,1.078,1.052,1.045},
			{1.112,1.066,1.060,1.083,1.478,1.023,1.027,1.020,1.021,1.007,1.025,1.037,1.030,1.033,1.035,1.366,1.076,1.102,1.047,1.104},
			{1.042,1.042,1.084,1.081,1.346,1.038,1.030,1.013,1.020,1.017,1.021,1.023,1.024,1.029,1.029,1.293,1.062,1.107,1.069,1.085},
			{1.066,1.060,1.080,1.061,1.254,1.031,1.024,1.017,1.020,1.008,1.024,1.025,1.032,1.035,1.035,1.207,1.073,1.096,1.067,1.108},
			{1.084,1.059,1.067,1.079,1.257,1.031,1.022,1.009,1.020,1.002,1.019,1.021,1.022,1.028,1.046,1.156,1.061,1.084,1.060,1.103},
			{1.095,1.051,1.070,1.064,1.175,1.034,1.022,1.009,1.018,1.005,1.024,1.023,1.024,1.020,1.031,1.136,1.070,1.075,1.047,1.133},
			{1.053,1.047,1.072,1.064,1.180,1.031,1.018,1.011,1.018,1.014,1.016,1.018,1.020,1.024,1.030,1.125,1.057,1.069,1.055,1.075},
			{1.040,1.050,1.053,1.052,1.146,1.026,1.019,1.013,1.015,1.017,1.004,1.018,1.020,1.021,1.026,1.107,1.057,1.074,1.060,1.061},
			{1.027,1.040,1.047,1.050,1.128,1.026,1.012,1.010,1.011,1.009,1.004,1.012,1.016,1.017,1.024,1.085,1.048,1.062,1.036,1.063},
			{1.040,1.036,1.050,1.044,1.102,1.017,1.009,1.002,1.011,1.007,1.008,1.010,1.012,1.012,1.016,1.074,1.035,1.050,1.045,1.046},
			{1.035,1.036,1.045,1.045,1.088,1.021,1.013,1.002,1.008,1.010,1.008,1.010,1.010,1.010,1.020,1.058,1.038,1.053,1.037,1.034},
			{0.995,1.024,1.045,1.043,1.050,1.020,1.008,1.005,1.010,1.011,1.005,1.012,1.016,1.020,1.019,1.040,1.045,1.047,1.038,1.007},
			{1.010,1.012,1.038,1.052,1.039,1.027,1.008,0.994,1.010,1.003,1.015,1.010,1.004,1.020,1.023,1.029,1.034,1.062,1.037,1.004}};

		static const double fastsim_2016_err[nbins_pt][nbins_eta] = {
			{3.992,2.100,2.874,2.404,3.761,2.706,2.310,3.452,2.872,7.369,7.612,2.871,3.390,2.325,2.732,3.888,2.392,2.918,2.083,3.991},
			{3.334,1.591,2.147,1.889,2.991,2.221,1.650,2.263,1.697,4.308,4.260,1.713,2.291,1.639,2.227,2.957,1.797,2.116,1.594,3.131},
			{3.313,1.634,2.201,6.460,2.732,2.169,5.420,2.178,1.506,3.610,3.670,1.494,8.486,1.632,2.138,2.833,6.835,2.195,1.590,3.287},
			{4.331,2.202,2.792,19.941,3.515,19.610,12.205,2.835,1.892,4.491,4.427,1.852,2.920,2.202,7.480,3.516,24.980,2.881,2.202,4.327},
			{0.757,0.339,0.442,0.302,2.929,0.145,0.348,0.851,0.729,3.403,1.871,0.593,1.089,0.401,0.143,3.506,0.269,0.432,0.361,0.834},
			{0.055,0.022,0.034,0.037,0.142,0.019,0.025,0.034,0.020,0.046,0.047,0.018,0.038,0.025,0.020,0.196,0.032,0.032,0.022,0.052},
			{0.019,0.007,0.011,0.011,0.037,0.007,0.006,0.007,0.004,0.009,0.008,0.004,0.007,0.006,0.007,0.035,0.010,0.010,0.007,0.019},
			{0.018,0.007,0.010,0.009,0.030,0.007,0.004,0.006,0.003,0.006,0.007,0.003,0.006,0.005,0.007,0.028,0.008,0.009,0.007,0.018},
			{0.016,0.005,0.009,0.006,0.022,0.005,0.003,0.005,0.002,0.005,0.005,0.002,0.004,0.003,0.005,0.020,0.006,0.008,0.005,0.017},
			{0.015,0.004,0.008,0.005,0.019,0.005,0.003,0.004,0.002,0.004,0.004,0.002,0.004,0.003,0.005,0.015,0.005,0.007,0.005,0.016},
			{0.013,0.004,0.007,0.004,0.015,0.004,0.002,0.003,0.002,0.004,0.004,0.002,0.003,0.002,0.004,0.012,0.004,0.006,0.004,0.015},
			{0.013,0.003,0.006,0.004,0.011,0.003,0.002,0.003,0.001,0.004,0.004,0.001,0.003,0.002,0.003,0.009,0.004,0.005,0.003,0.015},
			{0.014,0.003,0.006,0.004,0.009,0.003,0.002,0.002,0.001,0.003,0.003,0.001,0.002,0.002,0.003,0.007,0.003,0.004,0.003,0.013},
			{0.012,0.003,0.005,0.003,0.007,0.003,0.002,0.002,0.001,0.003,0.003,0.001,0.002,0.002,0.003,0.006,0.003,0.004,0.003,0.012},
			{0.011,0.003,0.005,0.003,0.006,0.002,0.002,0.002,0.001,0.002,0.002,0.001,0.002,0.001,0.002,0.005,0.003,0.004,0.003,0.012},
			{0.009,0.002,0.004,0.002,0.005,0.002,0.001,0.002,0.001,0.002,0.002,0.001,0.001,0.001,0.002,0.004,0.002,0.003,0.002,0.009},
			{0.012,0.003,0.005,0.003,0.005,0.002,0.002,0.002,0.001,0.002,0.002,0.001,0.002,0.002,0.002,0.005,0.003,0.004,0.003,0.012},
			{0.017,0.005,0.007,0.004,0.007,0.003,0.002,0.003,0.001,0.003,0.003,0.001,0.003,0.002,0.003,0.007,0.004,0.006,0.005,0.018},
			{0.033,0.008,0.012,0.008,0.011,0.005,0.004,0.005,0.002,0.006,0.006,0.002,0.004,0.004,0.006,0.010,0.007,0.011,0.009,0.036}};

		unc = 0.;
		if(pt_in_gev<bins_pt[0]) return 0.;
		int ipt = std::upper_bound(bins_pt,bins_pt+nbins_pt+1,pt_in_gev) - bins_pt - 1;
		if(ipt>=nbins_pt) ipt = nbins_pt-1;
		int ieta = std::upper_bound(bins_eta,bins_eta+nbins_eta+1,eta) - bins_eta - 1;
		if(ieta>=nbins_eta || ieta<0) return 0.;
		unc = ((runnumber>290000) ? (fullsim ? fullsim_2016_err : fastsim_2016_err) : (fullsim ? fullsim_2015_err : fastsim_2015_err))[ipt][ieta];
		return ((runnumber>290000) ? (fullsim ? fullsim_2016_val : fastsim_2016_val) : (fullsim ? fullsim_2015_val : fastsim_2015_val))[ipt][ieta];
	}
	double efficiency_data_eXmuY_muon(double eta, double phi, double& unc,int runnumber)
	{
		static const double bins_eta_barrel[] = {-1.05,-0.91,-0.48,0.00,0.48,0.91,1.05};
		const int nbins_eta_barrel = sizeof(bins_eta_barrel)/sizeof(*bins_eta_barrel)-1;
		static const double bins_eta_endcap[] = {-2.50,-2.40,-1.92,-1.35,-1.15,-1.05,1.05,1.15,1.35,1.92,2.40,2.50};
		const int nbins_eta_endcap = sizeof(bins_eta_endcap)/sizeof(*bins_eta_endcap)-1;
		static const double bins_phi_barrel[] = {-2.95,-2.16,-0.98,-0.20,0.98,2.16,3.34};
		const int nbins_phi_barrel = sizeof(bins_phi_barrel)/sizeof(*bins_phi_barrel)-1;
		static const double bins_phi_endcap[] = {-3.40,-2.88,-2.36,-1.83,-1.31,-0.79,-0.26,0.26,0.79,1.31,1.83,2.36,2.88};
		const int nbins_phi_endcap = sizeof(bins_phi_endcap)/sizeof(*bins_phi_endcap)-1;
		static const double barrel_2015_D_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.509,0.353,0.665,0.758,0.546,0.737},
			{0.864,0.431,0.727,0.920,0.840,0.902},
			{0.704,0.607,0.815,0.840,0.726,0.791},
			{0.851,0.608,0.822,0.721,0.751,0.774},
			{0.844,0.432,0.737,0.705,0.830,0.910},
			{0.640,0.128,0.632,0.755,0.544,0.722}};

		static const double barrel_2015_D_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.036,0.028,0.033,0.026,0.031,0.026},
			{0.013,0.016,0.017,0.009,0.012,0.009},
			{0.017,0.014,0.014,0.011,0.014,0.013},
			{0.014,0.014,0.014,0.013,0.014,0.013},
			{0.014,0.015,0.017,0.014,0.013,0.009},
			{0.033,0.020,0.033,0.024,0.031,0.026}};

		static const double endcap_2015_D_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.364,0.311,0.531,0.377,0.411,0.379,0.400,0.321,0.464,0.435,0.387,0.433},
			{0.945,0.876,0.903,0.902,0.871,0.875,0.920,0.885,0.826,0.938,0.869,0.891},
			{0.929,0.928,0.889,0.959,0.903,0.938,0.968,0.964,0.951,0.946,0.922,0.925},
			{0.944,0.952,0.946,0.915,0.944,0.931,0.951,0.942,0.961,0.899,0.938,0.968},
			{0.849,0.822,0.702,0.907,0.786,0.786,0.809,0.808,0.817,0.848,0.831,0.856},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.713,0.784,0.790,0.671,0.659,0.822,0.852,0.859,0.762,0.950,0.844,0.894},
			{0.899,0.876,0.939,0.962,0.885,0.898,0.934,0.931,0.960,0.935,0.922,0.954},
			{0.942,0.932,0.897,0.943,0.939,0.909,0.938,0.958,0.941,0.865,0.894,0.924},
			{0.865,0.894,0.892,0.917,0.857,0.895,0.885,0.863,0.764,0.911,0.781,0.865},
			{0.482,0.436,0.519,0.452,0.500,0.500,0.440,0.417,0.391,0.472,0.375,0.459}};

		static const double endcap_2015_D_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.073,0.067,0.081,0.075,0.074,0.072,0.071,0.071,0.075,0.066,0.069,0.067},
			{0.014,0.018,0.018,0.017,0.020,0.019,0.016,0.019,0.024,0.015,0.021,0.018},
			{0.012,0.013,0.015,0.010,0.014,0.012,0.009,0.009,0.011,0.012,0.014,0.013},
			{0.018,0.018,0.019,0.022,0.018,0.022,0.018,0.020,0.017,0.026,0.021,0.015},
			{0.042,0.043,0.052,0.033,0.046,0.046,0.046,0.043,0.043,0.047,0.045,0.039},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.048,0.045,0.046,0.059,0.057,0.041,0.045,0.044,0.054,0.027,0.044,0.037},
			{0.024,0.026,0.021,0.017,0.027,0.026,0.020,0.022,0.020,0.023,0.023,0.017},
			{0.012,0.013,0.015,0.012,0.012,0.014,0.012,0.010,0.012,0.018,0.017,0.013},
			{0.021,0.019,0.019,0.016,0.021,0.019,0.020,0.020,0.027,0.019,0.026,0.020},
			{0.075,0.075,0.076,0.088,0.071,0.075,0.079,0.071,0.068,0.077,0.073,0.071}};

		static const double barrel_2015_E_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.548,0.329,0.651,0.752,0.496,0.777},
			{0.869,0.436,0.774,0.910,0.832,0.891},
			{0.776,0.607,0.830,0.826,0.785,0.797},
			{0.850,0.574,0.841,0.779,0.714,0.778},
			{0.853,0.415,0.725,0.722,0.830,0.871},
			{0.624,0.368,0.673,0.749,0.582,0.746}};

		static const double barrel_2015_E_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.011,0.009,0.011,0.008,0.010,0.008},
			{0.004,0.005,0.005,0.003,0.004,0.003},
			{0.005,0.005,0.005,0.004,0.004,0.004},
			{0.005,0.005,0.005,0.004,0.005,0.004},
			{0.005,0.005,0.006,0.005,0.004,0.004},
			{0.012,0.009,0.011,0.008,0.010,0.008}};

		static const double endcap_2015_E_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.400,0.414,0.382,0.392,0.444,0.412,0.402,0.376,0.389,0.438,0.430,0.438},
			{0.912,0.877,0.884,0.894,0.873,0.891,0.898,0.880,0.810,0.914,0.873,0.902},
			{0.929,0.921,0.880,0.933,0.907,0.940,0.957,0.938,0.944,0.942,0.900,0.944},
			{0.941,0.935,0.934,0.928,0.960,0.958,0.956,0.960,0.962,0.883,0.922,0.951},
			{0.862,0.823,0.652,0.871,0.792,0.837,0.813,0.807,0.816,0.836,0.840,0.885},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.763,0.758,0.797,0.794,0.758,0.809,0.836,0.771,0.760,0.921,0.872,0.812},
			{0.941,0.929,0.939,0.950,0.913,0.939,0.945,0.952,0.936,0.938,0.946,0.958},
			{0.948,0.938,0.904,0.938,0.923,0.923,0.946,0.933,0.915,0.896,0.900,0.920},
			{0.905,0.892,0.873,0.904,0.871,0.882,0.915,0.893,0.794,0.907,0.857,0.862},
			{0.454,0.468,0.479,0.447,0.462,0.482,0.444,0.446,0.434,0.457,0.403,0.447}};

		static const double endcap_2015_E_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.023,0.023,0.024,0.023,0.024,0.023,0.022,0.023,0.024,0.025,0.024,0.022},
			{0.006,0.006,0.006,0.006,0.006,0.006,0.006,0.006,0.008,0.006,0.007,0.006},
			{0.004,0.004,0.005,0.004,0.005,0.004,0.003,0.004,0.004,0.004,0.005,0.004},
			{0.006,0.006,0.007,0.007,0.005,0.005,0.005,0.005,0.005,0.010,0.007,0.006},
			{0.012,0.014,0.017,0.012,0.014,0.013,0.013,0.014,0.015,0.016,0.014,0.012},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.015,0.015,0.014,0.014,0.016,0.014,0.013,0.015,0.016,0.011,0.013,0.014},
			{0.006,0.007,0.006,0.006,0.007,0.006,0.006,0.006,0.007,0.007,0.006,0.005},
			{0.004,0.004,0.005,0.004,0.004,0.004,0.004,0.004,0.005,0.005,0.005,0.004},
			{0.006,0.006,0.006,0.006,0.007,0.006,0.005,0.006,0.008,0.006,0.007,0.007},
			{0.024,0.023,0.024,0.023,0.022,0.023,0.024,0.023,0.024,0.024,0.023,0.023}};

		static const double barrel_2015_F_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.512,0.331,0.663,0.750,0.477,0.781},
			{0.858,0.436,0.763,0.903,0.790,0.888},
			{0.757,0.632,0.837,0.829,0.779,0.806},
			{0.842,0.548,0.824,0.777,0.701,0.769},
			{0.833,0.438,0.693,0.713,0.827,0.867},
			{0.599,0.355,0.665,0.693,0.571,0.729}};

		static const double barrel_2015_F_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.015,0.011,0.013,0.010,0.013,0.010},
			{0.005,0.007,0.007,0.004,0.006,0.004},
			{0.006,0.006,0.006,0.005,0.005,0.005},
			{0.006,0.006,0.006,0.005,0.006,0.005},
			{0.006,0.006,0.007,0.006,0.005,0.004},
			{0.014,0.011,0.013,0.011,0.013,0.010}};

		static const double endcap_2015_F_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.407,0.398,0.403,0.414,0.402,0.461,0.414,0.408,0.367,0.446,0.412,0.413},
			{0.904,0.878,0.888,0.895,0.867,0.887,0.904,0.887,0.812,0.906,0.888,0.892},
			{0.926,0.924,0.888,0.947,0.901,0.928,0.959,0.942,0.940,0.936,0.891,0.940},
			{0.943,0.945,0.937,0.935,0.949,0.962,0.945,0.954,0.958,0.873,0.929,0.961},
			{0.872,0.805,0.645,0.870,0.797,0.870,0.838,0.797,0.798,0.790,0.842,0.882},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.779,0.778,0.747,0.841,0.756,0.800,0.823,0.777,0.768,0.907,0.868,0.793},
			{0.938,0.914,0.922,0.930,0.915,0.929,0.936,0.946,0.944,0.930,0.940,0.955},
			{0.952,0.938,0.885,0.937,0.920,0.941,0.949,0.931,0.925,0.889,0.905,0.912},
			{0.904,0.884,0.873,0.906,0.877,0.887,0.898,0.878,0.804,0.882,0.818,0.828},
			{0.403,0.418,0.512,0.469,0.447,0.448,0.402,0.437,0.382,0.453,0.460,0.421}};

		static const double endcap_2015_F_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.027,0.028,0.030,0.030,0.028,0.027,0.027,0.027,0.028,0.031,0.028,0.030},
			{0.007,0.008,0.008,0.007,0.008,0.007,0.007,0.008,0.010,0.007,0.008,0.007},
			{0.005,0.005,0.006,0.004,0.006,0.005,0.004,0.005,0.005,0.005,0.006,0.005},
			{0.007,0.007,0.008,0.008,0.007,0.006,0.007,0.007,0.007,0.012,0.009,0.006},
			{0.015,0.016,0.021,0.014,0.017,0.014,0.016,0.017,0.019,0.021,0.018,0.014},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.018,0.018,0.019,0.016,0.019,0.018,0.017,0.018,0.019,0.014,0.016,0.018},
			{0.008,0.009,0.009,0.008,0.009,0.008,0.008,0.007,0.008,0.009,0.008,0.007},
			{0.004,0.005,0.006,0.005,0.005,0.005,0.004,0.005,0.005,0.007,0.006,0.006},
			{0.007,0.008,0.008,0.007,0.008,0.008,0.007,0.008,0.010,0.008,0.010,0.009},
			{0.028,0.029,0.029,0.028,0.030,0.029,0.027,0.031,0.029,0.029,0.030,0.028}};

		static const double barrel_2015_G_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.510,0.324,0.637,0.765,0.503,0.780},
			{0.863,0.449,0.762,0.909,0.815,0.894},
			{0.750,0.635,0.825,0.823,0.779,0.805},
			{0.835,0.504,0.822,0.774,0.734,0.771},
			{0.798,0.449,0.652,0.722,0.824,0.865},
			{0.627,0.382,0.613,0.712,0.576,0.755}};

		static const double barrel_2015_G_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.009,0.007,0.009,0.006,0.008,0.006},
			{0.003,0.004,0.004,0.002,0.004,0.003},
			{0.004,0.004,0.004,0.003,0.004,0.003},
			{0.004,0.004,0.004,0.003,0.004,0.003},
			{0.004,0.004,0.005,0.004,0.003,0.003},
			{0.009,0.007,0.009,0.007,0.008,0.007}};

		static const double endcap_2015_G_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.419,0.446,0.413,0.407,0.409,0.422,0.396,0.410,0.369,0.428,0.399,0.399},
			{0.905,0.879,0.888,0.900,0.873,0.892,0.904,0.875,0.804,0.909,0.873,0.898},
			{0.923,0.925,0.883,0.932,0.892,0.937,0.950,0.942,0.946,0.939,0.892,0.940},
			{0.934,0.924,0.929,0.940,0.948,0.960,0.931,0.953,0.953,0.898,0.930,0.958},
			{0.880,0.799,0.597,0.883,0.784,0.852,0.822,0.796,0.829,0.784,0.834,0.863},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.753,0.762,0.763,0.849,0.751,0.808,0.836,0.782,0.726,0.899,0.854,0.821},
			{0.931,0.915,0.931,0.936,0.915,0.933,0.939,0.936,0.927,0.938,0.935,0.963},
			{0.942,0.936,0.881,0.934,0.922,0.933,0.946,0.934,0.923,0.895,0.888,0.914},
			{0.903,0.890,0.873,0.910,0.877,0.884,0.912,0.887,0.848,0.881,0.838,0.848},
			{0.443,0.462,0.447,0.470,0.443,0.440,0.444,0.468,0.442,0.456,0.416,0.423}};

		static const double endcap_2015_G_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.018,0.018,0.018,0.018,0.018,0.018,0.017,0.018,0.018,0.018,0.018,0.018},
			{0.004,0.005,0.005,0.005,0.005,0.005,0.004,0.005,0.006,0.005,0.005,0.005},
			{0.003,0.003,0.004,0.003,0.004,0.003,0.003,0.003,0.003,0.003,0.004,0.003},
			{0.005,0.005,0.005,0.005,0.004,0.004,0.005,0.004,0.005,0.007,0.006,0.004},
			{0.009,0.011,0.014,0.009,0.012,0.010,0.010,0.011,0.012,0.013,0.011,0.009},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.012,0.012,0.012,0.010,0.012,0.011,0.010,0.011,0.013,0.009,0.011,0.011},
			{0.005,0.006,0.005,0.005,0.005,0.005,0.005,0.005,0.006,0.005,0.005,0.004},
			{0.003,0.003,0.004,0.003,0.003,0.003,0.003,0.003,0.004,0.004,0.004,0.004},
			{0.004,0.005,0.005,0.004,0.005,0.005,0.004,0.005,0.006,0.005,0.006,0.005},
			{0.018,0.018,0.018,0.018,0.018,0.018,0.017,0.018,0.019,0.019,0.018,0.018}};

		static const double barrel_2015_H_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.576,0.242,0.664,0.740,0.496,0.777},
			{0.848,0.399,0.757,0.911,0.818,0.883},
			{0.743,0.353,0.822,0.828,0.747,0.799},
			{0.842,0.262,0.823,0.779,0.738,0.761},
			{0.844,0.385,0.648,0.715,0.820,0.862},
			{0.664,0.248,0.587,0.732,0.546,0.708}};

		static const double barrel_2015_H_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.015,0.011,0.015,0.011,0.015,0.011},
			{0.006,0.007,0.007,0.004,0.006,0.004},
			{0.007,0.006,0.006,0.005,0.007,0.006},
			{0.006,0.006,0.006,0.005,0.007,0.006},
			{0.006,0.007,0.008,0.006,0.006,0.005},
			{0.015,0.011,0.015,0.011,0.015,0.012}};

		static const double endcap_2015_H_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.428,0.419,0.451,0.363,0.385,0.420,0.426,0.397,0.395,0.460,0.454,0.409},
			{0.892,0.863,0.877,0.902,0.878,0.885,0.907,0.880,0.782,0.903,0.855,0.870},
			{0.922,0.923,0.879,0.934,0.898,0.922,0.945,0.952,0.941,0.943,0.901,0.940},
			{0.923,0.942,0.920,0.936,0.949,0.967,0.926,0.954,0.956,0.860,0.918,0.953},
			{0.902,0.804,0.627,0.817,0.800,0.854,0.810,0.814,0.800,0.803,0.859,0.853},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.785,0.785,0.764,0.778,0.729,0.820,0.818,0.786,0.557,0.922,0.850,0.820},
			{0.929,0.920,0.952,0.949,0.904,0.944,0.933,0.924,0.932,0.924,0.942,0.944},
			{0.949,0.933,0.901,0.938,0.916,0.931,0.934,0.935,0.897,0.897,0.909,0.933},
			{0.907,0.895,0.879,0.920,0.880,0.887,0.908,0.885,0.837,0.884,0.843,0.834},
			{0.424,0.436,0.446,0.451,0.467,0.395,0.417,0.443,0.455,0.465,0.358,0.442}};

		static const double endcap_2015_H_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.030,0.031,0.030,0.030,0.031,0.030,0.030,0.030,0.032,0.034,0.031,0.030},
			{0.008,0.009,0.009,0.008,0.008,0.008,0.007,0.008,0.011,0.009,0.010,0.009},
			{0.006,0.005,0.007,0.005,0.006,0.006,0.005,0.005,0.006,0.006,0.007,0.005},
			{0.009,0.008,0.009,0.008,0.007,0.006,0.009,0.007,0.008,0.015,0.010,0.008},
			{0.014,0.018,0.023,0.019,0.019,0.017,0.018,0.019,0.020,0.023,0.019,0.017},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.020,0.019,0.020,0.019,0.020,0.018,0.018,0.020,0.027,0.015,0.020,0.019},
			{0.009,0.009,0.007,0.008,0.010,0.008,0.009,0.009,0.010,0.011,0.009,0.008},
			{0.005,0.005,0.006,0.005,0.006,0.005,0.005,0.005,0.007,0.007,0.007,0.005},
			{0.007,0.008,0.008,0.007,0.008,0.008,0.007,0.008,0.010,0.009,0.010,0.010},
			{0.031,0.031,0.031,0.030,0.032,0.031,0.030,0.032,0.033,0.036,0.033,0.032}};

		static const double barrel_2015_J_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.576,0.348,0.661,0.720,0.508,0.771},
			{0.863,0.544,0.761,0.908,0.813,0.891},
			{0.754,0.630,0.824,0.827,0.778,0.795},
			{0.847,0.583,0.823,0.779,0.733,0.764},
			{0.846,0.499,0.728,0.719,0.819,0.850},
			{0.625,0.393,0.643,0.723,0.566,0.709}};

		static const double barrel_2015_J_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.006,0.005,0.006,0.005,0.006,0.004},
			{0.002,0.003,0.003,0.002,0.002,0.002},
			{0.003,0.003,0.003,0.002,0.002,0.002},
			{0.002,0.003,0.003,0.002,0.003,0.002},
			{0.003,0.003,0.003,0.003,0.002,0.002},
			{0.006,0.005,0.006,0.005,0.006,0.005}};

		static const double endcap_2015_J_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.421,0.442,0.408,0.404,0.394,0.431,0.411,0.416,0.362,0.422,0.419,0.422},
			{0.902,0.877,0.883,0.895,0.863,0.883,0.910,0.884,0.798,0.904,0.867,0.878},
			{0.918,0.920,0.883,0.937,0.889,0.927,0.953,0.936,0.946,0.941,0.890,0.934},
			{0.943,0.935,0.934,0.934,0.951,0.963,0.942,0.958,0.958,0.894,0.926,0.944},
			{0.865,0.797,0.600,0.859,0.786,0.849,0.821,0.793,0.816,0.803,0.847,0.866},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.779,0.759,0.764,0.834,0.742,0.829,0.818,0.772,0.670,0.906,0.860,0.811},
			{0.936,0.914,0.945,0.940,0.912,0.939,0.941,0.936,0.929,0.938,0.935,0.953},
			{0.946,0.932,0.886,0.939,0.921,0.930,0.942,0.936,0.917,0.899,0.903,0.924},
			{0.906,0.881,0.880,0.910,0.881,0.881,0.910,0.887,0.845,0.894,0.827,0.857},
			{0.458,0.467,0.452,0.443,0.438,0.463,0.456,0.446,0.406,0.445,0.422,0.421}};

		static const double endcap_2015_J_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.013,0.012,0.013,0.012,0.012,0.012,0.012,0.012,0.013,0.013,0.013,0.012},
			{0.003,0.003,0.003,0.003,0.004,0.003,0.003,0.003,0.004,0.003,0.004,0.004},
			{0.002,0.002,0.003,0.002,0.003,0.002,0.002,0.002,0.002,0.002,0.003,0.002},
			{0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.005,0.004,0.003},
			{0.007,0.008,0.010,0.007,0.008,0.007,0.007,0.008,0.008,0.009,0.007,0.007},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.008,0.008,0.008,0.007,0.008,0.007,0.007,0.008,0.010,0.006,0.007,0.008},
			{0.003,0.004,0.003,0.003,0.004,0.003,0.003,0.003,0.004,0.004,0.004,0.003},
			{0.002,0.002,0.003,0.002,0.002,0.002,0.002,0.002,0.003,0.003,0.003,0.002},
			{0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.004,0.003,0.004,0.004},
			{0.013,0.013,0.012,0.012,0.012,0.013,0.013,0.013,0.013,0.013,0.013,0.013}};

		static const double barrel_2016_A_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.596,0.491,0.572,0.762,0.526,0.779},
			{0.855,0.655,0.793,0.917,0.832,0.877},
			{0.740,0.722,0.809,0.809,0.798,0.745},
			{0.830,0.673,0.838,0.803,0.751,0.761},
			{0.830,0.627,0.723,0.729,0.842,0.864},
			{0.611,0.459,0.608,0.729,0.598,0.726}};

		static const double barrel_2016_A_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.022,0.019,0.024,0.016,0.020,0.016},
			{0.009,0.010,0.010,0.006,0.008,0.007},
			{0.011,0.009,0.010,0.008,0.008,0.009},
			{0.009,0.009,0.009,0.008,0.009,0.009},
			{0.009,0.010,0.011,0.009,0.008,0.007},
			{0.023,0.019,0.024,0.017,0.020,0.017}};

		static const double endcap_2016_A_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.415,0.488,0.406,0.353,0.425,0.420,0.447,0.422,0.400,0.447,0.349,0.411},
			{0.921,0.883,0.908,0.910,0.888,0.903,0.905,0.914,0.807,0.928,0.893,0.883},
			{0.951,0.945,0.900,0.951,0.901,0.963,0.955,0.956,0.939,0.943,0.897,0.942},
			{0.964,0.946,0.939,0.944,0.969,0.965,0.960,0.970,0.963,0.891,0.906,0.955},
			{0.879,0.823,0.703,0.868,0.808,0.859,0.832,0.832,0.790,0.823,0.814,0.869},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.861,0.771,0.779,0.848,0.843,0.826,0.846,0.849,0.743,0.904,0.819,0.819},
			{0.959,0.914,0.959,0.950,0.942,0.943,0.961,0.949,0.942,0.959,0.942,0.965},
			{0.953,0.945,0.879,0.943,0.933,0.946,0.949,0.944,0.932,0.907,0.911,0.943},
			{0.922,0.912,0.896,0.927,0.877,0.897,0.920,0.901,0.875,0.908,0.850,0.888},
			{0.447,0.470,0.435,0.510,0.457,0.541,0.359,0.338,0.362,0.409,0.519,0.412}};

		static const double endcap_2016_A_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.047,0.048,0.044,0.044,0.043,0.043,0.042,0.046,0.047,0.047,0.046,0.043},
			{0.010,0.012,0.012,0.011,0.012,0.011,0.012,0.011,0.016,0.011,0.012,0.012},
			{0.007,0.007,0.009,0.007,0.009,0.006,0.007,0.006,0.008,0.008,0.010,0.008},
			{0.010,0.012,0.012,0.012,0.010,0.010,0.010,0.010,0.011,0.017,0.016,0.011},
			{0.024,0.028,0.032,0.024,0.027,0.025,0.027,0.027,0.029,0.028,0.027,0.025},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.025,0.030,0.029,0.026,0.027,0.028,0.025,0.026,0.033,0.022,0.028,0.028},
			{0.010,0.014,0.010,0.011,0.012,0.012,0.010,0.011,0.013,0.011,0.013,0.010},
			{0.007,0.007,0.010,0.007,0.008,0.007,0.007,0.007,0.008,0.010,0.010,0.007},
			{0.010,0.011,0.011,0.010,0.013,0.012,0.010,0.011,0.013,0.011,0.014,0.012},
			{0.047,0.051,0.046,0.044,0.046,0.046,0.043,0.042,0.046,0.047,0.048,0.049}};

		static const double barrel_2016_B_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.627,0.502,0.608,0.775,0.521,0.776},
			{0.859,0.635,0.788,0.912,0.820,0.862},
			{0.760,0.717,0.822,0.765,0.780,0.734},
			{0.822,0.678,0.840,0.792,0.752,0.793},
			{0.837,0.644,0.725,0.727,0.834,0.865},
			{0.611,0.479,0.644,0.733,0.579,0.733}};

		static const double barrel_2016_B_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.005,0.005,0.005,0.004,0.005,0.004},
			{0.002,0.002,0.003,0.001,0.002,0.002},
			{0.003,0.002,0.002,0.002,0.002,0.002},
			{0.002,0.002,0.002,0.002,0.002,0.002},
			{0.002,0.002,0.003,0.002,0.002,0.002},
			{0.005,0.005,0.005,0.004,0.005,0.004}};

		static const double endcap_2016_B_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.430,0.419,0.434,0.379,0.418,0.410,0.428,0.413,0.375,0.420,0.431,0.414},
			{0.919,0.893,0.895,0.805,0.877,0.904,0.920,0.900,0.800,0.924,0.888,0.894},
			{0.947,0.933,0.927,0.836,0.903,0.946,0.953,0.948,0.951,0.942,0.879,0.927},
			{0.956,0.937,0.937,0.834,0.955,0.951,0.955,0.962,0.960,0.949,0.927,0.957},
			{0.894,0.802,0.572,0.777,0.811,0.850,0.823,0.766,0.821,0.832,0.790,0.876},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.881,0.772,0.758,0.809,0.808,0.827,0.892,0.856,0.833,0.913,0.828,0.816},
			{0.954,0.920,0.947,0.945,0.942,0.945,0.960,0.955,0.940,0.950,0.940,0.963},
			{0.953,0.945,0.891,0.946,0.930,0.934,0.952,0.946,0.934,0.911,0.902,0.943},
			{0.915,0.898,0.885,0.919,0.895,0.891,0.924,0.899,0.861,0.904,0.854,0.876},
			{0.440,0.457,0.460,0.467,0.465,0.430,0.460,0.431,0.428,0.446,0.430,0.436}};

		static const double endcap_2016_B_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.011,0.011,0.011,0.010,0.011,0.011,0.011,0.011,0.011,0.011,0.011,0.011},
			{0.002,0.003,0.003,0.004,0.003,0.003,0.002,0.003,0.004,0.003,0.003,0.003},
			{0.002,0.002,0.002,0.003,0.002,0.002,0.002,0.002,0.002,0.002,0.003,0.002},
			{0.002,0.003,0.003,0.004,0.003,0.003,0.002,0.002,0.002,0.003,0.003,0.002},
			{0.005,0.007,0.008,0.007,0.007,0.006,0.006,0.007,0.007,0.007,0.007,0.005},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.005,0.007,0.007,0.007,0.007,0.007,0.005,0.006,0.007,0.005,0.007,0.006},
			{0.003,0.003,0.003,0.003,0.003,0.003,0.002,0.002,0.003,0.003,0.003,0.002},
			{0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002},
			{0.003,0.003,0.003,0.003,0.003,0.003,0.002,0.003,0.003,0.003,0.003,0.003},
			{0.011,0.011,0.011,0.011,0.011,0.011,0.011,0.011,0.011,0.011,0.011,0.011}};

		unc = 0.;
		if(fabs(eta)<1.05) { // barrel
			int ieta = std::upper_bound(bins_eta_barrel,bins_eta_barrel+nbins_eta_barrel+1,eta) - bins_eta_barrel - 1;
			if(ieta<0 || ieta>=nbins_eta_barrel) return 0.;
			int iphi = std::upper_bound(bins_phi_barrel,bins_phi_barrel+nbins_phi_barrel+1,phi) - bins_phi_barrel - 1;
			if(iphi<0) iphi = nbins_phi_barrel-1;
			if(iphi>=nbins_phi_barrel) iphi = 0;
			unc = ::select_period_array(runnumber,barrel_2015_D_err,barrel_2015_E_err,barrel_2015_F_err,barrel_2015_G_err,barrel_2015_H_err,barrel_2015_J_err,barrel_2016_A_err,barrel_2016_B_err)[ieta][iphi];
			return ::select_period_array(runnumber,barrel_2015_D_val,barrel_2015_E_val,barrel_2015_F_val,barrel_2015_G_val,barrel_2015_H_val,barrel_2015_J_val,barrel_2016_A_val,barrel_2016_B_val)[ieta][iphi];
		} else { // endcap
			int ieta = std::upper_bound(bins_eta_endcap,bins_eta_endcap+nbins_eta_endcap+1,eta) - bins_eta_endcap - 1;
			if(ieta<0 || ieta>=nbins_eta_endcap) return 0.;
			int iphi = std::upper_bound(bins_phi_endcap,bins_phi_endcap+nbins_phi_endcap+1,phi) - bins_phi_endcap - 1;
			if(iphi<0) iphi = nbins_phi_endcap-1;
			if(iphi>=nbins_phi_endcap) iphi = 0;
			unc = ::select_period_array(runnumber,endcap_2015_D_err,endcap_2015_E_err,endcap_2015_F_err,endcap_2015_G_err,endcap_2015_H_err,endcap_2015_J_err,endcap_2016_A_err,endcap_2016_B_err)[ieta][iphi];
			return ::select_period_array(runnumber,endcap_2015_D_val,endcap_2015_E_val,endcap_2015_F_val,endcap_2015_G_val,endcap_2015_H_val,endcap_2015_J_val,endcap_2016_A_val,endcap_2016_B_val)[ieta][iphi];
		}
	}
	double efficiency_mc_eXmuY_muon(double eta, double phi, double& unc,int runnumber)
	{
		static const double bins_eta_barrel[] = {-1.05,-0.91,-0.48,0.00,0.48,0.91,1.05};
		const int nbins_eta_barrel = sizeof(bins_eta_barrel)/sizeof(*bins_eta_barrel)-1;
		static const double bins_eta_endcap[] = {-2.50,-2.40,-1.92,-1.35,-1.15,-1.05,1.05,1.15,1.35,1.92,2.40,2.50};
		const int nbins_eta_endcap = sizeof(bins_eta_endcap)/sizeof(*bins_eta_endcap)-1;
		static const double bins_phi_barrel[] = {-2.95,-2.16,-0.98,-0.20,0.98,2.16,3.34};
		const int nbins_phi_barrel = sizeof(bins_phi_barrel)/sizeof(*bins_phi_barrel)-1;
		static const double bins_phi_endcap[] = {-3.40,-2.88,-2.36,-1.83,-1.31,-0.79,-0.26,0.26,0.79,1.31,1.83,2.36,2.88};
		const int nbins_phi_endcap = sizeof(bins_phi_endcap)/sizeof(*bins_phi_endcap)-1;
		static const double barrel_2015_D_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.624,0.534,0.672,0.718,0.566,0.732},
			{0.892,0.735,0.841,0.887,0.858,0.869},
			{0.816,0.745,0.867,0.835,0.810,0.837},
			{0.860,0.736,0.870,0.859,0.823,0.791},
			{0.878,0.693,0.867,0.814,0.876,0.871},
			{0.684,0.521,0.676,0.713,0.611,0.683}};

		static const double barrel_2015_D_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.016,0.013,0.016,0.013,0.014,0.013},
			{0.008,0.008,0.009,0.008,0.008,0.008},
			{0.009,0.008,0.009,0.008,0.008,0.008},
			{0.009,0.008,0.009,0.008,0.008,0.008},
			{0.009,0.008,0.009,0.008,0.008,0.008},
			{0.016,0.014,0.016,0.013,0.014,0.013}};

		static const double endcap_2015_D_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.404,0.405,0.452,0.421,0.367,0.512,0.410,0.443,0.403,0.501,0.464,0.391},
			{0.918,0.907,0.891,0.926,0.887,0.899,0.911,0.879,0.842,0.917,0.896,0.881},
			{0.943,0.940,0.918,0.948,0.932,0.938,0.936,0.938,0.942,0.944,0.941,0.928},
			{0.968,0.949,0.948,0.965,0.939,0.959,0.949,0.943,0.944,0.952,0.947,0.956},
			{0.883,0.850,0.850,0.907,0.835,0.840,0.898,0.855,0.857,0.898,0.806,0.855},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.836,0.828,0.867,0.917,0.836,0.815,0.859,0.856,0.834,0.892,0.833,0.852},
			{0.942,0.929,0.938,0.953,0.955,0.942,0.951,0.953,0.953,0.929,0.958,0.949},
			{0.930,0.919,0.937,0.927,0.919,0.920,0.944,0.925,0.932,0.925,0.920,0.935},
			{0.901,0.910,0.906,0.917,0.897,0.894,0.931,0.908,0.897,0.913,0.900,0.892},
			{0.466,0.404,0.469,0.394,0.445,0.423,0.462,0.503,0.472,0.372,0.423,0.475}};

		static const double endcap_2015_D_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.030,0.030,0.033,0.032,0.032,0.032,0.031,0.032,0.032,0.033,0.032,0.032},
			{0.009,0.009,0.010,0.009,0.010,0.010,0.009,0.010,0.011,0.009,0.010,0.010},
			{0.007,0.007,0.008,0.007,0.008,0.008,0.008,0.007,0.007,0.007,0.008,0.008},
			{0.008,0.009,0.009,0.008,0.010,0.009,0.009,0.010,0.010,0.009,0.010,0.009},
			{0.016,0.018,0.018,0.016,0.019,0.019,0.015,0.018,0.018,0.015,0.020,0.018},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.019,0.020,0.016,0.015,0.019,0.020,0.018,0.018,0.020,0.016,0.019,0.019},
			{0.010,0.010,0.010,0.009,0.009,0.010,0.009,0.009,0.009,0.011,0.009,0.009},
			{0.008,0.008,0.008,0.008,0.008,0.008,0.007,0.008,0.008,0.008,0.008,0.007},
			{0.009,0.009,0.009,0.009,0.009,0.010,0.009,0.009,0.009,0.009,0.010,0.010},
			{0.031,0.033,0.032,0.032,0.033,0.030,0.033,0.032,0.033,0.031,0.032,0.031}};

		static const double barrel_2015_E_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.624,0.534,0.672,0.718,0.566,0.732},
			{0.892,0.735,0.841,0.887,0.858,0.869},
			{0.816,0.745,0.867,0.835,0.810,0.837},
			{0.860,0.736,0.870,0.859,0.823,0.791},
			{0.878,0.693,0.867,0.814,0.876,0.871},
			{0.684,0.521,0.676,0.713,0.611,0.683}};

		static const double barrel_2015_E_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.016,0.013,0.016,0.012,0.014,0.012},
			{0.007,0.007,0.007,0.006,0.006,0.006},
			{0.008,0.007,0.007,0.006,0.007,0.006},
			{0.007,0.007,0.007,0.006,0.006,0.007},
			{0.007,0.007,0.007,0.007,0.006,0.006},
			{0.015,0.013,0.016,0.013,0.014,0.013}};

		static const double endcap_2015_E_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.404,0.405,0.452,0.421,0.367,0.512,0.410,0.443,0.403,0.501,0.464,0.391},
			{0.918,0.907,0.891,0.926,0.887,0.899,0.911,0.879,0.842,0.917,0.896,0.881},
			{0.943,0.940,0.918,0.948,0.932,0.938,0.936,0.938,0.942,0.944,0.941,0.928},
			{0.968,0.949,0.948,0.965,0.939,0.959,0.949,0.943,0.944,0.952,0.947,0.956},
			{0.883,0.850,0.850,0.907,0.835,0.840,0.898,0.855,0.857,0.898,0.806,0.855},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.836,0.828,0.867,0.917,0.836,0.815,0.859,0.856,0.834,0.892,0.833,0.852},
			{0.942,0.929,0.938,0.953,0.955,0.942,0.951,0.953,0.953,0.929,0.958,0.949},
			{0.930,0.919,0.937,0.927,0.919,0.920,0.944,0.925,0.932,0.925,0.920,0.935},
			{0.901,0.910,0.906,0.917,0.897,0.894,0.931,0.908,0.897,0.913,0.900,0.892},
			{0.466,0.404,0.469,0.394,0.445,0.423,0.462,0.503,0.472,0.372,0.423,0.475}};

		static const double endcap_2015_E_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.029,0.030,0.033,0.032,0.032,0.032,0.031,0.031,0.032,0.033,0.032,0.032},
			{0.008,0.009,0.009,0.008,0.009,0.009,0.008,0.009,0.010,0.009,0.009,0.010},
			{0.006,0.006,0.007,0.006,0.007,0.006,0.007,0.006,0.006,0.006,0.006,0.007},
			{0.007,0.008,0.008,0.007,0.009,0.008,0.009,0.009,0.009,0.009,0.009,0.008},
			{0.015,0.018,0.018,0.015,0.019,0.018,0.015,0.017,0.018,0.015,0.020,0.017},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.019,0.019,0.015,0.014,0.019,0.020,0.018,0.017,0.019,0.015,0.019,0.018},
			{0.009,0.010,0.009,0.008,0.008,0.009,0.009,0.008,0.009,0.010,0.009,0.009},
			{0.007,0.007,0.006,0.007,0.007,0.007,0.006,0.007,0.007,0.007,0.007,0.006},
			{0.009,0.008,0.008,0.008,0.009,0.009,0.008,0.008,0.009,0.009,0.009,0.009},
			{0.031,0.033,0.032,0.032,0.033,0.030,0.033,0.032,0.033,0.031,0.032,0.031}};

		static const double barrel_2015_F_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.624,0.534,0.672,0.718,0.566,0.732},
			{0.892,0.735,0.841,0.887,0.858,0.869},
			{0.816,0.745,0.867,0.835,0.810,0.837},
			{0.860,0.736,0.870,0.859,0.823,0.791},
			{0.878,0.693,0.867,0.814,0.876,0.871},
			{0.684,0.521,0.676,0.713,0.611,0.683}};

		static const double barrel_2015_F_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.016,0.013,0.016,0.013,0.014,0.013},
			{0.007,0.007,0.008,0.006,0.007,0.007},
			{0.008,0.007,0.007,0.007,0.007,0.007},
			{0.007,0.007,0.007,0.006,0.007,0.007},
			{0.007,0.008,0.008,0.007,0.007,0.007},
			{0.015,0.014,0.016,0.013,0.014,0.013}};

		static const double endcap_2015_F_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.404,0.405,0.452,0.421,0.367,0.512,0.410,0.443,0.403,0.501,0.464,0.391},
			{0.918,0.907,0.891,0.926,0.887,0.899,0.911,0.879,0.842,0.917,0.896,0.881},
			{0.943,0.940,0.918,0.948,0.932,0.938,0.936,0.938,0.942,0.944,0.941,0.928},
			{0.968,0.949,0.948,0.965,0.939,0.959,0.949,0.943,0.944,0.952,0.947,0.956},
			{0.883,0.850,0.850,0.907,0.835,0.840,0.898,0.855,0.857,0.898,0.806,0.855},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.836,0.828,0.867,0.917,0.836,0.815,0.859,0.856,0.834,0.892,0.833,0.852},
			{0.942,0.929,0.938,0.953,0.955,0.942,0.951,0.953,0.953,0.929,0.958,0.949},
			{0.930,0.919,0.937,0.927,0.919,0.920,0.944,0.925,0.932,0.925,0.920,0.935},
			{0.901,0.910,0.906,0.917,0.897,0.894,0.931,0.908,0.897,0.913,0.900,0.892},
			{0.466,0.404,0.469,0.394,0.445,0.423,0.462,0.503,0.472,0.372,0.423,0.475}};

		static const double endcap_2015_F_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.029,0.030,0.033,0.032,0.032,0.032,0.031,0.031,0.032,0.033,0.032,0.032},
			{0.008,0.008,0.009,0.007,0.009,0.009,0.008,0.009,0.010,0.008,0.009,0.009},
			{0.006,0.006,0.007,0.005,0.006,0.006,0.006,0.006,0.006,0.006,0.006,0.006},
			{0.006,0.008,0.008,0.007,0.009,0.008,0.008,0.008,0.009,0.008,0.009,0.007},
			{0.015,0.017,0.017,0.015,0.018,0.018,0.015,0.017,0.018,0.015,0.020,0.017},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.018,0.019,0.015,0.014,0.018,0.019,0.018,0.017,0.019,0.015,0.019,0.018},
			{0.009,0.009,0.008,0.008,0.008,0.009,0.008,0.007,0.008,0.010,0.008,0.008},
			{0.006,0.007,0.006,0.006,0.007,0.006,0.006,0.006,0.006,0.007,0.007,0.006},
			{0.008,0.008,0.008,0.008,0.008,0.009,0.007,0.008,0.008,0.008,0.009,0.009},
			{0.031,0.033,0.032,0.032,0.033,0.030,0.033,0.032,0.033,0.031,0.032,0.031}};

		static const double barrel_2015_G_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.624,0.534,0.672,0.718,0.566,0.732},
			{0.892,0.735,0.841,0.887,0.858,0.869},
			{0.816,0.745,0.867,0.835,0.810,0.837},
			{0.860,0.736,0.870,0.859,0.823,0.791},
			{0.878,0.693,0.867,0.814,0.876,0.871},
			{0.684,0.521,0.676,0.713,0.611,0.683}};

		static const double barrel_2015_G_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.016,0.013,0.016,0.012,0.014,0.012},
			{0.006,0.007,0.007,0.005,0.006,0.005},
			{0.007,0.006,0.007,0.006,0.006,0.006},
			{0.007,0.007,0.006,0.005,0.006,0.006},
			{0.006,0.007,0.007,0.006,0.006,0.006},
			{0.015,0.013,0.016,0.012,0.014,0.013}};

		static const double endcap_2015_G_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.404,0.405,0.452,0.421,0.367,0.512,0.410,0.443,0.403,0.501,0.464,0.391},
			{0.918,0.907,0.891,0.926,0.887,0.899,0.911,0.879,0.842,0.917,0.896,0.881},
			{0.943,0.940,0.918,0.948,0.932,0.938,0.936,0.938,0.942,0.944,0.941,0.928},
			{0.968,0.949,0.948,0.965,0.939,0.959,0.949,0.943,0.944,0.952,0.947,0.956},
			{0.883,0.850,0.850,0.907,0.835,0.840,0.898,0.855,0.857,0.898,0.806,0.855},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.836,0.828,0.867,0.917,0.836,0.815,0.859,0.856,0.834,0.892,0.833,0.852},
			{0.942,0.929,0.938,0.953,0.955,0.942,0.951,0.953,0.953,0.929,0.958,0.949},
			{0.930,0.919,0.937,0.927,0.919,0.920,0.944,0.925,0.932,0.925,0.920,0.935},
			{0.901,0.910,0.906,0.917,0.897,0.894,0.931,0.908,0.897,0.913,0.900,0.892},
			{0.466,0.404,0.469,0.394,0.445,0.423,0.462,0.503,0.472,0.372,0.423,0.475}};

		static const double endcap_2015_G_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.029,0.030,0.033,0.032,0.032,0.032,0.031,0.031,0.032,0.033,0.032,0.032},
			{0.008,0.008,0.009,0.007,0.009,0.009,0.008,0.009,0.010,0.008,0.009,0.009},
			{0.005,0.006,0.006,0.005,0.006,0.006,0.006,0.006,0.006,0.006,0.006,0.006},
			{0.006,0.008,0.008,0.007,0.009,0.008,0.008,0.008,0.009,0.008,0.009,0.007},
			{0.015,0.017,0.017,0.015,0.018,0.018,0.015,0.017,0.018,0.015,0.020,0.017},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.018,0.019,0.015,0.014,0.018,0.019,0.018,0.017,0.019,0.015,0.019,0.018},
			{0.009,0.009,0.008,0.008,0.008,0.009,0.008,0.007,0.008,0.010,0.008,0.008},
			{0.006,0.006,0.006,0.006,0.007,0.006,0.006,0.006,0.006,0.006,0.007,0.006},
			{0.008,0.008,0.008,0.008,0.008,0.009,0.007,0.008,0.008,0.008,0.009,0.009},
			{0.031,0.033,0.032,0.032,0.033,0.030,0.033,0.032,0.033,0.031,0.032,0.031}};

		static const double barrel_2015_H_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.624,0.534,0.672,0.718,0.566,0.732},
			{0.892,0.735,0.841,0.887,0.858,0.869},
			{0.816,0.745,0.867,0.835,0.810,0.837},
			{0.860,0.736,0.870,0.859,0.823,0.791},
			{0.878,0.693,0.867,0.814,0.876,0.871},
			{0.684,0.521,0.676,0.713,0.611,0.683}};

		static const double barrel_2015_H_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.016,0.013,0.016,0.013,0.014,0.013},
			{0.007,0.007,0.008,0.006,0.007,0.006},
			{0.008,0.007,0.007,0.007,0.007,0.007},
			{0.007,0.007,0.007,0.006,0.007,0.007},
			{0.007,0.008,0.008,0.007,0.007,0.007},
			{0.015,0.014,0.016,0.013,0.014,0.013}};

		static const double endcap_2015_H_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.404,0.405,0.452,0.421,0.367,0.512,0.410,0.443,0.403,0.501,0.464,0.391},
			{0.918,0.907,0.891,0.926,0.887,0.899,0.911,0.879,0.842,0.917,0.896,0.881},
			{0.943,0.940,0.918,0.948,0.932,0.938,0.936,0.938,0.942,0.944,0.941,0.928},
			{0.968,0.949,0.948,0.965,0.939,0.959,0.949,0.943,0.944,0.952,0.947,0.956},
			{0.883,0.850,0.850,0.907,0.835,0.840,0.898,0.855,0.857,0.898,0.806,0.855},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.836,0.828,0.867,0.917,0.836,0.815,0.859,0.856,0.834,0.892,0.833,0.852},
			{0.942,0.929,0.938,0.953,0.955,0.942,0.951,0.953,0.953,0.929,0.958,0.949},
			{0.930,0.919,0.937,0.927,0.919,0.920,0.944,0.925,0.932,0.925,0.920,0.935},
			{0.901,0.910,0.906,0.917,0.897,0.894,0.931,0.908,0.897,0.913,0.900,0.892},
			{0.466,0.404,0.469,0.394,0.445,0.423,0.462,0.503,0.472,0.372,0.423,0.475}};

		static const double endcap_2015_H_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.029,0.030,0.033,0.032,0.032,0.032,0.031,0.031,0.032,0.033,0.032,0.032},
			{0.008,0.008,0.009,0.008,0.009,0.009,0.008,0.009,0.010,0.008,0.009,0.010},
			{0.006,0.006,0.007,0.006,0.007,0.006,0.006,0.006,0.006,0.006,0.006,0.007},
			{0.007,0.008,0.008,0.007,0.009,0.008,0.008,0.009,0.009,0.009,0.009,0.008},
			{0.015,0.018,0.018,0.015,0.019,0.018,0.015,0.017,0.018,0.015,0.020,0.017},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.019,0.019,0.015,0.014,0.019,0.020,0.018,0.017,0.019,0.015,0.019,0.018},
			{0.009,0.010,0.009,0.008,0.008,0.009,0.008,0.008,0.009,0.010,0.009,0.008},
			{0.007,0.007,0.006,0.007,0.007,0.007,0.006,0.007,0.007,0.007,0.007,0.006},
			{0.009,0.008,0.008,0.008,0.009,0.009,0.008,0.008,0.009,0.009,0.009,0.009},
			{0.031,0.033,0.032,0.032,0.033,0.030,0.033,0.032,0.033,0.031,0.032,0.031}};

		static const double barrel_2015_J_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.624,0.534,0.672,0.718,0.566,0.732},
			{0.892,0.735,0.841,0.887,0.858,0.869},
			{0.816,0.745,0.867,0.835,0.810,0.837},
			{0.860,0.736,0.870,0.859,0.823,0.791},
			{0.878,0.693,0.867,0.814,0.876,0.871},
			{0.684,0.521,0.676,0.713,0.611,0.683}};

		static const double barrel_2015_J_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.016,0.013,0.016,0.012,0.014,0.012},
			{0.006,0.007,0.007,0.005,0.005,0.005},
			{0.007,0.006,0.006,0.006,0.006,0.006},
			{0.006,0.006,0.006,0.005,0.006,0.006},
			{0.006,0.007,0.006,0.006,0.005,0.005},
			{0.015,0.013,0.016,0.012,0.013,0.013}};

		static const double endcap_2015_J_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.404,0.405,0.452,0.421,0.367,0.512,0.410,0.443,0.403,0.501,0.464,0.391},
			{0.918,0.907,0.891,0.926,0.887,0.899,0.911,0.879,0.842,0.917,0.896,0.881},
			{0.943,0.940,0.918,0.948,0.932,0.938,0.936,0.938,0.942,0.944,0.941,0.928},
			{0.968,0.949,0.948,0.965,0.939,0.959,0.949,0.943,0.944,0.952,0.947,0.956},
			{0.883,0.850,0.850,0.907,0.835,0.840,0.898,0.855,0.857,0.898,0.806,0.855},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.836,0.828,0.867,0.917,0.836,0.815,0.859,0.856,0.834,0.892,0.833,0.852},
			{0.942,0.929,0.938,0.953,0.955,0.942,0.951,0.953,0.953,0.929,0.958,0.949},
			{0.930,0.919,0.937,0.927,0.919,0.920,0.944,0.925,0.932,0.925,0.920,0.935},
			{0.901,0.910,0.906,0.917,0.897,0.894,0.931,0.908,0.897,0.913,0.900,0.892},
			{0.466,0.404,0.469,0.394,0.445,0.423,0.462,0.503,0.472,0.372,0.423,0.475}};

		static const double endcap_2015_J_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.029,0.030,0.033,0.032,0.032,0.032,0.031,0.031,0.032,0.033,0.032,0.032},
			{0.008,0.008,0.009,0.007,0.009,0.009,0.008,0.009,0.010,0.008,0.009,0.009},
			{0.006,0.006,0.007,0.005,0.006,0.006,0.006,0.006,0.006,0.006,0.006,0.006},
			{0.006,0.008,0.008,0.007,0.009,0.008,0.008,0.008,0.009,0.008,0.009,0.007},
			{0.015,0.017,0.017,0.015,0.018,0.018,0.015,0.017,0.018,0.015,0.020,0.017},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.018,0.019,0.015,0.014,0.018,0.019,0.018,0.017,0.019,0.015,0.019,0.018},
			{0.009,0.009,0.008,0.008,0.008,0.009,0.008,0.007,0.008,0.010,0.008,0.008},
			{0.006,0.007,0.006,0.006,0.007,0.006,0.006,0.006,0.006,0.007,0.007,0.006},
			{0.008,0.008,0.008,0.008,0.008,0.009,0.007,0.008,0.008,0.008,0.009,0.009},
			{0.031,0.033,0.032,0.032,0.033,0.030,0.033,0.032,0.033,0.031,0.032,0.031}};

		static const double barrel_2016_A_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.622,0.537,0.686,0.703,0.551,0.722},
			{0.883,0.723,0.841,0.887,0.850,0.878},
			{0.805,0.750,0.868,0.833,0.802,0.837},
			{0.865,0.745,0.866,0.861,0.828,0.800},
			{0.878,0.690,0.853,0.810,0.877,0.862},
			{0.656,0.537,0.634,0.717,0.600,0.717}};

		static const double barrel_2016_A_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.017,0.015,0.018,0.016,0.015,0.016},
			{0.017,0.014,0.016,0.016,0.016,0.016},
			{0.015,0.014,0.016,0.016,0.015,0.016},
			{0.016,0.014,0.016,0.016,0.015,0.015},
			{0.016,0.014,0.016,0.015,0.016,0.016},
			{0.017,0.014,0.017,0.016,0.015,0.016}};

		static const double endcap_2016_A_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.440,0.424,0.436,0.413,0.441,0.509,0.497,0.412,0.448,0.397,0.409,0.455},
			{0.917,0.893,0.890,0.925,0.882,0.895,0.914,0.894,0.831,0.924,0.896,0.899},
			{0.942,0.941,0.935,0.939,0.925,0.934,0.944,0.940,0.941,0.944,0.933,0.935},
			{0.946,0.952,0.944,0.944,0.949,0.944,0.946,0.962,0.947,0.951,0.956,0.944},
			{0.886,0.823,0.851,0.887,0.848,0.839,0.903,0.823,0.833,0.851,0.838,0.860},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.832,0.834,0.831,0.870,0.820,0.838,0.860,0.845,0.852,0.856,0.834,0.837},
			{0.942,0.927,0.934,0.936,0.952,0.955,0.948,0.946,0.945,0.948,0.951,0.936},
			{0.936,0.933,0.932,0.939,0.913,0.925,0.940,0.928,0.933,0.929,0.934,0.932},
			{0.916,0.892,0.888,0.917,0.886,0.900,0.928,0.903,0.902,0.923,0.912,0.898},
			{0.472,0.424,0.428,0.414,0.471,0.458,0.460,0.459,0.427,0.442,0.489,0.424}};

		static const double endcap_2016_A_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.026,0.027,0.026,0.025,0.025,0.026,0.026,0.026,0.025,0.026,0.025,0.028},
			{0.008,0.008,0.008,0.007,0.009,0.008,0.008,0.008,0.009,0.008,0.008,0.008},
			{0.006,0.006,0.007,0.006,0.007,0.007,0.006,0.006,0.006,0.006,0.007,0.007},
			{0.008,0.008,0.008,0.008,0.008,0.008,0.008,0.007,0.008,0.008,0.008,0.008},
			{0.014,0.015,0.016,0.014,0.015,0.016,0.012,0.016,0.015,0.015,0.016,0.015},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.016,0.015,0.015,0.014,0.017,0.016,0.015,0.015,0.015,0.016,0.016,0.015},
			{0.008,0.009,0.008,0.008,0.008,0.007,0.008,0.008,0.008,0.008,0.008,0.009},
			{0.006,0.007,0.007,0.006,0.007,0.007,0.006,0.007,0.007,0.007,0.007,0.007},
			{0.008,0.008,0.008,0.008,0.008,0.008,0.007,0.008,0.008,0.008,0.008,0.008},
			{0.026,0.026,0.027,0.026,0.026,0.026,0.026,0.026,0.027,0.025,0.029,0.027}};

		static const double barrel_2016_B_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.622,0.537,0.686,0.703,0.551,0.722},
			{0.883,0.723,0.841,0.887,0.850,0.878},
			{0.805,0.750,0.868,0.833,0.802,0.837},
			{0.865,0.745,0.866,0.861,0.828,0.800},
			{0.878,0.690,0.853,0.810,0.877,0.862},
			{0.656,0.537,0.634,0.717,0.600,0.717}};

		static const double barrel_2016_B_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.014,0.012,0.014,0.012,0.012,0.012},
			{0.009,0.008,0.009,0.009,0.009,0.009},
			{0.009,0.008,0.009,0.009,0.009,0.009},
			{0.009,0.008,0.009,0.009,0.009,0.009},
			{0.009,0.008,0.009,0.009,0.009,0.009},
			{0.014,0.012,0.014,0.012,0.012,0.012}};

		static const double endcap_2016_B_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.440,0.424,0.436,0.413,0.441,0.509,0.497,0.412,0.448,0.397,0.409,0.455},
			{0.917,0.893,0.890,0.925,0.882,0.895,0.914,0.894,0.831,0.924,0.896,0.899},
			{0.942,0.941,0.935,0.939,0.925,0.934,0.944,0.940,0.941,0.944,0.933,0.935},
			{0.946,0.952,0.944,0.944,0.949,0.944,0.946,0.962,0.947,0.951,0.956,0.944},
			{0.886,0.823,0.851,0.887,0.848,0.839,0.903,0.823,0.833,0.851,0.838,0.860},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.832,0.834,0.831,0.870,0.820,0.838,0.860,0.845,0.852,0.856,0.834,0.837},
			{0.942,0.927,0.934,0.936,0.952,0.955,0.948,0.946,0.945,0.948,0.951,0.936},
			{0.936,0.933,0.932,0.939,0.913,0.925,0.940,0.928,0.933,0.929,0.934,0.932},
			{0.916,0.892,0.888,0.917,0.886,0.900,0.928,0.903,0.902,0.923,0.912,0.898},
			{0.472,0.424,0.428,0.414,0.471,0.458,0.460,0.459,0.427,0.442,0.489,0.424}};

		static const double endcap_2016_B_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.026,0.027,0.025,0.025,0.025,0.026,0.026,0.026,0.025,0.026,0.025,0.028},
			{0.006,0.007,0.007,0.006,0.008,0.007,0.006,0.007,0.009,0.006,0.007,0.007},
			{0.005,0.005,0.005,0.005,0.005,0.005,0.005,0.005,0.005,0.005,0.005,0.005},
			{0.007,0.006,0.007,0.007,0.007,0.007,0.007,0.006,0.007,0.007,0.006,0.007},
			{0.013,0.015,0.015,0.013,0.014,0.016,0.012,0.016,0.015,0.015,0.015,0.014},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.015,0.015,0.015,0.014,0.016,0.015,0.014,0.014,0.015,0.015,0.015,0.015},
			{0.007,0.008,0.007,0.007,0.006,0.006,0.007,0.007,0.007,0.007,0.007,0.007},
			{0.005,0.005,0.005,0.005,0.005,0.005,0.005,0.005,0.005,0.005,0.005,0.005},
			{0.007,0.007,0.007,0.006,0.007,0.007,0.006,0.007,0.007,0.006,0.007,0.007},
			{0.026,0.026,0.027,0.026,0.026,0.026,0.026,0.026,0.027,0.025,0.029,0.027}};

		unc = 0.;
		if(fabs(eta)<1.05) { // barrel
			int ieta = std::upper_bound(bins_eta_barrel,bins_eta_barrel+nbins_eta_barrel+1,eta) - bins_eta_barrel - 1;
			if(ieta<0 || ieta>=nbins_eta_barrel) return 0.;
			int iphi = std::upper_bound(bins_phi_barrel,bins_phi_barrel+nbins_phi_barrel+1,phi) - bins_phi_barrel - 1;
			if(iphi<0) iphi = nbins_phi_barrel-1;
			if(iphi>=nbins_phi_barrel) iphi = 0;
			unc = ::select_period_array(runnumber,barrel_2015_D_err,barrel_2015_E_err,barrel_2015_F_err,barrel_2015_G_err,barrel_2015_H_err,barrel_2015_J_err,barrel_2016_A_err,barrel_2016_B_err)[ieta][iphi];
			return ::select_period_array(runnumber,barrel_2015_D_val,barrel_2015_E_val,barrel_2015_F_val,barrel_2015_G_val,barrel_2015_H_val,barrel_2015_J_val,barrel_2016_A_val,barrel_2016_B_val)[ieta][iphi];
		} else { // endcap
			int ieta = std::upper_bound(bins_eta_endcap,bins_eta_endcap+nbins_eta_endcap+1,eta) - bins_eta_endcap - 1;
			if(ieta<0 || ieta>=nbins_eta_endcap) return 0.;
			int iphi = std::upper_bound(bins_phi_endcap,bins_phi_endcap+nbins_phi_endcap+1,phi) - bins_phi_endcap - 1;
			if(iphi<0) iphi = nbins_phi_endcap-1;
			if(iphi>=nbins_phi_endcap) iphi = 0;
			unc = ::select_period_array(runnumber,endcap_2015_D_err,endcap_2015_E_err,endcap_2015_F_err,endcap_2015_G_err,endcap_2015_H_err,endcap_2015_J_err,endcap_2016_A_err,endcap_2016_B_err)[ieta][iphi];
			return ::select_period_array(runnumber,endcap_2015_D_val,endcap_2015_E_val,endcap_2015_F_val,endcap_2015_G_val,endcap_2015_H_val,endcap_2015_J_val,endcap_2016_A_val,endcap_2016_B_val)[ieta][iphi];
		}
	}
	double efficiency_data_muXmuY_leadmuon(double eta, double phi, double& unc,int runnumber)
	{
		static const double bins_eta_barrel[] = {-1.05,-0.91,-0.48,0.00,0.48,0.91,1.05};
		const int nbins_eta_barrel = sizeof(bins_eta_barrel)/sizeof(*bins_eta_barrel)-1;
		static const double bins_eta_endcap[] = {-2.50,-2.40,-1.92,-1.35,-1.15,-1.05,1.05,1.15,1.35,1.92,2.40,2.50};
		const int nbins_eta_endcap = sizeof(bins_eta_endcap)/sizeof(*bins_eta_endcap)-1;
		static const double bins_phi_barrel[] = {-2.95,-2.16,-0.98,-0.20,0.98,2.16,3.34};
		const int nbins_phi_barrel = sizeof(bins_phi_barrel)/sizeof(*bins_phi_barrel)-1;
		static const double bins_phi_endcap[] = {-3.40,-2.88,-2.36,-1.83,-1.31,-0.79,-0.26,0.26,0.79,1.31,1.83,2.36,2.88};
		const int nbins_phi_endcap = sizeof(bins_phi_endcap)/sizeof(*bins_phi_endcap)-1;
		static const double barrel_2015_D_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.495,0.303,0.524,0.668,0.390,0.707},
			{0.850,0.269,0.719,0.860,0.799,0.765},
			{0.675,0.448,0.795,0.727,0.631,0.719},
			{0.737,0.483,0.776,0.685,0.709,0.690},
			{0.789,0.294,0.704,0.665,0.791,0.873},
			{0.609,0.127,0.594,0.651,0.493,0.554}};

		static const double barrel_2015_D_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.036,0.027,0.035,0.029,0.030,0.027},
			{0.014,0.014,0.017,0.011,0.013,0.013},
			{0.017,0.014,0.015,0.013,0.016,0.014},
			{0.017,0.015,0.016,0.014,0.015,0.015},
			{0.016,0.014,0.017,0.015,0.014,0.011},
			{0.033,0.020,0.034,0.027,0.032,0.029}};

		static const double endcap_2015_D_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.352,0.317,0.553,0.377,0.400,0.393,0.407,0.309,0.464,0.441,0.383,0.415},
			{0.931,0.867,0.899,0.899,0.866,0.872,0.916,0.884,0.820,0.937,0.864,0.889},
			{0.920,0.893,0.843,0.952,0.865,0.912,0.961,0.940,0.891,0.929,0.907,0.908},
			{0.943,0.945,0.939,0.914,0.934,0.924,0.950,0.937,0.960,0.830,0.926,0.968},
			{0.813,0.802,0.703,0.868,0.758,0.753,0.736,0.788,0.757,0.782,0.798,0.804},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.654,0.792,0.714,0.679,0.655,0.788,0.815,0.795,0.675,0.837,0.820,0.891},
			{0.897,0.867,0.925,0.961,0.795,0.890,0.933,0.936,0.959,0.935,0.920,0.948},
			{0.930,0.898,0.854,0.935,0.916,0.860,0.919,0.932,0.910,0.860,0.856,0.879},
			{0.857,0.887,0.889,0.911,0.852,0.891,0.869,0.860,0.760,0.910,0.780,0.866},
			{0.472,0.426,0.528,0.450,0.500,0.500,0.417,0.407,0.403,0.451,0.382,0.443}};

		static const double endcap_2015_D_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.074,0.068,0.082,0.075,0.074,0.073,0.072,0.071,0.075,0.067,0.070,0.068},
			{0.015,0.019,0.018,0.018,0.020,0.020,0.016,0.019,0.025,0.015,0.022,0.019},
			{0.013,0.016,0.017,0.011,0.016,0.014,0.010,0.012,0.016,0.014,0.015,0.014},
			{0.019,0.020,0.021,0.023,0.019,0.023,0.018,0.020,0.018,0.032,0.023,0.016},
			{0.046,0.044,0.053,0.038,0.049,0.049,0.051,0.045,0.047,0.053,0.048,0.044},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.050,0.045,0.050,0.059,0.057,0.045,0.049,0.050,0.059,0.042,0.046,0.038},
			{0.024,0.027,0.023,0.017,0.034,0.028,0.020,0.022,0.020,0.023,0.024,0.018},
			{0.013,0.015,0.017,0.013,0.014,0.017,0.013,0.013,0.015,0.018,0.019,0.016},
			{0.022,0.020,0.019,0.017,0.021,0.019,0.021,0.020,0.027,0.019,0.026,0.020},
			{0.077,0.076,0.077,0.090,0.071,0.075,0.081,0.075,0.070,0.079,0.074,0.071}};

		static const double barrel_2015_E_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.465,0.285,0.496,0.627,0.319,0.733},
			{0.772,0.275,0.758,0.782,0.790,0.784},
			{0.743,0.457,0.789,0.714,0.697,0.732},
			{0.741,0.430,0.786,0.741,0.693,0.708},
			{0.798,0.283,0.680,0.676,0.801,0.835},
			{0.596,0.357,0.637,0.623,0.547,0.674}};

		static const double barrel_2015_E_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.012,0.009,0.012,0.009,0.010,0.009},
			{0.005,0.005,0.006,0.004,0.005,0.004},
			{0.005,0.005,0.005,0.005,0.005,0.005},
			{0.006,0.005,0.005,0.004,0.005,0.005},
			{0.005,0.005,0.006,0.005,0.005,0.004},
			{0.012,0.009,0.011,0.009,0.010,0.009}};

		static const double endcap_2015_E_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.400,0.416,0.380,0.388,0.442,0.408,0.400,0.372,0.387,0.432,0.429,0.436},
			{0.908,0.874,0.881,0.891,0.871,0.886,0.893,0.877,0.806,0.910,0.871,0.900},
			{0.902,0.877,0.829,0.912,0.866,0.863,0.905,0.890,0.859,0.913,0.860,0.896},
			{0.938,0.933,0.929,0.926,0.959,0.953,0.953,0.958,0.958,0.768,0.920,0.949},
			{0.782,0.801,0.646,0.820,0.751,0.795,0.735,0.785,0.784,0.752,0.813,0.862},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.679,0.751,0.761,0.769,0.716,0.782,0.763,0.738,0.711,0.840,0.847,0.806},
			{0.940,0.925,0.936,0.948,0.802,0.935,0.941,0.950,0.932,0.934,0.941,0.956},
			{0.918,0.892,0.858,0.886,0.877,0.872,0.899,0.889,0.840,0.843,0.854,0.878},
			{0.901,0.888,0.867,0.897,0.869,0.877,0.912,0.886,0.793,0.903,0.855,0.858},
			{0.458,0.467,0.479,0.452,0.461,0.480,0.442,0.447,0.428,0.462,0.402,0.443}};

		static const double endcap_2015_E_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.023,0.023,0.024,0.024,0.025,0.023,0.022,0.023,0.024,0.025,0.024,0.023},
			{0.006,0.007,0.006,0.006,0.007,0.006,0.006,0.007,0.008,0.006,0.007,0.006},
			{0.005,0.005,0.006,0.005,0.005,0.006,0.005,0.005,0.006,0.005,0.006,0.005},
			{0.006,0.006,0.007,0.007,0.005,0.005,0.005,0.005,0.006,0.013,0.008,0.006},
			{0.015,0.014,0.017,0.014,0.015,0.014,0.015,0.015,0.016,0.018,0.015,0.013},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.017,0.016,0.015,0.015,0.017,0.015,0.015,0.016,0.017,0.015,0.015,0.014},
			{0.006,0.007,0.006,0.006,0.010,0.007,0.006,0.006,0.007,0.007,0.007,0.005},
			{0.004,0.005,0.006,0.005,0.005,0.005,0.005,0.005,0.006,0.006,0.006,0.005},
			{0.006,0.006,0.007,0.006,0.007,0.006,0.006,0.006,0.008,0.006,0.007,0.007},
			{0.025,0.023,0.025,0.023,0.023,0.023,0.024,0.023,0.025,0.024,0.023,0.024}};

		static const double barrel_2015_F_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.491,0.283,0.523,0.643,0.323,0.742},
			{0.826,0.267,0.748,0.844,0.748,0.774},
			{0.737,0.462,0.814,0.729,0.695,0.744},
			{0.735,0.406,0.771,0.736,0.674,0.696},
			{0.775,0.279,0.636,0.664,0.792,0.832},
			{0.579,0.338,0.611,0.587,0.532,0.660}};

		static const double barrel_2015_F_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.015,0.011,0.014,0.011,0.012,0.010},
			{0.006,0.006,0.007,0.005,0.006,0.005},
			{0.007,0.006,0.006,0.006,0.006,0.006},
			{0.007,0.006,0.006,0.005,0.006,0.006},
			{0.007,0.006,0.008,0.006,0.006,0.005},
			{0.014,0.011,0.014,0.011,0.013,0.011}};

		static const double endcap_2015_F_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.408,0.396,0.406,0.400,0.406,0.461,0.410,0.407,0.367,0.441,0.413,0.421},
			{0.898,0.876,0.883,0.890,0.862,0.885,0.899,0.884,0.809,0.899,0.887,0.889},
			{0.899,0.885,0.840,0.922,0.860,0.848,0.900,0.894,0.861,0.917,0.847,0.886},
			{0.941,0.943,0.935,0.932,0.946,0.956,0.943,0.953,0.952,0.789,0.926,0.961},
			{0.779,0.764,0.634,0.824,0.770,0.831,0.767,0.764,0.762,0.705,0.816,0.845},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.715,0.769,0.706,0.794,0.716,0.784,0.761,0.756,0.734,0.849,0.833,0.787},
			{0.934,0.911,0.922,0.925,0.793,0.923,0.927,0.945,0.940,0.929,0.939,0.951},
			{0.917,0.894,0.836,0.875,0.879,0.888,0.878,0.886,0.854,0.822,0.858,0.861},
			{0.898,0.878,0.869,0.901,0.874,0.881,0.895,0.877,0.796,0.878,0.814,0.828},
			{0.402,0.419,0.519,0.474,0.444,0.444,0.411,0.438,0.378,0.455,0.461,0.416}};

		static const double endcap_2015_F_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.028,0.028,0.030,0.030,0.029,0.028,0.027,0.027,0.028,0.031,0.029,0.030},
			{0.007,0.008,0.008,0.008,0.008,0.008,0.007,0.008,0.010,0.008,0.008,0.008},
			{0.006,0.006,0.007,0.005,0.007,0.007,0.006,0.006,0.007,0.006,0.007,0.006},
			{0.007,0.007,0.008,0.008,0.007,0.007,0.007,0.007,0.007,0.015,0.009,0.006},
			{0.018,0.017,0.022,0.016,0.018,0.016,0.019,0.018,0.020,0.024,0.019,0.016},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.020,0.018,0.021,0.018,0.020,0.019,0.018,0.019,0.021,0.017,0.018,0.018},
			{0.008,0.009,0.009,0.008,0.013,0.008,0.008,0.007,0.008,0.009,0.008,0.007},
			{0.005,0.006,0.007,0.006,0.006,0.006,0.006,0.006,0.007,0.008,0.007,0.007},
			{0.007,0.008,0.008,0.007,0.008,0.008,0.007,0.008,0.010,0.008,0.010,0.009},
			{0.028,0.029,0.030,0.028,0.030,0.029,0.028,0.031,0.029,0.030,0.030,0.029}};

		static const double barrel_2015_G_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.486,0.284,0.500,0.643,0.327,0.740},
			{0.837,0.260,0.745,0.847,0.777,0.786},
			{0.726,0.451,0.801,0.724,0.691,0.740},
			{0.733,0.347,0.765,0.733,0.708,0.703},
			{0.749,0.245,0.611,0.679,0.789,0.833},
			{0.599,0.361,0.583,0.600,0.522,0.679}};

		static const double barrel_2015_G_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.009,0.007,0.009,0.007,0.008,0.007},
			{0.004,0.004,0.004,0.003,0.004,0.003},
			{0.004,0.004,0.004,0.004,0.004,0.004},
			{0.004,0.004,0.004,0.003,0.004,0.004},
			{0.004,0.004,0.005,0.004,0.004,0.003},
			{0.009,0.007,0.009,0.007,0.008,0.007}};

		static const double endcap_2015_G_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.412,0.445,0.413,0.406,0.407,0.420,0.396,0.404,0.368,0.425,0.402,0.400},
			{0.902,0.876,0.884,0.894,0.865,0.887,0.899,0.871,0.797,0.903,0.868,0.892},
			{0.899,0.872,0.834,0.905,0.850,0.855,0.894,0.891,0.864,0.914,0.844,0.888},
			{0.931,0.921,0.926,0.937,0.947,0.956,0.927,0.951,0.948,0.782,0.928,0.956},
			{0.789,0.768,0.593,0.820,0.750,0.812,0.754,0.766,0.786,0.715,0.795,0.813},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.708,0.751,0.726,0.777,0.716,0.792,0.763,0.754,0.698,0.832,0.825,0.816},
			{0.928,0.911,0.927,0.933,0.804,0.930,0.936,0.933,0.923,0.930,0.935,0.961},
			{0.909,0.894,0.829,0.873,0.875,0.879,0.881,0.886,0.835,0.833,0.839,0.865},
			{0.898,0.887,0.867,0.905,0.870,0.880,0.911,0.883,0.845,0.877,0.834,0.843},
			{0.443,0.462,0.443,0.468,0.443,0.439,0.445,0.462,0.444,0.451,0.412,0.422}};

		static const double endcap_2015_G_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.018,0.018,0.018,0.018,0.018,0.019,0.017,0.018,0.019,0.018,0.018,0.018},
			{0.004,0.005,0.005,0.005,0.005,0.005,0.005,0.005,0.006,0.005,0.005,0.005},
			{0.004,0.004,0.005,0.004,0.004,0.004,0.004,0.004,0.005,0.004,0.005,0.004},
			{0.005,0.005,0.005,0.005,0.004,0.004,0.005,0.004,0.005,0.010,0.006,0.004},
			{0.011,0.012,0.014,0.011,0.012,0.011,0.012,0.012,0.013,0.015,0.012,0.011},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.012,0.012,0.012,0.012,0.013,0.011,0.012,0.012,0.014,0.011,0.012,0.011},
			{0.005,0.006,0.005,0.005,0.008,0.005,0.005,0.005,0.006,0.006,0.005,0.004},
			{0.004,0.004,0.005,0.004,0.004,0.004,0.004,0.004,0.005,0.005,0.005,0.004},
			{0.005,0.005,0.005,0.004,0.005,0.005,0.004,0.005,0.006,0.005,0.006,0.006},
			{0.019,0.018,0.018,0.019,0.018,0.018,0.018,0.018,0.019,0.020,0.018,0.018}};

		static const double barrel_2015_H_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.558,0.221,0.507,0.402,0.331,0.736},
			{0.827,0.153,0.742,0.853,0.775,0.775},
			{0.717,0.253,0.802,0.732,0.664,0.732},
			{0.725,0.168,0.772,0.734,0.709,0.702},
			{0.787,0.158,0.602,0.670,0.787,0.827},
			{0.644,0.190,0.544,0.626,0.493,0.615}};

		static const double barrel_2015_H_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.015,0.011,0.016,0.013,0.014,0.011},
			{0.006,0.005,0.007,0.005,0.007,0.006},
			{0.007,0.006,0.007,0.006,0.007,0.006},
			{0.007,0.005,0.007,0.006,0.007,0.006},
			{0.007,0.005,0.008,0.007,0.007,0.005},
			{0.015,0.010,0.016,0.012,0.015,0.012}};

		static const double endcap_2015_H_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.427,0.418,0.456,0.356,0.388,0.420,0.423,0.387,0.398,0.455,0.451,0.417},
			{0.890,0.862,0.871,0.895,0.872,0.881,0.906,0.879,0.777,0.900,0.851,0.866},
			{0.897,0.875,0.834,0.905,0.852,0.853,0.888,0.906,0.871,0.917,0.861,0.888},
			{0.920,0.938,0.920,0.937,0.951,0.965,0.923,0.953,0.954,0.749,0.914,0.949},
			{0.839,0.777,0.620,0.814,0.775,0.807,0.737,0.791,0.768,0.735,0.815,0.833},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.720,0.765,0.740,0.740,0.690,0.790,0.754,0.765,0.528,0.856,0.801,0.814},
			{0.923,0.919,0.949,0.941,0.786,0.940,0.928,0.920,0.935,0.922,0.939,0.939},
			{0.918,0.883,0.851,0.878,0.875,0.886,0.867,0.893,0.819,0.840,0.870,0.884},
			{0.905,0.889,0.876,0.914,0.876,0.884,0.906,0.883,0.834,0.883,0.840,0.831},
			{0.415,0.434,0.434,0.443,0.464,0.396,0.416,0.444,0.449,0.464,0.352,0.442}};

		static const double endcap_2015_H_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.031,0.031,0.031,0.030,0.031,0.030,0.030,0.030,0.032,0.034,0.032,0.031},
			{0.008,0.009,0.009,0.008,0.009,0.009,0.007,0.008,0.012,0.009,0.010,0.009},
			{0.006,0.007,0.008,0.006,0.008,0.008,0.006,0.006,0.008,0.007,0.008,0.007},
			{0.009,0.009,0.009,0.008,0.007,0.006,0.009,0.008,0.008,0.018,0.011,0.008},
			{0.018,0.019,0.023,0.019,0.020,0.019,0.020,0.020,0.022,0.026,0.021,0.018},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.021,0.020,0.021,0.020,0.021,0.019,0.020,0.021,0.027,0.019,0.022,0.019},
			{0.009,0.010,0.008,0.008,0.014,0.008,0.009,0.009,0.010,0.011,0.009,0.009},
			{0.006,0.007,0.008,0.007,0.007,0.007,0.007,0.007,0.009,0.009,0.008,0.007},
			{0.008,0.008,0.009,0.007,0.008,0.008,0.008,0.008,0.010,0.009,0.010,0.010},
			{0.031,0.031,0.031,0.030,0.032,0.031,0.030,0.032,0.034,0.037,0.033,0.032}};

		static const double barrel_2015_J_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.551,0.308,0.500,0.371,0.331,0.732},
			{0.835,0.334,0.746,0.847,0.777,0.781},
			{0.733,0.444,0.798,0.728,0.689,0.723},
			{0.736,0.423,0.783,0.736,0.708,0.701},
			{0.794,0.323,0.679,0.678,0.784,0.816},
			{0.598,0.368,0.600,0.618,0.517,0.616}};

		static const double barrel_2015_J_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.006,0.005,0.006,0.005,0.005,0.005},
			{0.003,0.003,0.003,0.002,0.003,0.002},
			{0.003,0.003,0.003,0.002,0.003,0.003},
			{0.003,0.003,0.003,0.002,0.003,0.003},
			{0.003,0.003,0.003,0.003,0.003,0.002},
			{0.006,0.005,0.006,0.005,0.006,0.005}};

		static const double endcap_2015_J_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.418,0.441,0.406,0.401,0.391,0.431,0.408,0.414,0.360,0.418,0.416,0.421},
			{0.898,0.874,0.879,0.892,0.859,0.879,0.905,0.880,0.793,0.899,0.863,0.875},
			{0.891,0.876,0.833,0.912,0.845,0.849,0.894,0.890,0.867,0.914,0.849,0.883},
			{0.940,0.932,0.930,0.931,0.949,0.960,0.939,0.955,0.955,0.792,0.924,0.942},
			{0.789,0.768,0.594,0.806,0.751,0.806,0.738,0.761,0.768,0.708,0.813,0.824},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.714,0.747,0.729,0.773,0.697,0.797,0.740,0.741,0.629,0.837,0.825,0.809},
			{0.932,0.912,0.942,0.937,0.802,0.936,0.935,0.934,0.927,0.934,0.932,0.951},
			{0.911,0.885,0.840,0.877,0.872,0.875,0.880,0.887,0.834,0.839,0.854,0.868},
			{0.902,0.877,0.876,0.906,0.877,0.878,0.905,0.883,0.842,0.890,0.821,0.852},
			{0.459,0.468,0.453,0.444,0.437,0.461,0.458,0.445,0.403,0.442,0.418,0.418}};

		static const double endcap_2015_J_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.013,0.013,0.013,0.012,0.012,0.013,0.012,0.012,0.013,0.014,0.013,0.012},
			{0.003,0.004,0.004,0.003,0.004,0.003,0.003,0.003,0.005,0.003,0.004,0.004},
			{0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003},
			{0.003,0.003,0.004,0.004,0.003,0.003,0.003,0.003,0.003,0.007,0.004,0.003},
			{0.008,0.008,0.010,0.008,0.008,0.008,0.008,0.008,0.009,0.010,0.008,0.008},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.009,0.008,0.009,0.008,0.009,0.008,0.008,0.008,0.010,0.008,0.008,0.008},
			{0.004,0.004,0.003,0.003,0.006,0.003,0.003,0.004,0.004,0.004,0.004,0.003},
			{0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003},
			{0.003,0.004,0.004,0.003,0.004,0.003,0.003,0.003,0.004,0.004,0.004,0.004},
			{0.013,0.013,0.013,0.013,0.013,0.013,0.013,0.013,0.013,0.013,0.013,0.013}};

		static const double barrel_2016_A_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.511,0.463,0.479,0.699,0.344,0.743},
			{0.833,0.534,0.725,0.889,0.803,0.764},
			{0.727,0.548,0.801,0.715,0.710,0.662},
			{0.747,0.530,0.774,0.694,0.728,0.720},
			{0.820,0.488,0.690,0.605,0.808,0.793},
			{0.584,0.440,0.575,0.591,0.538,0.423}};

		static const double barrel_2016_A_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.011,0.009,0.011,0.008,0.009,0.008},
			{0.004,0.005,0.005,0.003,0.004,0.004},
			{0.005,0.004,0.005,0.004,0.004,0.004},
			{0.005,0.005,0.005,0.004,0.004,0.004},
			{0.004,0.005,0.005,0.005,0.004,0.004},
			{0.011,0.009,0.011,0.009,0.009,0.009}};

		static const double endcap_2016_A_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.422,0.440,0.404,0.422,0.400,0.428,0.406,0.428,0.384,0.430,0.422,0.417},
			{0.914,0.883,0.893,0.904,0.877,0.894,0.919,0.885,0.807,0.913,0.879,0.898},
			{0.931,0.893,0.857,0.926,0.866,0.892,0.935,0.905,0.904,0.920,0.843,0.892},
			{0.953,0.928,0.930,0.932,0.950,0.950,0.947,0.958,0.950,0.924,0.923,0.954},
			{0.805,0.800,0.646,0.811,0.779,0.786,0.778,0.783,0.784,0.774,0.810,0.835},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.800,0.754,0.758,0.766,0.790,0.785,0.801,0.807,0.674,0.842,0.807,0.824},
			{0.945,0.911,0.944,0.942,0.936,0.933,0.956,0.947,0.932,0.945,0.927,0.951},
			{0.919,0.899,0.827,0.922,0.889,0.887,0.927,0.893,0.889,0.887,0.871,0.895},
			{0.916,0.891,0.874,0.916,0.884,0.884,0.919,0.896,0.860,0.906,0.846,0.870},
			{0.458,0.485,0.449,0.494,0.421,0.490,0.426,0.445,0.411,0.450,0.427,0.429}};

		static const double endcap_2016_A_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.021,0.021,0.020,0.021,0.020,0.021,0.020,0.021,0.021,0.022,0.021,0.020},
			{0.005,0.006,0.005,0.005,0.006,0.005,0.005,0.006,0.007,0.005,0.006,0.005},
			{0.004,0.004,0.005,0.004,0.005,0.005,0.003,0.004,0.004,0.004,0.005,0.004},
			{0.005,0.006,0.006,0.006,0.005,0.005,0.005,0.005,0.005,0.007,0.006,0.005},
			{0.012,0.013,0.015,0.012,0.013,0.013,0.013,0.013,0.014,0.014,0.013,0.012},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.013,0.014,0.014,0.014,0.013,0.014,0.013,0.013,0.016,0.012,0.013,0.013},
			{0.005,0.007,0.005,0.005,0.006,0.006,0.005,0.005,0.006,0.006,0.006,0.005},
			{0.004,0.004,0.005,0.004,0.005,0.005,0.004,0.004,0.005,0.005,0.005,0.004},
			{0.005,0.005,0.006,0.005,0.006,0.006,0.005,0.005,0.006,0.005,0.006,0.006},
			{0.022,0.021,0.022,0.021,0.020,0.021,0.021,0.021,0.022,0.022,0.022,0.022}};

		static const double barrel_2016_B_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.595,0.439,0.477,0.693,0.356,0.732},
			{0.830,0.535,0.771,0.884,0.792,0.754},
			{0.740,0.559,0.799,0.674,0.693,0.673},
			{0.743,0.536,0.789,0.762,0.725,0.724},
			{0.814,0.538,0.680,0.691,0.795,0.779},
			{0.582,0.431,0.601,0.648,0.515,0.418}};

		static const double barrel_2016_B_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.006,0.005,0.006,0.004,0.005,0.004},
			{0.002,0.003,0.003,0.002,0.002,0.002},
			{0.003,0.002,0.002,0.002,0.002,0.002},
			{0.003,0.002,0.002,0.002,0.002,0.002},
			{0.002,0.003,0.003,0.002,0.002,0.002},
			{0.006,0.005,0.006,0.004,0.005,0.005}};

		static const double endcap_2016_B_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.428,0.418,0.428,0.375,0.411,0.403,0.422,0.411,0.371,0.419,0.430,0.405},
			{0.910,0.886,0.885,0.798,0.868,0.894,0.912,0.892,0.791,0.916,0.880,0.887},
			{0.920,0.888,0.876,0.813,0.860,0.884,0.929,0.902,0.905,0.916,0.834,0.881},
			{0.948,0.931,0.928,0.829,0.947,0.943,0.950,0.952,0.952,0.941,0.919,0.950},
			{0.810,0.764,0.558,0.710,0.773,0.813,0.749,0.727,0.778,0.768,0.755,0.831},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.819,0.760,0.721,0.737,0.766,0.788,0.822,0.817,0.794,0.852,0.785,0.813},
			{0.947,0.911,0.937,0.939,0.933,0.936,0.952,0.947,0.935,0.942,0.933,0.955},
			{0.915,0.900,0.845,0.923,0.883,0.883,0.928,0.898,0.889,0.889,0.856,0.891},
			{0.906,0.890,0.876,0.911,0.885,0.883,0.917,0.892,0.852,0.898,0.844,0.865},
			{0.439,0.452,0.451,0.469,0.457,0.427,0.454,0.429,0.425,0.443,0.424,0.428}};

		static const double endcap_2016_B_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.011,0.011,0.011,0.011,0.011,0.011,0.011,0.011,0.011,0.012,0.011,0.011},
			{0.003,0.003,0.003,0.004,0.003,0.003,0.003,0.003,0.004,0.003,0.003,0.003},
			{0.002,0.002,0.002,0.003,0.003,0.002,0.002,0.002,0.002,0.002,0.003,0.002},
			{0.003,0.003,0.003,0.005,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003},
			{0.007,0.007,0.008,0.008,0.007,0.007,0.007,0.007,0.007,0.008,0.008,0.006},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.007,0.007,0.008,0.007,0.007,0.007,0.006,0.007,0.007,0.006,0.007,0.007},
			{0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003},
			{0.002,0.002,0.003,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.003,0.002},
			{0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003},
			{0.011,0.011,0.011,0.011,0.011,0.011,0.011,0.011,0.011,0.012,0.011,0.011}};

		unc = 0.;
		if(fabs(eta)<1.05) { // barrel
			int ieta = std::upper_bound(bins_eta_barrel,bins_eta_barrel+nbins_eta_barrel+1,eta) - bins_eta_barrel - 1;
			if(ieta<0 || ieta>=nbins_eta_barrel) return 0.;
			int iphi = std::upper_bound(bins_phi_barrel,bins_phi_barrel+nbins_phi_barrel+1,phi) - bins_phi_barrel - 1;
			if(iphi<0) iphi = nbins_phi_barrel-1;
			if(iphi>=nbins_phi_barrel) iphi = 0;
			unc = ::select_period_array(runnumber,barrel_2015_D_err,barrel_2015_E_err,barrel_2015_F_err,barrel_2015_G_err,barrel_2015_H_err,barrel_2015_J_err,barrel_2016_A_err,barrel_2016_B_err)[ieta][iphi];
			return ::select_period_array(runnumber,barrel_2015_D_val,barrel_2015_E_val,barrel_2015_F_val,barrel_2015_G_val,barrel_2015_H_val,barrel_2015_J_val,barrel_2016_A_val,barrel_2016_B_val)[ieta][iphi];
		} else { // endcap
			int ieta = std::upper_bound(bins_eta_endcap,bins_eta_endcap+nbins_eta_endcap+1,eta) - bins_eta_endcap - 1;
			if(ieta<0 || ieta>=nbins_eta_endcap) return 0.;
			int iphi = std::upper_bound(bins_phi_endcap,bins_phi_endcap+nbins_phi_endcap+1,phi) - bins_phi_endcap - 1;
			if(iphi<0) iphi = nbins_phi_endcap-1;
			if(iphi>=nbins_phi_endcap) iphi = 0;
			unc = ::select_period_array(runnumber,endcap_2015_D_err,endcap_2015_E_err,endcap_2015_F_err,endcap_2015_G_err,endcap_2015_H_err,endcap_2015_J_err,endcap_2016_A_err,endcap_2016_B_err)[ieta][iphi];
			return ::select_period_array(runnumber,endcap_2015_D_val,endcap_2015_E_val,endcap_2015_F_val,endcap_2015_G_val,endcap_2015_H_val,endcap_2015_J_val,endcap_2016_A_val,endcap_2016_B_val)[ieta][iphi];
		}
	}
	double efficiency_mc_muXmuY_leadmuon(double eta, double phi, double& unc,int runnumber)
	{
		static const double bins_eta_barrel[] = {-1.05,-0.91,-0.48,0.00,0.48,0.91,1.05};
		const int nbins_eta_barrel = sizeof(bins_eta_barrel)/sizeof(*bins_eta_barrel)-1;
		static const double bins_eta_endcap[] = {-2.50,-2.40,-1.92,-1.35,-1.15,-1.05,1.05,1.15,1.35,1.92,2.40,2.50};
		const int nbins_eta_endcap = sizeof(bins_eta_endcap)/sizeof(*bins_eta_endcap)-1;
		static const double bins_phi_barrel[] = {-2.95,-2.16,-0.98,-0.20,0.98,2.16,3.34};
		const int nbins_phi_barrel = sizeof(bins_phi_barrel)/sizeof(*bins_phi_barrel)-1;
		static const double bins_phi_endcap[] = {-3.40,-2.88,-2.36,-1.83,-1.31,-0.79,-0.26,0.26,0.79,1.31,1.83,2.36,2.88};
		const int nbins_phi_endcap = sizeof(bins_phi_endcap)/sizeof(*bins_phi_endcap)-1;
		static const double barrel_2015_D_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.591,0.518,0.633,0.665,0.504,0.688},
			{0.877,0.639,0.824,0.853,0.835,0.832},
			{0.800,0.606,0.843,0.799,0.726,0.791},
			{0.828,0.606,0.839,0.829,0.800,0.732},
			{0.850,0.592,0.850,0.800,0.859,0.850},
			{0.650,0.505,0.639,0.648,0.574,0.637}};

		static const double barrel_2015_D_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.017,0.014,0.017,0.014,0.015,0.014},
			{0.010,0.009,0.010,0.009,0.009,0.009},
			{0.010,0.009,0.010,0.009,0.009,0.009},
			{0.010,0.009,0.010,0.009,0.009,0.009},
			{0.010,0.009,0.010,0.009,0.009,0.009},
			{0.017,0.014,0.017,0.014,0.015,0.014}};

		static const double endcap_2015_D_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.409,0.405,0.463,0.429,0.367,0.519,0.398,0.435,0.399,0.505,0.467,0.386},
			{0.915,0.902,0.881,0.919,0.888,0.901,0.908,0.877,0.839,0.911,0.890,0.879},
			{0.911,0.885,0.858,0.914,0.883,0.886,0.907,0.884,0.891,0.919,0.891,0.878},
			{0.965,0.947,0.948,0.963,0.937,0.957,0.945,0.945,0.939,0.948,0.944,0.953},
			{0.820,0.818,0.806,0.841,0.815,0.801,0.836,0.827,0.831,0.835,0.774,0.823},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.798,0.801,0.846,0.858,0.803,0.793,0.780,0.832,0.783,0.848,0.790,0.817},
			{0.935,0.932,0.937,0.949,0.945,0.940,0.951,0.949,0.945,0.924,0.950,0.945},
			{0.900,0.859,0.872,0.897,0.855,0.867,0.908,0.875,0.882,0.895,0.867,0.879},
			{0.897,0.908,0.897,0.911,0.895,0.885,0.925,0.906,0.890,0.909,0.895,0.889},
			{0.466,0.399,0.481,0.388,0.446,0.421,0.464,0.486,0.470,0.372,0.423,0.470}};

		static const double endcap_2015_D_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.030,0.030,0.034,0.033,0.032,0.032,0.031,0.032,0.032,0.034,0.033,0.033},
			{0.010,0.010,0.011,0.010,0.011,0.010,0.010,0.011,0.012,0.010,0.011,0.011},
			{0.009,0.009,0.010,0.009,0.010,0.009,0.009,0.009,0.009,0.009,0.009,0.010},
			{0.009,0.010,0.010,0.009,0.011,0.010,0.010,0.010,0.011,0.011,0.011,0.010},
			{0.019,0.020,0.020,0.019,0.020,0.021,0.019,0.019,0.019,0.019,0.022,0.019},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.021,0.021,0.017,0.019,0.021,0.021,0.022,0.019,0.022,0.018,0.021,0.020},
			{0.011,0.011,0.011,0.010,0.010,0.011,0.010,0.010,0.011,0.012,0.011,0.010},
			{0.009,0.010,0.010,0.009,0.010,0.010,0.009,0.010,0.010,0.010,0.010,0.009},
			{0.010,0.010,0.010,0.010,0.010,0.011,0.010,0.010,0.010,0.010,0.011,0.011},
			{0.031,0.033,0.033,0.032,0.033,0.030,0.033,0.033,0.033,0.032,0.032,0.032}};

		static const double barrel_2015_E_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.591,0.518,0.633,0.665,0.504,0.688},
			{0.877,0.639,0.824,0.853,0.835,0.832},
			{0.800,0.606,0.843,0.799,0.726,0.791},
			{0.828,0.606,0.839,0.829,0.800,0.732},
			{0.850,0.592,0.850,0.800,0.859,0.850},
			{0.650,0.505,0.639,0.648,0.574,0.637}};

		static const double barrel_2015_E_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.016,0.013,0.016,0.013,0.014,0.013},
			{0.007,0.008,0.008,0.006,0.006,0.006},
			{0.008,0.007,0.007,0.007,0.007,0.007},
			{0.007,0.007,0.007,0.006,0.007,0.007},
			{0.007,0.008,0.007,0.007,0.006,0.006},
			{0.016,0.014,0.016,0.013,0.014,0.013}};

		static const double endcap_2015_E_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.409,0.405,0.463,0.429,0.367,0.519,0.398,0.435,0.399,0.505,0.467,0.386},
			{0.915,0.902,0.881,0.919,0.888,0.901,0.908,0.877,0.839,0.911,0.890,0.879},
			{0.911,0.885,0.858,0.914,0.883,0.886,0.907,0.884,0.891,0.919,0.891,0.878},
			{0.965,0.947,0.948,0.963,0.937,0.957,0.945,0.945,0.939,0.948,0.944,0.953},
			{0.820,0.818,0.806,0.841,0.815,0.801,0.836,0.827,0.831,0.835,0.774,0.823},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.798,0.801,0.846,0.858,0.803,0.793,0.780,0.832,0.783,0.848,0.790,0.817},
			{0.935,0.932,0.937,0.949,0.945,0.940,0.951,0.949,0.945,0.924,0.950,0.945},
			{0.900,0.859,0.872,0.897,0.855,0.867,0.908,0.875,0.882,0.895,0.867,0.879},
			{0.897,0.908,0.897,0.911,0.895,0.885,0.925,0.906,0.890,0.909,0.895,0.889},
			{0.466,0.399,0.481,0.388,0.446,0.421,0.464,0.486,0.470,0.372,0.423,0.470}};

		static const double endcap_2015_E_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.030,0.030,0.034,0.033,0.032,0.032,0.031,0.032,0.032,0.034,0.033,0.033},
			{0.009,0.010,0.010,0.009,0.010,0.010,0.009,0.010,0.011,0.010,0.010,0.010},
			{0.008,0.009,0.009,0.008,0.009,0.009,0.008,0.009,0.009,0.008,0.009,0.009},
			{0.008,0.009,0.009,0.008,0.010,0.009,0.010,0.010,0.010,0.010,0.010,0.009},
			{0.019,0.019,0.020,0.019,0.020,0.021,0.019,0.019,0.019,0.019,0.022,0.019},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.021,0.021,0.017,0.018,0.020,0.021,0.021,0.019,0.021,0.018,0.021,0.020},
			{0.010,0.010,0.010,0.009,0.010,0.010,0.009,0.009,0.010,0.011,0.010,0.010},
			{0.008,0.009,0.009,0.008,0.009,0.009,0.008,0.009,0.009,0.009,0.009,0.009},
			{0.010,0.009,0.010,0.009,0.010,0.010,0.009,0.009,0.010,0.010,0.010,0.010},
			{0.031,0.033,0.032,0.032,0.033,0.030,0.033,0.033,0.033,0.031,0.032,0.031}};

		static const double barrel_2015_F_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.591,0.518,0.633,0.665,0.504,0.688},
			{0.877,0.639,0.824,0.853,0.835,0.832},
			{0.800,0.606,0.843,0.799,0.726,0.791},
			{0.828,0.606,0.839,0.829,0.800,0.732},
			{0.850,0.592,0.850,0.800,0.859,0.850},
			{0.650,0.505,0.639,0.648,0.574,0.637}};

		static const double barrel_2015_F_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.016,0.013,0.016,0.013,0.014,0.013},
			{0.007,0.008,0.008,0.007,0.007,0.007},
			{0.008,0.007,0.008,0.007,0.007,0.007},
			{0.008,0.007,0.008,0.007,0.007,0.007},
			{0.008,0.008,0.008,0.007,0.007,0.007},
			{0.016,0.014,0.016,0.013,0.014,0.013}};

		static const double endcap_2015_F_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.409,0.405,0.463,0.429,0.367,0.519,0.398,0.435,0.399,0.505,0.467,0.386},
			{0.915,0.902,0.881,0.919,0.888,0.901,0.908,0.877,0.839,0.911,0.890,0.879},
			{0.911,0.885,0.858,0.914,0.883,0.886,0.907,0.884,0.891,0.919,0.891,0.878},
			{0.965,0.947,0.948,0.963,0.937,0.957,0.945,0.945,0.939,0.948,0.944,0.953},
			{0.820,0.818,0.806,0.841,0.815,0.801,0.836,0.827,0.831,0.835,0.774,0.823},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.798,0.801,0.846,0.858,0.803,0.793,0.780,0.832,0.783,0.848,0.790,0.817},
			{0.935,0.932,0.937,0.949,0.945,0.940,0.951,0.949,0.945,0.924,0.950,0.945},
			{0.900,0.859,0.872,0.897,0.855,0.867,0.908,0.875,0.882,0.895,0.867,0.879},
			{0.897,0.908,0.897,0.911,0.895,0.885,0.925,0.906,0.890,0.909,0.895,0.889},
			{0.466,0.399,0.481,0.388,0.446,0.421,0.464,0.486,0.470,0.372,0.423,0.470}};

		static const double endcap_2015_F_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.030,0.030,0.034,0.033,0.032,0.032,0.031,0.032,0.032,0.034,0.033,0.033},
			{0.009,0.010,0.010,0.009,0.010,0.010,0.009,0.010,0.011,0.010,0.010,0.010},
			{0.008,0.009,0.009,0.008,0.009,0.009,0.008,0.009,0.009,0.008,0.009,0.009},
			{0.008,0.009,0.009,0.008,0.010,0.009,0.010,0.010,0.010,0.010,0.010,0.009},
			{0.019,0.019,0.020,0.019,0.020,0.021,0.019,0.019,0.019,0.019,0.022,0.019},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.021,0.021,0.017,0.018,0.020,0.021,0.021,0.019,0.021,0.018,0.021,0.020},
			{0.010,0.010,0.010,0.009,0.010,0.010,0.010,0.009,0.010,0.011,0.010,0.010},
			{0.008,0.009,0.009,0.008,0.009,0.009,0.008,0.009,0.009,0.009,0.009,0.009},
			{0.010,0.009,0.010,0.009,0.010,0.010,0.009,0.009,0.010,0.010,0.010,0.010},
			{0.031,0.033,0.032,0.032,0.033,0.030,0.033,0.033,0.033,0.031,0.032,0.032}};

		static const double barrel_2015_G_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.591,0.518,0.633,0.665,0.504,0.688},
			{0.877,0.639,0.824,0.853,0.835,0.832},
			{0.800,0.606,0.843,0.799,0.726,0.791},
			{0.828,0.606,0.839,0.829,0.800,0.732},
			{0.850,0.592,0.850,0.800,0.859,0.850},
			{0.650,0.505,0.639,0.648,0.574,0.637}};

		static const double barrel_2015_G_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.016,0.013,0.017,0.013,0.014,0.013},
			{0.008,0.008,0.008,0.007,0.007,0.007},
			{0.008,0.008,0.008,0.007,0.008,0.007},
			{0.008,0.008,0.008,0.007,0.007,0.008},
			{0.008,0.008,0.008,0.007,0.007,0.007},
			{0.016,0.014,0.016,0.014,0.014,0.013}};

		static const double endcap_2015_G_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.409,0.405,0.463,0.429,0.367,0.519,0.398,0.435,0.399,0.505,0.467,0.386},
			{0.915,0.902,0.881,0.919,0.888,0.901,0.908,0.877,0.839,0.911,0.890,0.879},
			{0.911,0.885,0.858,0.914,0.883,0.886,0.907,0.884,0.891,0.919,0.891,0.878},
			{0.965,0.947,0.948,0.963,0.937,0.957,0.945,0.945,0.939,0.948,0.944,0.953},
			{0.820,0.818,0.806,0.841,0.815,0.801,0.836,0.827,0.831,0.835,0.774,0.823},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.798,0.801,0.846,0.858,0.803,0.793,0.780,0.832,0.783,0.848,0.790,0.817},
			{0.935,0.932,0.937,0.949,0.945,0.940,0.951,0.949,0.945,0.924,0.950,0.945},
			{0.900,0.859,0.872,0.897,0.855,0.867,0.908,0.875,0.882,0.895,0.867,0.879},
			{0.897,0.908,0.897,0.911,0.895,0.885,0.925,0.906,0.890,0.909,0.895,0.889},
			{0.466,0.399,0.481,0.388,0.446,0.421,0.464,0.486,0.470,0.372,0.423,0.470}};

		static const double endcap_2015_G_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.030,0.030,0.034,0.033,0.032,0.032,0.031,0.032,0.032,0.034,0.033,0.033},
			{0.009,0.010,0.010,0.009,0.010,0.010,0.009,0.010,0.011,0.010,0.010,0.011},
			{0.008,0.009,0.009,0.008,0.009,0.009,0.008,0.009,0.009,0.008,0.009,0.009},
			{0.008,0.009,0.009,0.009,0.010,0.009,0.010,0.010,0.010,0.010,0.010,0.009},
			{0.019,0.019,0.020,0.019,0.020,0.021,0.019,0.019,0.019,0.019,0.022,0.019},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.021,0.021,0.017,0.018,0.020,0.021,0.021,0.019,0.022,0.018,0.021,0.020},
			{0.010,0.010,0.010,0.009,0.010,0.010,0.010,0.009,0.010,0.011,0.010,0.010},
			{0.009,0.009,0.009,0.009,0.010,0.009,0.008,0.009,0.009,0.009,0.009,0.009},
			{0.010,0.009,0.010,0.009,0.010,0.010,0.009,0.009,0.010,0.010,0.010,0.010},
			{0.031,0.033,0.032,0.032,0.033,0.030,0.033,0.033,0.033,0.031,0.032,0.032}};

		static const double barrel_2015_H_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.591,0.518,0.633,0.665,0.504,0.688},
			{0.877,0.639,0.824,0.853,0.835,0.832},
			{0.800,0.606,0.843,0.799,0.726,0.791},
			{0.828,0.606,0.839,0.829,0.800,0.732},
			{0.850,0.592,0.850,0.800,0.859,0.850},
			{0.650,0.505,0.639,0.648,0.574,0.637}};

		static const double barrel_2015_H_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.016,0.013,0.017,0.013,0.014,0.013},
			{0.008,0.008,0.009,0.007,0.008,0.008},
			{0.009,0.008,0.008,0.008,0.008,0.008},
			{0.008,0.008,0.008,0.007,0.008,0.008},
			{0.008,0.008,0.008,0.008,0.007,0.007},
			{0.016,0.014,0.017,0.014,0.014,0.014}};

		static const double endcap_2015_H_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.409,0.405,0.463,0.429,0.367,0.519,0.398,0.435,0.399,0.505,0.467,0.386},
			{0.915,0.902,0.881,0.919,0.888,0.901,0.908,0.877,0.839,0.911,0.890,0.879},
			{0.911,0.885,0.858,0.914,0.883,0.886,0.907,0.884,0.891,0.919,0.891,0.878},
			{0.965,0.947,0.948,0.963,0.937,0.957,0.945,0.945,0.939,0.948,0.944,0.953},
			{0.820,0.818,0.806,0.841,0.815,0.801,0.836,0.827,0.831,0.835,0.774,0.823},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.798,0.801,0.846,0.858,0.803,0.793,0.780,0.832,0.783,0.848,0.790,0.817},
			{0.935,0.932,0.937,0.949,0.945,0.940,0.951,0.949,0.945,0.924,0.950,0.945},
			{0.900,0.859,0.872,0.897,0.855,0.867,0.908,0.875,0.882,0.895,0.867,0.879},
			{0.897,0.908,0.897,0.911,0.895,0.885,0.925,0.906,0.890,0.909,0.895,0.889},
			{0.466,0.399,0.481,0.388,0.446,0.421,0.464,0.486,0.470,0.372,0.423,0.470}};

		static const double endcap_2015_H_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.030,0.030,0.034,0.033,0.032,0.032,0.031,0.032,0.032,0.034,0.033,0.033},
			{0.010,0.010,0.011,0.010,0.011,0.010,0.010,0.011,0.012,0.010,0.011,0.011},
			{0.009,0.009,0.010,0.009,0.010,0.010,0.009,0.010,0.009,0.009,0.010,0.010},
			{0.009,0.010,0.010,0.009,0.011,0.010,0.010,0.011,0.011,0.011,0.011,0.010},
			{0.019,0.020,0.020,0.019,0.020,0.021,0.019,0.019,0.019,0.019,0.022,0.019},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.021,0.021,0.017,0.019,0.021,0.021,0.022,0.019,0.022,0.019,0.021,0.020},
			{0.011,0.011,0.011,0.010,0.011,0.011,0.010,0.010,0.011,0.012,0.011,0.011},
			{0.009,0.010,0.010,0.009,0.010,0.010,0.009,0.010,0.010,0.010,0.010,0.010},
			{0.010,0.010,0.010,0.010,0.010,0.011,0.010,0.010,0.011,0.010,0.011,0.011},
			{0.031,0.033,0.033,0.032,0.033,0.030,0.033,0.033,0.033,0.032,0.032,0.032}};

		static const double barrel_2015_J_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.591,0.518,0.633,0.665,0.504,0.688},
			{0.877,0.639,0.824,0.853,0.835,0.832},
			{0.800,0.606,0.843,0.799,0.726,0.791},
			{0.828,0.606,0.839,0.829,0.800,0.732},
			{0.850,0.592,0.850,0.800,0.859,0.850},
			{0.650,0.505,0.639,0.648,0.574,0.637}};

		static const double barrel_2015_J_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.016,0.013,0.016,0.013,0.014,0.013},
			{0.007,0.008,0.008,0.007,0.007,0.007},
			{0.008,0.007,0.007,0.007,0.007,0.007},
			{0.008,0.007,0.008,0.006,0.007,0.007},
			{0.008,0.008,0.008,0.007,0.007,0.006},
			{0.016,0.014,0.016,0.013,0.014,0.013}};

		static const double endcap_2015_J_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.409,0.405,0.463,0.429,0.367,0.519,0.398,0.435,0.399,0.505,0.467,0.386},
			{0.915,0.902,0.881,0.919,0.888,0.901,0.908,0.877,0.839,0.911,0.890,0.879},
			{0.911,0.885,0.858,0.914,0.883,0.886,0.907,0.884,0.891,0.919,0.891,0.878},
			{0.965,0.947,0.948,0.963,0.937,0.957,0.945,0.945,0.939,0.948,0.944,0.953},
			{0.820,0.818,0.806,0.841,0.815,0.801,0.836,0.827,0.831,0.835,0.774,0.823},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.798,0.801,0.846,0.858,0.803,0.793,0.780,0.832,0.783,0.848,0.790,0.817},
			{0.935,0.932,0.937,0.949,0.945,0.940,0.951,0.949,0.945,0.924,0.950,0.945},
			{0.900,0.859,0.872,0.897,0.855,0.867,0.908,0.875,0.882,0.895,0.867,0.879},
			{0.897,0.908,0.897,0.911,0.895,0.885,0.925,0.906,0.890,0.909,0.895,0.889},
			{0.466,0.399,0.481,0.388,0.446,0.421,0.464,0.486,0.470,0.372,0.423,0.470}};

		static const double endcap_2015_J_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.030,0.030,0.034,0.032,0.032,0.032,0.031,0.032,0.032,0.034,0.033,0.033},
			{0.009,0.009,0.010,0.008,0.010,0.009,0.009,0.010,0.011,0.009,0.010,0.010},
			{0.007,0.008,0.009,0.007,0.009,0.008,0.008,0.008,0.008,0.007,0.008,0.008},
			{0.008,0.009,0.009,0.008,0.010,0.009,0.009,0.009,0.010,0.009,0.010,0.008},
			{0.019,0.019,0.020,0.019,0.020,0.020,0.018,0.018,0.019,0.019,0.022,0.019},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.020,0.021,0.017,0.018,0.020,0.021,0.021,0.018,0.021,0.018,0.021,0.020},
			{0.010,0.010,0.009,0.009,0.009,0.010,0.009,0.009,0.010,0.011,0.009,0.009},
			{0.008,0.009,0.009,0.008,0.009,0.008,0.008,0.008,0.008,0.008,0.009,0.008},
			{0.009,0.009,0.009,0.009,0.009,0.010,0.008,0.009,0.009,0.009,0.010,0.010},
			{0.031,0.033,0.032,0.032,0.033,0.030,0.033,0.033,0.033,0.031,0.032,0.031}};

		static const double barrel_2016_A_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.587,0.512,0.618,0.638,0.481,0.680},
			{0.863,0.626,0.828,0.850,0.829,0.844},
			{0.792,0.613,0.853,0.795,0.720,0.790},
			{0.831,0.613,0.837,0.826,0.809,0.746},
			{0.858,0.594,0.836,0.792,0.858,0.841},
			{0.617,0.517,0.598,0.656,0.551,0.649}};

		static const double barrel_2016_A_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.015,0.013,0.016,0.014,0.013,0.014},
			{0.013,0.010,0.012,0.012,0.012,0.012},
			{0.012,0.010,0.012,0.012,0.011,0.012},
			{0.012,0.010,0.012,0.012,0.012,0.011},
			{0.012,0.010,0.012,0.012,0.012,0.012},
			{0.016,0.013,0.016,0.014,0.013,0.014}};

		static const double endcap_2016_A_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.436,0.418,0.442,0.405,0.438,0.511,0.494,0.408,0.448,0.399,0.408,0.455},
			{0.912,0.885,0.884,0.915,0.878,0.887,0.909,0.888,0.824,0.915,0.888,0.891},
			{0.911,0.886,0.874,0.904,0.876,0.872,0.909,0.892,0.881,0.907,0.875,0.881},
			{0.939,0.947,0.933,0.939,0.944,0.942,0.940,0.959,0.940,0.943,0.948,0.940},
			{0.839,0.801,0.818,0.821,0.812,0.792,0.848,0.768,0.785,0.781,0.803,0.819},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.784,0.795,0.793,0.782,0.794,0.808,0.790,0.805,0.802,0.773,0.804,0.806},
			{0.936,0.922,0.927,0.928,0.944,0.948,0.939,0.939,0.939,0.942,0.945,0.932},
			{0.898,0.878,0.875,0.899,0.857,0.870,0.901,0.875,0.872,0.901,0.875,0.877},
			{0.906,0.881,0.885,0.912,0.877,0.894,0.922,0.898,0.894,0.916,0.904,0.890},
			{0.476,0.430,0.406,0.409,0.474,0.448,0.460,0.458,0.418,0.435,0.476,0.438}};

		static const double endcap_2016_A_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.027,0.027,0.026,0.025,0.026,0.027,0.027,0.027,0.026,0.026,0.026,0.028},
			{0.008,0.009,0.009,0.008,0.009,0.009,0.008,0.009,0.010,0.008,0.009,0.009},
			{0.007,0.008,0.008,0.008,0.008,0.008,0.008,0.008,0.008,0.008,0.008,0.008},
			{0.009,0.008,0.009,0.009,0.009,0.009,0.009,0.008,0.009,0.009,0.009,0.009},
			{0.016,0.016,0.017,0.017,0.016,0.018,0.015,0.018,0.017,0.018,0.017,0.017},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.017,0.017,0.017,0.017,0.018,0.017,0.018,0.016,0.017,0.019,0.017,0.016},
			{0.009,0.010,0.009,0.009,0.009,0.008,0.009,0.009,0.009,0.009,0.009,0.009},
			{0.008,0.008,0.008,0.008,0.008,0.008,0.008,0.008,0.008,0.008,0.008,0.008},
			{0.008,0.009,0.009,0.008,0.009,0.009,0.008,0.009,0.009,0.008,0.009,0.009},
			{0.027,0.027,0.027,0.027,0.027,0.027,0.027,0.027,0.027,0.026,0.030,0.027}};

		static const double barrel_2016_B_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.587,0.512,0.618,0.638,0.481,0.680},
			{0.863,0.626,0.828,0.850,0.829,0.844},
			{0.792,0.613,0.853,0.795,0.720,0.790},
			{0.831,0.613,0.837,0.826,0.809,0.746},
			{0.858,0.594,0.836,0.792,0.858,0.841},
			{0.617,0.517,0.598,0.656,0.551,0.649}};

		static const double barrel_2016_B_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.014,0.012,0.014,0.011,0.012,0.011},
			{0.007,0.007,0.008,0.007,0.007,0.007},
			{0.008,0.007,0.007,0.007,0.007,0.007},
			{0.008,0.007,0.008,0.007,0.007,0.007},
			{0.007,0.007,0.008,0.007,0.007,0.007},
			{0.014,0.011,0.014,0.011,0.012,0.012}};

		static const double endcap_2016_B_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.436,0.418,0.442,0.405,0.438,0.511,0.494,0.408,0.448,0.399,0.408,0.455},
			{0.912,0.885,0.884,0.915,0.878,0.887,0.909,0.888,0.824,0.915,0.888,0.891},
			{0.911,0.886,0.874,0.904,0.876,0.872,0.909,0.892,0.881,0.907,0.875,0.881},
			{0.939,0.947,0.933,0.939,0.944,0.942,0.940,0.959,0.940,0.943,0.948,0.940},
			{0.839,0.801,0.818,0.821,0.812,0.792,0.848,0.768,0.785,0.781,0.803,0.819},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.784,0.795,0.793,0.782,0.794,0.808,0.790,0.805,0.802,0.773,0.804,0.806},
			{0.936,0.922,0.927,0.928,0.944,0.948,0.939,0.939,0.939,0.942,0.945,0.932},
			{0.898,0.878,0.875,0.899,0.857,0.870,0.901,0.875,0.872,0.901,0.875,0.877},
			{0.906,0.881,0.885,0.912,0.877,0.894,0.922,0.898,0.894,0.916,0.904,0.890},
			{0.476,0.430,0.406,0.409,0.474,0.448,0.460,0.458,0.418,0.435,0.476,0.438}};

		static const double endcap_2016_B_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.027,0.027,0.026,0.025,0.026,0.027,0.027,0.027,0.026,0.026,0.026,0.028},
			{0.006,0.007,0.007,0.006,0.008,0.007,0.006,0.007,0.009,0.006,0.007,0.007},
			{0.005,0.006,0.006,0.005,0.006,0.006,0.005,0.006,0.006,0.005,0.006,0.006},
			{0.007,0.006,0.008,0.007,0.007,0.007,0.007,0.006,0.007,0.007,0.007,0.007},
			{0.015,0.016,0.016,0.016,0.015,0.017,0.014,0.018,0.017,0.017,0.016,0.016},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.017,0.016,0.016,0.017,0.017,0.017,0.017,0.016,0.017,0.018,0.016,0.016},
			{0.007,0.008,0.007,0.007,0.007,0.006,0.007,0.007,0.007,0.007,0.007,0.007},
			{0.006,0.006,0.006,0.006,0.006,0.006,0.005,0.006,0.006,0.006,0.006,0.006},
			{0.007,0.007,0.007,0.006,0.007,0.007,0.006,0.007,0.007,0.006,0.007,0.007},
			{0.027,0.027,0.027,0.026,0.027,0.027,0.027,0.026,0.027,0.026,0.029,0.027}};

		unc = 0.;
		if(fabs(eta)<1.05) { // barrel
			int ieta = std::upper_bound(bins_eta_barrel,bins_eta_barrel+nbins_eta_barrel+1,eta) - bins_eta_barrel - 1;
			if(ieta<0 || ieta>=nbins_eta_barrel) return 0.;
			int iphi = std::upper_bound(bins_phi_barrel,bins_phi_barrel+nbins_phi_barrel+1,phi) - bins_phi_barrel - 1;
			if(iphi<0) iphi = nbins_phi_barrel-1;
			if(iphi>=nbins_phi_barrel) iphi = 0;
			unc = ::select_period_array(runnumber,barrel_2015_D_err,barrel_2015_E_err,barrel_2015_F_err,barrel_2015_G_err,barrel_2015_H_err,barrel_2015_J_err,barrel_2016_A_err,barrel_2016_B_err)[ieta][iphi];
			return ::select_period_array(runnumber,barrel_2015_D_val,barrel_2015_E_val,barrel_2015_F_val,barrel_2015_G_val,barrel_2015_H_val,barrel_2015_J_val,barrel_2016_A_val,barrel_2016_B_val)[ieta][iphi];
		} else { // endcap
			int ieta = std::upper_bound(bins_eta_endcap,bins_eta_endcap+nbins_eta_endcap+1,eta) - bins_eta_endcap - 1;
			if(ieta<0 || ieta>=nbins_eta_endcap) return 0.;
			int iphi = std::upper_bound(bins_phi_endcap,bins_phi_endcap+nbins_phi_endcap+1,phi) - bins_phi_endcap - 1;
			if(iphi<0) iphi = nbins_phi_endcap-1;
			if(iphi>=nbins_phi_endcap) iphi = 0;
			unc = ::select_period_array(runnumber,endcap_2015_D_err,endcap_2015_E_err,endcap_2015_F_err,endcap_2015_G_err,endcap_2015_H_err,endcap_2015_J_err,endcap_2016_A_err,endcap_2016_B_err)[ieta][iphi];
			return ::select_period_array(runnumber,endcap_2015_D_val,endcap_2015_E_val,endcap_2015_F_val,endcap_2015_G_val,endcap_2015_H_val,endcap_2015_J_val,endcap_2016_A_val,endcap_2016_B_val)[ieta][iphi];
		}
	}
	double efficiency_data_muXmuY_subleadmuon(double eta, double phi, double& unc,int runnumber)
	{
		static const double bins_eta_barrel[] = {-1.05,-0.91,-0.48,0.00,0.48,0.91,1.05};
		const int nbins_eta_barrel = sizeof(bins_eta_barrel)/sizeof(*bins_eta_barrel)-1;
		static const double bins_eta_endcap[] = {-2.50,-2.40,-1.92,-1.35,-1.15,-1.05,1.05,1.15,1.35,1.92,2.40,2.50};
		const int nbins_eta_endcap = sizeof(bins_eta_endcap)/sizeof(*bins_eta_endcap)-1;
		static const double bins_phi_barrel[] = {-2.95,-2.16,-0.98,-0.20,0.98,2.16,3.34};
		const int nbins_phi_barrel = sizeof(bins_phi_barrel)/sizeof(*bins_phi_barrel)-1;
		static const double bins_phi_endcap[] = {-3.40,-2.88,-2.36,-1.83,-1.31,-0.79,-0.26,0.26,0.79,1.31,1.83,2.36,2.88};
		const int nbins_phi_endcap = sizeof(bins_phi_endcap)/sizeof(*bins_phi_endcap)-1;
		static const double barrel_2015_D_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.977,0.894,0.969,0.972,0.951,0.984},
			{0.972,0.925,0.975,0.980,0.971,0.977},
			{0.963,0.918,0.963,0.944,0.968,0.960},
			{0.960,0.919,0.957,0.946,0.954,0.953},
			{0.971,0.915,0.953,0.974,0.975,0.971},
			{0.963,0.887,0.970,0.973,0.922,0.978}};

		static const double barrel_2015_D_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.013,0.019,0.014,0.012,0.015,0.009},
			{0.007,0.009,0.007,0.005,0.006,0.005},
			{0.007,0.008,0.007,0.007,0.006,0.006},
			{0.008,0.008,0.008,0.007,0.007,0.007},
			{0.007,0.009,0.009,0.005,0.006,0.006},
			{0.014,0.020,0.013,0.010,0.018,0.010}};

		static const double endcap_2015_D_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.925,0.898,0.891,0.962,1.000,0.982,0.983,0.927,0.945,0.896,0.931,0.984},
			{0.957,0.933,0.948,0.967,0.949,0.936,0.967,0.942,0.907,0.974,0.908,0.937},
			{0.988,0.984,0.978,0.979,0.979,0.984,0.972,0.982,0.970,0.976,0.988,0.963},
			{0.976,0.983,0.994,0.985,0.986,0.982,0.944,0.984,0.971,0.957,0.988,0.973},
			{0.955,1.000,0.966,0.952,0.989,0.979,0.978,0.961,0.990,0.974,0.966,0.980},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.764,1.000,0.979,0.987,0.988,0.980,0.873,0.880,0.813,0.947,0.989,1.000},
			{0.785,0.979,0.971,0.966,0.982,0.975,0.947,0.947,0.979,0.967,0.960,0.967},
			{0.985,0.980,0.975,0.978,0.975,0.962,0.975,0.978,0.979,0.952,0.980,0.985},
			{0.964,0.939,0.940,0.935,0.917,0.946,0.957,0.945,0.908,0.946,0.955,0.926},
			{0.943,0.943,0.962,0.950,0.935,0.909,1.000,0.907,0.919,0.900,0.925,0.967}};

		static const double endcap_2015_D_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.046,0.048,0.056,0.036,0.017,0.028,0.026,0.044,0.040,0.045,0.042,0.024},
			{0.013,0.015,0.014,0.011,0.014,0.015,0.011,0.015,0.019,0.011,0.019,0.015},
			{0.006,0.007,0.008,0.008,0.007,0.007,0.009,0.007,0.009,0.009,0.006,0.010},
			{0.013,0.013,0.009,0.012,0.011,0.013,0.019,0.012,0.016,0.019,0.011,0.015},
			{0.028,0.009,0.025,0.026,0.016,0.020,0.022,0.024,0.015,0.025,0.025,0.020},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.046,0.009,0.020,0.020,0.019,0.019,0.044,0.042,0.051,0.028,0.017,0.010},
			{0.032,0.013,0.016,0.016,0.013,0.015,0.018,0.020,0.015,0.018,0.018,0.015},
			{0.007,0.008,0.008,0.008,0.008,0.010,0.008,0.008,0.008,0.012,0.008,0.007},
			{0.013,0.016,0.015,0.015,0.017,0.014,0.013,0.014,0.019,0.015,0.014,0.016},
			{0.041,0.041,0.036,0.047,0.039,0.048,0.019,0.049,0.043,0.052,0.046,0.031}};

		static const double barrel_2015_E_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.978,0.897,0.980,0.980,0.952,0.981},
			{0.974,0.934,0.975,0.979,0.976,0.980},
			{0.969,0.922,0.969,0.936,0.959,0.957},
			{0.974,0.910,0.971,0.973,0.970,0.954},
			{0.974,0.945,0.952,0.977,0.973,0.978},
			{0.974,0.877,0.968,0.972,0.960,0.978}};

		static const double barrel_2015_E_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.004,0.006,0.004,0.003,0.005,0.003},
			{0.002,0.003,0.002,0.002,0.002,0.002},
			{0.002,0.003,0.002,0.003,0.002,0.002},
			{0.002,0.003,0.002,0.002,0.002,0.002},
			{0.002,0.002,0.003,0.002,0.002,0.002},
			{0.004,0.006,0.004,0.003,0.004,0.003}};

		static const double endcap_2015_E_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.947,0.953,0.948,0.954,0.961,0.972,0.958,0.960,0.957,0.945,0.960,0.952},
			{0.966,0.939,0.940,0.958,0.940,0.942,0.967,0.937,0.925,0.964,0.931,0.947},
			{0.981,0.981,0.977,0.984,0.980,0.983,0.985,0.977,0.980,0.982,0.980,0.983},
			{0.978,0.978,0.982,0.983,0.980,0.970,0.949,0.978,0.980,0.905,0.982,0.982},
			{0.980,0.984,0.982,0.989,0.983,0.981,0.986,0.987,0.982,0.897,0.986,0.978},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.775,0.977,0.965,0.981,0.977,0.974,0.831,0.877,0.849,0.970,0.973,0.974},
			{0.830,0.981,0.967,0.982,0.981,0.961,0.951,0.969,0.961,0.951,0.976,0.980},
			{0.978,0.973,0.978,0.985,0.984,0.984,0.973,0.981,0.982,0.980,0.976,0.977},
			{0.956,0.932,0.925,0.955,0.929,0.937,0.955,0.939,0.927,0.964,0.938,0.936},
			{0.959,0.942,0.946,0.957,0.924,0.943,0.956,0.971,0.932,0.959,0.956,0.932}};

		static const double endcap_2015_E_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.011,0.011,0.012,0.011,0.010,0.008,0.010,0.010,0.011,0.012,0.010,0.010},
			{0.004,0.005,0.005,0.004,0.005,0.005,0.004,0.005,0.006,0.004,0.005,0.004},
			{0.002,0.002,0.003,0.002,0.002,0.002,0.002,0.002,0.003,0.002,0.002,0.002},
			{0.004,0.004,0.004,0.004,0.004,0.004,0.006,0.004,0.004,0.009,0.004,0.004},
			{0.005,0.005,0.005,0.004,0.005,0.005,0.005,0.005,0.006,0.013,0.005,0.006},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.015,0.006,0.007,0.005,0.006,0.006,0.013,0.012,0.014,0.007,0.007,0.006},
			{0.010,0.004,0.005,0.004,0.004,0.005,0.006,0.005,0.005,0.006,0.005,0.004},
			{0.002,0.003,0.002,0.002,0.002,0.002,0.003,0.002,0.002,0.002,0.003,0.003},
			{0.004,0.005,0.005,0.004,0.005,0.005,0.004,0.005,0.005,0.004,0.005,0.005},
			{0.011,0.012,0.012,0.010,0.013,0.011,0.011,0.009,0.013,0.010,0.011,0.013}};

		static const double barrel_2015_F_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.975,0.880,0.977,0.979,0.941,0.973},
			{0.973,0.934,0.975,0.978,0.968,0.974},
			{0.970,0.922,0.968,0.934,0.951,0.959},
			{0.958,0.883,0.972,0.973,0.969,0.953},
			{0.967,0.945,0.953,0.974,0.976,0.977},
			{0.969,0.890,0.977,0.964,0.954,0.981}};

		static const double barrel_2015_F_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.005,0.008,0.005,0.004,0.006,0.004},
			{0.003,0.003,0.003,0.002,0.003,0.002},
			{0.003,0.003,0.003,0.003,0.003,0.003},
			{0.003,0.004,0.003,0.002,0.002,0.003},
			{0.003,0.003,0.003,0.002,0.002,0.002},
			{0.005,0.008,0.005,0.005,0.006,0.003}};

		static const double endcap_2015_F_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.957,0.955,0.938,0.949,0.962,0.961,0.967,0.954,0.972,0.963,0.957,0.928},
			{0.963,0.937,0.945,0.953,0.932,0.929,0.904,0.937,0.946,0.958,0.945,0.932},
			{0.975,0.978,0.978,0.982,0.976,0.974,0.976,0.983,0.979,0.978,0.980,0.973},
			{0.970,0.977,0.978,0.980,0.987,0.974,0.951,0.982,0.980,0.923,0.976,0.976},
			{0.984,0.983,0.979,0.988,0.983,0.979,0.986,0.973,0.977,0.872,0.990,0.978},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.814,0.985,0.944,0.977,0.962,0.976,0.843,0.884,0.834,0.978,0.974,0.976},
			{0.820,0.975,0.936,0.986,0.987,0.955,0.947,0.961,0.952,0.953,0.981,0.975},
			{0.977,0.975,0.973,0.983,0.976,0.984,0.974,0.980,0.974,0.975,0.975,0.976},
			{0.946,0.926,0.925,0.952,0.937,0.939,0.948,0.933,0.935,0.960,0.922,0.913},
			{0.952,0.949,0.955,0.950,0.953,0.928,0.945,0.958,0.943,0.967,0.974,0.935}};

		static const double endcap_2015_F_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.012,0.013,0.016,0.015,0.012,0.012,0.011,0.013,0.011,0.013,0.013,0.017},
			{0.005,0.006,0.006,0.005,0.006,0.006,0.007,0.006,0.006,0.005,0.006,0.006},
			{0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003},
			{0.005,0.005,0.005,0.005,0.004,0.005,0.007,0.004,0.005,0.010,0.006,0.005},
			{0.006,0.006,0.007,0.005,0.006,0.007,0.006,0.008,0.008,0.018,0.006,0.007},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.017,0.006,0.011,0.007,0.009,0.008,0.016,0.014,0.018,0.008,0.008,0.008},
			{0.012,0.005,0.008,0.004,0.004,0.007,0.007,0.007,0.008,0.008,0.005,0.005},
			{0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003},
			{0.006,0.006,0.006,0.005,0.006,0.006,0.005,0.006,0.006,0.005,0.007,0.007},
			{0.013,0.014,0.013,0.013,0.014,0.016,0.014,0.014,0.015,0.012,0.011,0.015}};

		static const double barrel_2015_G_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.971,0.893,0.974,0.977,0.948,0.980},
			{0.980,0.928,0.976,0.977,0.968,0.978},
			{0.968,0.927,0.968,0.939,0.956,0.959},
			{0.962,0.888,0.971,0.975,0.969,0.957},
			{0.965,0.931,0.954,0.977,0.976,0.978},
			{0.972,0.907,0.975,0.972,0.956,0.977}};

		static const double barrel_2015_G_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.003,0.005,0.003,0.002,0.004,0.002},
			{0.001,0.002,0.002,0.001,0.002,0.001},
			{0.002,0.002,0.002,0.002,0.002,0.002},
			{0.002,0.003,0.002,0.001,0.002,0.002},
			{0.002,0.002,0.002,0.001,0.001,0.001},
			{0.003,0.004,0.003,0.003,0.004,0.002}};

		static const double endcap_2015_G_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.949,0.955,0.948,0.938,0.964,0.955,0.953,0.949,0.951,0.950,0.958,0.950},
			{0.955,0.927,0.933,0.949,0.937,0.938,0.963,0.937,0.934,0.961,0.944,0.929},
			{0.980,0.976,0.976,0.979,0.981,0.982,0.980,0.979,0.985,0.981,0.981,0.983},
			{0.978,0.975,0.979,0.977,0.981,0.976,0.946,0.981,0.976,0.926,0.981,0.978},
			{0.988,0.974,0.982,0.976,0.980,0.980,0.990,0.985,0.986,0.908,0.987,0.979},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.809,0.979,0.978,0.985,0.975,0.979,0.830,0.871,0.858,0.971,0.984,0.974},
			{0.846,0.974,0.970,0.978,0.975,0.970,0.949,0.961,0.961,0.959,0.976,0.976},
			{0.973,0.970,0.975,0.984,0.980,0.980,0.971,0.975,0.983,0.971,0.965,0.974},
			{0.951,0.927,0.934,0.950,0.926,0.931,0.953,0.938,0.932,0.944,0.941,0.938},
			{0.951,0.935,0.944,0.953,0.948,0.917,0.943,0.948,0.946,0.924,0.952,0.945}};

		static const double endcap_2015_G_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.009,0.008,0.009,0.009,0.007,0.008,0.008,0.008,0.009,0.009,0.008,0.009},
			{0.003,0.004,0.004,0.003,0.004,0.004,0.003,0.004,0.004,0.003,0.004,0.004},
			{0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002},
			{0.003,0.003,0.003,0.003,0.003,0.003,0.004,0.003,0.003,0.006,0.003,0.003},
			{0.003,0.005,0.004,0.004,0.004,0.004,0.003,0.004,0.004,0.010,0.004,0.004},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.011,0.004,0.004,0.004,0.005,0.004,0.010,0.009,0.011,0.005,0.004,0.005},
			{0.007,0.003,0.004,0.003,0.003,0.003,0.005,0.004,0.004,0.005,0.003,0.003},
			{0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.003,0.002},
			{0.003,0.004,0.004,0.003,0.004,0.004,0.003,0.004,0.004,0.004,0.004,0.004},
			{0.009,0.009,0.009,0.008,0.009,0.010,0.009,0.008,0.009,0.011,0.008,0.009}};

		static const double barrel_2015_H_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.958,0.902,0.970,0.977,0.938,0.981},
			{0.957,0.930,0.969,0.976,0.968,0.974},
			{0.959,0.920,0.966,0.940,0.956,0.955},
			{0.964,0.891,0.961,0.975,0.974,0.954},
			{0.976,0.928,0.957,0.977,0.975,0.973},
			{0.975,0.908,0.972,0.969,0.951,0.966}};

		static const double barrel_2015_H_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.007,0.008,0.006,0.004,0.008,0.004},
			{0.004,0.004,0.003,0.002,0.003,0.002},
			{0.003,0.004,0.003,0.003,0.003,0.003},
			{0.003,0.004,0.003,0.002,0.002,0.003},
			{0.003,0.004,0.004,0.002,0.003,0.002},
			{0.005,0.007,0.006,0.005,0.007,0.005}};

		static const double endcap_2015_H_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.958,0.964,0.955,0.949,0.908,0.955,0.953,0.958,0.933,0.967,0.964,0.937},
			{0.963,0.932,0.932,0.961,0.899,0.922,0.960,0.936,0.928,0.964,0.850,0.865},
			{0.983,0.978,0.977,0.979,0.968,0.975,0.980,0.982,0.976,0.984,0.955,0.968},
			{0.976,0.974,0.969,0.983,0.969,0.972,0.943,0.980,0.974,0.930,0.978,0.964},
			{0.977,0.986,0.960,0.976,0.971,0.965,0.978,0.983,0.995,0.916,0.987,0.975},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.775,0.986,0.977,0.978,0.973,0.980,0.807,0.882,0.835,0.964,0.984,0.985},
			{0.860,0.981,0.980,0.980,0.966,0.970,0.953,0.953,0.948,0.969,0.987,0.976},
			{0.976,0.977,0.978,0.984,0.986,0.977,0.968,0.978,0.980,0.985,0.975,0.983},
			{0.956,0.932,0.929,0.958,0.929,0.934,0.944,0.934,0.931,0.966,0.939,0.928},
			{0.965,0.953,0.956,0.960,0.954,0.944,0.938,0.969,0.951,0.931,0.940,0.943}};

		static const double endcap_2015_H_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.014,0.013,0.014,0.015,0.019,0.014,0.014,0.014,0.018,0.014,0.013,0.016},
			{0.005,0.007,0.007,0.005,0.008,0.007,0.005,0.007,0.007,0.006,0.010,0.010},
			{0.003,0.003,0.003,0.003,0.004,0.003,0.003,0.003,0.004,0.003,0.005,0.004},
			{0.005,0.006,0.006,0.005,0.006,0.006,0.008,0.005,0.006,0.011,0.006,0.007},
			{0.008,0.006,0.010,0.008,0.009,0.010,0.008,0.007,0.005,0.017,0.007,0.008},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.020,0.006,0.008,0.008,0.008,0.007,0.018,0.016,0.021,0.011,0.008,0.007},
			{0.012,0.005,0.005,0.005,0.007,0.006,0.008,0.008,0.009,0.008,0.005,0.006},
			{0.003,0.003,0.003,0.003,0.003,0.003,0.004,0.003,0.003,0.003,0.004,0.003},
			{0.005,0.007,0.007,0.005,0.007,0.007,0.006,0.007,0.007,0.005,0.007,0.007},
			{0.013,0.015,0.014,0.013,0.015,0.016,0.016,0.013,0.016,0.020,0.018,0.016}};

		static const double barrel_2015_J_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.972,0.920,0.976,0.979,0.945,0.978},
			{0.978,0.943,0.975,0.979,0.973,0.978},
			{0.971,0.929,0.969,0.938,0.958,0.958},
			{0.967,0.913,0.973,0.975,0.970,0.953},
			{0.975,0.946,0.954,0.974,0.974,0.976},
			{0.973,0.918,0.976,0.975,0.955,0.974}};

		static const double barrel_2015_J_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.002,0.003,0.002,0.002,0.003,0.002},
			{0.001,0.001,0.001,0.001,0.001,0.001},
			{0.001,0.001,0.001,0.001,0.001,0.001},
			{0.001,0.002,0.001,0.001,0.001,0.001},
			{0.001,0.001,0.002,0.001,0.001,0.001},
			{0.002,0.003,0.002,0.002,0.002,0.002}};

		static const double endcap_2015_J_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.959,0.956,0.957,0.947,0.953,0.961,0.948,0.955,0.943,0.954,0.948,0.956},
			{0.958,0.933,0.931,0.958,0.936,0.931,0.963,0.938,0.932,0.962,0.936,0.933},
			{0.979,0.979,0.980,0.982,0.981,0.983,0.981,0.984,0.980,0.981,0.978,0.978},
			{0.973,0.981,0.980,0.977,0.980,0.977,0.950,0.982,0.979,0.930,0.978,0.980},
			{0.984,0.985,0.980,0.985,0.977,0.978,0.989,0.985,0.984,0.912,0.982,0.987},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.818,0.984,0.972,0.983,0.975,0.983,0.835,0.871,0.831,0.964,0.972,0.977},
			{0.855,0.978,0.968,0.973,0.976,0.968,0.952,0.963,0.965,0.969,0.979,0.979},
			{0.975,0.976,0.979,0.981,0.981,0.979,0.974,0.979,0.978,0.980,0.981,0.980},
			{0.954,0.930,0.930,0.954,0.936,0.933,0.948,0.942,0.932,0.955,0.926,0.936},
			{0.961,0.956,0.957,0.951,0.955,0.932,0.942,0.950,0.926,0.961,0.947,0.953}};

		static const double endcap_2015_J_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.005,0.005,0.005,0.006,0.006,0.005,0.006,0.005,0.006,0.006,0.006,0.005},
			{0.002,0.003,0.003,0.002,0.003,0.003,0.002,0.003,0.003,0.002,0.003,0.003},
			{0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001},
			{0.002,0.002,0.002,0.002,0.002,0.002,0.003,0.002,0.002,0.004,0.002,0.002},
			{0.003,0.002,0.003,0.003,0.003,0.003,0.002,0.002,0.003,0.007,0.003,0.002},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.008,0.003,0.003,0.003,0.003,0.003,0.007,0.007,0.008,0.004,0.004,0.003},
			{0.005,0.002,0.003,0.002,0.002,0.003,0.003,0.003,0.003,0.003,0.002,0.002},
			{0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001},
			{0.002,0.003,0.003,0.002,0.003,0.003,0.002,0.003,0.003,0.002,0.003,0.003},
			{0.005,0.006,0.005,0.006,0.005,0.007,0.006,0.006,0.007,0.005,0.006,0.006}};

		static const double barrel_2016_A_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.965,0.928,0.960,0.975,0.936,0.979},
			{0.987,0.971,0.985,0.991,0.985,0.986},
			{0.985,0.954,0.984,0.938,0.971,0.966},
			{0.982,0.937,0.982,0.981,0.978,0.966},
			{0.989,0.971,0.984,0.986,0.987,0.989},
			{0.967,0.934,0.971,0.971,0.950,0.980}};

		static const double barrel_2016_A_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.004,0.005,0.004,0.003,0.005,0.003},
			{0.001,0.002,0.001,0.001,0.001,0.001},
			{0.001,0.002,0.001,0.002,0.002,0.002},
			{0.002,0.002,0.002,0.001,0.001,0.002},
			{0.001,0.002,0.002,0.001,0.001,0.001},
			{0.004,0.004,0.004,0.003,0.004,0.003}};

		static const double endcap_2016_A_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.985,0.982,0.991,0.980,0.987,0.987,0.989,0.978,0.973,0.975,0.985,0.978},
			{0.984,0.986,0.980,0.982,0.984,0.983,0.982,0.981,0.983,0.989,0.986,0.984},
			{0.989,0.989,0.990,0.993,0.987,0.989,0.991,0.989,0.990,0.992,0.989,0.989},
			{0.988,0.992,0.994,0.988,0.991,0.992,0.982,0.991,0.978,0.981,0.988,0.989},
			{0.992,0.992,0.975,0.993,0.982,0.986,0.994,0.991,0.986,0.979,0.981,0.978},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.984,0.988,0.978,0.989,0.975,0.990,0.961,0.989,0.976,0.989,0.982,0.986},
			{0.970,0.990,0.994,0.994,0.991,0.987,0.984,0.987,0.988,0.987,0.991,0.987},
			{0.990,0.987,0.984,0.988,0.993,0.992,0.990,0.992,0.986,0.989,0.989,0.991},
			{0.988,0.986,0.980,0.985,0.986,0.981,0.985,0.983,0.983,0.985,0.982,0.986},
			{0.978,0.985,0.975,0.997,0.989,0.993,0.987,0.981,0.991,0.993,0.977,0.993}};

		static const double endcap_2016_A_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.006,0.006,0.005,0.007,0.005,0.005,0.005,0.007,0.007,0.007,0.006,0.007},
			{0.002,0.002,0.003,0.002,0.002,0.002,0.002,0.003,0.002,0.002,0.002,0.002},
			{0.002,0.002,0.001,0.001,0.002,0.002,0.001,0.002,0.002,0.001,0.002,0.002},
			{0.003,0.002,0.002,0.003,0.002,0.002,0.003,0.002,0.004,0.004,0.003,0.003},
			{0.003,0.003,0.005,0.003,0.004,0.004,0.003,0.003,0.005,0.005,0.005,0.005},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.005,0.004,0.005,0.004,0.005,0.004,0.006,0.004,0.006,0.004,0.005,0.004},
			{0.004,0.003,0.002,0.002,0.002,0.003,0.003,0.003,0.003,0.003,0.002,0.003},
			{0.002,0.002,0.002,0.002,0.001,0.001,0.001,0.001,0.002,0.002,0.002,0.001},
			{0.002,0.002,0.003,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002},
			{0.007,0.006,0.008,0.003,0.005,0.004,0.005,0.006,0.005,0.005,0.007,0.005}};

		static const double barrel_2016_B_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.967,0.929,0.954,0.973,0.941,0.974},
			{0.988,0.968,0.986,0.989,0.985,0.980},
			{0.983,0.955,0.978,0.932,0.966,0.968},
			{0.983,0.938,0.983,0.986,0.981,0.966},
			{0.988,0.976,0.980,0.986,0.984,0.988},
			{0.964,0.939,0.965,0.976,0.945,0.977}};

		static const double barrel_2016_B_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.002,0.002,0.002,0.001,0.002,0.001},
			{0.001,0.001,0.001,0.001,0.001,0.001},
			{0.001,0.001,0.001,0.001,0.001,0.001},
			{0.001,0.001,0.001,0.001,0.001,0.001},
			{0.001,0.001,0.001,0.001,0.001,0.001},
			{0.002,0.002,0.002,0.001,0.002,0.001}};

		static const double endcap_2016_B_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.985,0.984,0.982,0.979,0.985,0.980,0.977,0.978,0.979,0.980,0.981,0.985},
			{0.984,0.985,0.983,0.984,0.983,0.984,0.978,0.984,0.983,0.986,0.983,0.985},
			{0.989,0.988,0.989,0.988,0.987,0.989,0.990,0.990,0.988,0.989,0.988,0.989},
			{0.986,0.989,0.991,0.988,0.989,0.988,0.989,0.988,0.988,0.987,0.987,0.990},
			{0.990,0.988,0.972,0.989,0.967,0.984,0.993,0.986,0.984,0.988,0.985,0.988},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.987,0.985,0.980,0.988,0.972,0.987,0.990,0.990,0.988,0.991,0.979,0.989},
			{0.980,0.989,0.991,0.991,0.990,0.988,0.989,0.988,0.989,0.989,0.991,0.988},
			{0.989,0.989,0.990,0.990,0.989,0.990,0.989,0.989,0.988,0.989,0.991,0.989},
			{0.986,0.983,0.981,0.985,0.984,0.985,0.985,0.984,0.984,0.984,0.982,0.986},
			{0.988,0.982,0.976,0.983,0.983,0.982,0.985,0.984,0.981,0.984,0.982,0.986}};

		static const double endcap_2016_B_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.004,0.003,0.003},
			{0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001},
			{0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001},
			{0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.002,0.001,0.001},
			{0.002,0.002,0.003,0.002,0.003,0.002,0.002,0.002,0.002,0.002,0.002,0.002},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.002,0.002,0.002,0.002,0.003,0.002,0.002,0.002,0.002,0.002,0.003,0.002},
			{0.002,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001},
			{0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001},
			{0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001},
			{0.003,0.003,0.004,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003}};

		unc = 0.;
		if(fabs(eta)<1.05) { // barrel
			int ieta = std::upper_bound(bins_eta_barrel,bins_eta_barrel+nbins_eta_barrel+1,eta) - bins_eta_barrel - 1;
			if(ieta<0 || ieta>=nbins_eta_barrel) return 0.;
			int iphi = std::upper_bound(bins_phi_barrel,bins_phi_barrel+nbins_phi_barrel+1,phi) - bins_phi_barrel - 1;
			if(iphi<0) iphi = nbins_phi_barrel-1;
			if(iphi>=nbins_phi_barrel) iphi = 0;
			unc = ::select_period_array(runnumber,barrel_2015_D_err,barrel_2015_E_err,barrel_2015_F_err,barrel_2015_G_err,barrel_2015_H_err,barrel_2015_J_err,barrel_2016_A_err,barrel_2016_B_err)[ieta][iphi];
			return ::select_period_array(runnumber,barrel_2015_D_val,barrel_2015_E_val,barrel_2015_F_val,barrel_2015_G_val,barrel_2015_H_val,barrel_2015_J_val,barrel_2016_A_val,barrel_2016_B_val)[ieta][iphi];
		} else { // endcap
			int ieta = std::upper_bound(bins_eta_endcap,bins_eta_endcap+nbins_eta_endcap+1,eta) - bins_eta_endcap - 1;
			if(ieta<0 || ieta>=nbins_eta_endcap) return 0.;
			int iphi = std::upper_bound(bins_phi_endcap,bins_phi_endcap+nbins_phi_endcap+1,phi) - bins_phi_endcap - 1;
			if(iphi<0) iphi = nbins_phi_endcap-1;
			if(iphi>=nbins_phi_endcap) iphi = 0;
			unc = ::select_period_array(runnumber,endcap_2015_D_err,endcap_2015_E_err,endcap_2015_F_err,endcap_2015_G_err,endcap_2015_H_err,endcap_2015_J_err,endcap_2016_A_err,endcap_2016_B_err)[ieta][iphi];
			return ::select_period_array(runnumber,endcap_2015_D_val,endcap_2015_E_val,endcap_2015_F_val,endcap_2015_G_val,endcap_2015_H_val,endcap_2015_J_val,endcap_2016_A_val,endcap_2016_B_val)[ieta][iphi];
		}
	}
	double efficiency_mc_muXmuY_subleadmuon(double eta, double phi, double& unc,int runnumber)
	{
		static const double bins_eta_barrel[] = {-1.05,-0.91,-0.48,0.00,0.48,0.91,1.05};
		const int nbins_eta_barrel = sizeof(bins_eta_barrel)/sizeof(*bins_eta_barrel)-1;
		static const double bins_eta_endcap[] = {-2.50,-2.40,-1.92,-1.35,-1.15,-1.05,1.05,1.15,1.35,1.92,2.40,2.50};
		const int nbins_eta_endcap = sizeof(bins_eta_endcap)/sizeof(*bins_eta_endcap)-1;
		static const double bins_phi_barrel[] = {-2.95,-2.16,-0.98,-0.20,0.98,2.16,3.34};
		const int nbins_phi_barrel = sizeof(bins_phi_barrel)/sizeof(*bins_phi_barrel)-1;
		static const double bins_phi_endcap[] = {-3.40,-2.88,-2.36,-1.83,-1.31,-0.79,-0.26,0.26,0.79,1.31,1.83,2.36,2.88};
		const int nbins_phi_endcap = sizeof(bins_phi_endcap)/sizeof(*bins_phi_endcap)-1;
		static const double barrel_2015_D_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.980,0.949,0.969,0.975,0.969,0.984},
			{0.990,0.983,0.990,0.991,0.992,0.989},
			{0.982,0.951,0.985,0.963,0.975,0.975},
			{0.989,0.950,0.987,0.991,0.983,0.967},
			{0.987,0.982,0.988,0.991,0.988,0.990},
			{0.968,0.957,0.973,0.983,0.978,0.984}};

		static const double barrel_2015_D_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.007,0.008,0.008,0.007,0.008,0.007},
			{0.006,0.006,0.006,0.006,0.006,0.006},
			{0.006,0.006,0.006,0.006,0.006,0.006},
			{0.006,0.006,0.006,0.006,0.006,0.006},
			{0.006,0.006,0.006,0.006,0.006,0.006},
			{0.008,0.008,0.008,0.007,0.007,0.007}};

		static const double endcap_2015_D_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.985,0.990,0.992,0.987,0.984,0.995,0.977,0.990,0.988,0.979,0.995,0.985},
			{0.991,0.989,0.990,0.992,0.989,0.984,0.993,0.993,0.986,0.991,0.989,0.988},
			{0.993,0.993,0.989,0.995,0.995,0.994,0.991,0.994,0.993,0.994,0.994,0.988},
			{0.997,0.988,0.994,0.992,0.994,0.995,0.987,0.992,0.990,0.991,0.988,0.989},
			{0.984,0.975,0.980,0.997,0.985,0.988,0.996,0.995,0.989,0.998,0.977,0.994},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.987,0.987,0.981,0.991,0.984,0.985,0.988,0.994,0.996,0.994,0.985,0.982},
			{0.995,0.993,0.997,0.991,0.995,0.995,0.990,0.993,0.994,0.997,0.989,0.992},
			{0.991,0.992,0.994,0.994,0.995,0.990,0.995,0.995,0.994,0.992,0.993,0.991},
			{0.990,0.991,0.990,0.991,0.989,0.983,0.989,0.994,0.988,0.982,0.987,0.985},
			{0.982,0.987,0.983,0.989,0.984,0.992,0.986,0.984,0.982,0.987,1.000,0.978}};

		static const double endcap_2015_D_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.009,0.009,0.008,0.009,0.010,0.008,0.013,0.009,0.009,0.012,0.008,0.010},
			{0.007,0.007,0.007,0.007,0.007,0.007,0.007,0.007,0.007,0.007,0.007,0.007},
			{0.007,0.007,0.007,0.007,0.007,0.007,0.007,0.007,0.007,0.007,0.007,0.007},
			{0.007,0.008,0.007,0.007,0.007,0.007,0.008,0.007,0.007,0.008,0.008,0.008},
			{0.009,0.010,0.009,0.007,0.009,0.009,0.008,0.007,0.009,0.007,0.010,0.008},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.009,0.009,0.009,0.008,0.009,0.009,0.008,0.008,0.007,0.008,0.009,0.009},
			{0.007,0.007,0.007,0.007,0.007,0.007,0.008,0.007,0.007,0.007,0.008,0.007},
			{0.007,0.007,0.007,0.007,0.007,0.007,0.007,0.007,0.007,0.007,0.007,0.007},
			{0.007,0.007,0.007,0.007,0.007,0.008,0.007,0.007,0.007,0.008,0.007,0.007},
			{0.010,0.010,0.010,0.010,0.011,0.009,0.010,0.010,0.012,0.010,0.007,0.012}};

		static const double barrel_2015_E_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.980,0.949,0.969,0.975,0.969,0.984},
			{0.990,0.983,0.990,0.991,0.992,0.989},
			{0.982,0.951,0.985,0.963,0.975,0.975},
			{0.989,0.950,0.987,0.991,0.983,0.967},
			{0.987,0.982,0.988,0.991,0.988,0.990},
			{0.968,0.957,0.973,0.983,0.978,0.984}};

		static const double barrel_2015_E_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.007,0.008,0.008,0.007,0.007,0.006},
			{0.006,0.006,0.006,0.005,0.005,0.005},
			{0.006,0.006,0.006,0.006,0.006,0.006},
			{0.006,0.006,0.006,0.005,0.006,0.006},
			{0.006,0.006,0.006,0.005,0.005,0.005},
			{0.008,0.008,0.008,0.006,0.007,0.006}};

		static const double endcap_2015_E_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.985,0.990,0.992,0.987,0.984,0.995,0.977,0.990,0.988,0.979,0.995,0.985},
			{0.991,0.989,0.990,0.992,0.989,0.984,0.993,0.993,0.986,0.991,0.989,0.988},
			{0.993,0.993,0.989,0.995,0.995,0.994,0.991,0.994,0.993,0.994,0.994,0.988},
			{0.997,0.988,0.994,0.992,0.994,0.995,0.987,0.992,0.990,0.991,0.988,0.989},
			{0.984,0.975,0.980,0.997,0.985,0.988,0.996,0.995,0.989,0.998,0.977,0.994},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.987,0.987,0.981,0.991,0.984,0.985,0.988,0.994,0.996,0.994,0.985,0.982},
			{0.995,0.993,0.997,0.991,0.995,0.995,0.990,0.993,0.994,0.997,0.989,0.992},
			{0.991,0.992,0.994,0.994,0.995,0.990,0.995,0.995,0.994,0.992,0.993,0.991},
			{0.990,0.991,0.990,0.991,0.989,0.983,0.989,0.994,0.988,0.982,0.987,0.985},
			{0.982,0.987,0.983,0.989,0.984,0.992,0.986,0.984,0.982,0.987,1.000,0.978}};

		static const double endcap_2015_E_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.007,0.007,0.006,0.007,0.008,0.005,0.011,0.008,0.007,0.011,0.005,0.008},
			{0.004,0.004,0.004,0.004,0.004,0.005,0.004,0.004,0.005,0.004,0.004,0.004},
			{0.004,0.004,0.004,0.004,0.004,0.004,0.004,0.004,0.004,0.004,0.004,0.004},
			{0.004,0.005,0.004,0.004,0.004,0.004,0.005,0.005,0.005,0.005,0.005,0.005},
			{0.007,0.009,0.007,0.004,0.007,0.006,0.005,0.005,0.006,0.004,0.008,0.005},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.007,0.007,0.007,0.005,0.007,0.007,0.006,0.005,0.004,0.005,0.007,0.008},
			{0.004,0.004,0.004,0.005,0.004,0.004,0.005,0.004,0.004,0.004,0.005,0.004},
			{0.004,0.004,0.004,0.004,0.004,0.004,0.004,0.004,0.004,0.004,0.004,0.004},
			{0.004,0.004,0.004,0.004,0.004,0.005,0.004,0.004,0.005,0.005,0.004,0.005},
			{0.009,0.008,0.009,0.008,0.009,0.006,0.008,0.008,0.010,0.008,0.003,0.010}};

		static const double barrel_2015_F_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.980,0.949,0.969,0.975,0.969,0.984},
			{0.990,0.983,0.990,0.991,0.992,0.989},
			{0.982,0.951,0.985,0.963,0.975,0.975},
			{0.989,0.950,0.987,0.991,0.983,0.967},
			{0.987,0.982,0.988,0.991,0.988,0.990},
			{0.968,0.957,0.973,0.983,0.978,0.984}};

		static const double barrel_2015_F_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.007,0.008,0.008,0.007,0.008,0.007},
			{0.006,0.006,0.006,0.006,0.006,0.006},
			{0.006,0.006,0.006,0.006,0.006,0.006},
			{0.006,0.006,0.006,0.006,0.006,0.006},
			{0.006,0.006,0.006,0.006,0.006,0.006},
			{0.008,0.008,0.008,0.007,0.007,0.007}};

		static const double endcap_2015_F_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.985,0.990,0.992,0.987,0.984,0.995,0.977,0.990,0.988,0.979,0.995,0.985},
			{0.991,0.989,0.990,0.992,0.989,0.984,0.993,0.993,0.986,0.991,0.989,0.988},
			{0.993,0.993,0.989,0.995,0.995,0.994,0.991,0.994,0.993,0.994,0.994,0.988},
			{0.997,0.988,0.994,0.992,0.994,0.995,0.987,0.992,0.990,0.991,0.988,0.989},
			{0.984,0.975,0.980,0.997,0.985,0.988,0.996,0.995,0.989,0.998,0.977,0.994},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.987,0.987,0.981,0.991,0.984,0.985,0.988,0.994,0.996,0.994,0.985,0.982},
			{0.995,0.993,0.997,0.991,0.995,0.995,0.990,0.993,0.994,0.997,0.989,0.992},
			{0.991,0.992,0.994,0.994,0.995,0.990,0.995,0.995,0.994,0.992,0.993,0.991},
			{0.990,0.991,0.990,0.991,0.989,0.983,0.989,0.994,0.988,0.982,0.987,0.985},
			{0.982,0.987,0.983,0.989,0.984,0.992,0.986,0.984,0.982,0.987,1.000,0.978}};

		static const double endcap_2015_F_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.007,0.007,0.007,0.007,0.009,0.006,0.011,0.008,0.008,0.011,0.006,0.009},
			{0.005,0.005,0.005,0.005,0.005,0.005,0.004,0.005,0.005,0.005,0.005,0.005},
			{0.004,0.004,0.005,0.004,0.004,0.004,0.005,0.004,0.004,0.004,0.004,0.005},
			{0.004,0.005,0.005,0.005,0.005,0.005,0.006,0.005,0.005,0.005,0.006,0.006},
			{0.007,0.009,0.008,0.004,0.007,0.007,0.005,0.005,0.007,0.004,0.009,0.006},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.007,0.007,0.007,0.006,0.007,0.007,0.006,0.005,0.005,0.005,0.007,0.008},
			{0.005,0.005,0.004,0.005,0.005,0.004,0.005,0.005,0.005,0.004,0.006,0.005},
			{0.004,0.004,0.004,0.004,0.004,0.005,0.004,0.004,0.004,0.005,0.004,0.005},
			{0.005,0.005,0.005,0.005,0.005,0.005,0.005,0.004,0.005,0.006,0.005,0.005},
			{0.009,0.008,0.009,0.008,0.010,0.007,0.009,0.009,0.010,0.009,0.004,0.011}};

		static const double barrel_2015_G_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.980,0.949,0.969,0.975,0.969,0.984},
			{0.990,0.983,0.990,0.991,0.992,0.989},
			{0.982,0.951,0.985,0.963,0.975,0.975},
			{0.989,0.950,0.987,0.991,0.983,0.967},
			{0.987,0.982,0.988,0.991,0.988,0.990},
			{0.968,0.957,0.973,0.983,0.978,0.984}};

		static const double barrel_2015_G_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.007,0.008,0.008,0.007,0.007,0.006},
			{0.006,0.006,0.006,0.005,0.005,0.005},
			{0.006,0.006,0.006,0.006,0.006,0.006},
			{0.006,0.006,0.006,0.005,0.006,0.006},
			{0.006,0.006,0.006,0.005,0.006,0.005},
			{0.008,0.008,0.008,0.006,0.007,0.006}};

		static const double endcap_2015_G_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.985,0.990,0.992,0.987,0.984,0.995,0.977,0.990,0.988,0.979,0.995,0.985},
			{0.991,0.989,0.990,0.992,0.989,0.984,0.993,0.993,0.986,0.991,0.989,0.988},
			{0.993,0.993,0.989,0.995,0.995,0.994,0.991,0.994,0.993,0.994,0.994,0.988},
			{0.997,0.988,0.994,0.992,0.994,0.995,0.987,0.992,0.990,0.991,0.988,0.989},
			{0.984,0.975,0.980,0.997,0.985,0.988,0.996,0.995,0.989,0.998,0.977,0.994},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.987,0.987,0.981,0.991,0.984,0.985,0.988,0.994,0.996,0.994,0.985,0.982},
			{0.995,0.993,0.997,0.991,0.995,0.995,0.990,0.993,0.994,0.997,0.989,0.992},
			{0.991,0.992,0.994,0.994,0.995,0.990,0.995,0.995,0.994,0.992,0.993,0.991},
			{0.990,0.991,0.990,0.991,0.989,0.983,0.989,0.994,0.988,0.982,0.987,0.985},
			{0.982,0.987,0.983,0.989,0.984,0.992,0.986,0.984,0.982,0.987,1.000,0.978}};

		static const double endcap_2015_G_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.007,0.007,0.007,0.007,0.009,0.006,0.012,0.008,0.008,0.011,0.006,0.009},
			{0.005,0.005,0.005,0.005,0.005,0.005,0.005,0.005,0.005,0.005,0.005,0.005},
			{0.005,0.004,0.005,0.004,0.004,0.005,0.005,0.004,0.005,0.004,0.004,0.005},
			{0.005,0.006,0.005,0.005,0.005,0.005,0.006,0.005,0.005,0.006,0.006,0.006},
			{0.007,0.009,0.008,0.005,0.007,0.007,0.006,0.005,0.007,0.004,0.009,0.006},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.007,0.007,0.008,0.006,0.007,0.007,0.006,0.006,0.005,0.006,0.007,0.008},
			{0.005,0.005,0.005,0.005,0.005,0.005,0.005,0.005,0.005,0.004,0.006,0.005},
			{0.005,0.005,0.004,0.005,0.004,0.005,0.004,0.004,0.004,0.005,0.005,0.005},
			{0.005,0.005,0.005,0.005,0.005,0.006,0.005,0.005,0.005,0.006,0.005,0.005},
			{0.009,0.008,0.009,0.008,0.010,0.007,0.009,0.009,0.011,0.009,0.004,0.011}};

		static const double barrel_2015_H_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.980,0.949,0.969,0.975,0.969,0.984},
			{0.990,0.983,0.990,0.991,0.992,0.989},
			{0.982,0.951,0.985,0.963,0.975,0.975},
			{0.989,0.950,0.987,0.991,0.983,0.967},
			{0.987,0.982,0.988,0.991,0.988,0.990},
			{0.968,0.957,0.973,0.983,0.978,0.984}};

		static const double barrel_2015_H_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.008,0.009,0.009,0.008,0.008,0.007},
			{0.007,0.007,0.007,0.007,0.007,0.007},
			{0.007,0.007,0.007,0.007,0.007,0.007},
			{0.007,0.007,0.007,0.007,0.007,0.007},
			{0.007,0.007,0.007,0.007,0.007,0.007},
			{0.009,0.008,0.008,0.007,0.008,0.007}};

		static const double endcap_2015_H_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.985,0.990,0.992,0.987,0.984,0.995,0.977,0.990,0.988,0.979,0.995,0.985},
			{0.991,0.989,0.990,0.992,0.989,0.984,0.993,0.993,0.986,0.991,0.989,0.988},
			{0.993,0.993,0.989,0.995,0.995,0.994,0.991,0.994,0.993,0.994,0.994,0.988},
			{0.997,0.988,0.994,0.992,0.994,0.995,0.987,0.992,0.990,0.991,0.988,0.989},
			{0.984,0.975,0.980,0.997,0.985,0.988,0.996,0.995,0.989,0.998,0.977,0.994},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.987,0.987,0.981,0.991,0.984,0.985,0.988,0.994,0.996,0.994,0.985,0.982},
			{0.995,0.993,0.997,0.991,0.995,0.995,0.990,0.993,0.994,0.997,0.989,0.992},
			{0.991,0.992,0.994,0.994,0.995,0.990,0.995,0.995,0.994,0.992,0.993,0.991},
			{0.990,0.991,0.990,0.991,0.989,0.983,0.989,0.994,0.988,0.982,0.987,0.985},
			{0.982,0.987,0.983,0.989,0.984,0.992,0.986,0.984,0.982,0.987,1.000,0.978}};

		static const double endcap_2015_H_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.008,0.008,0.007,0.008,0.009,0.007,0.012,0.009,0.008,0.012,0.007,0.009},
			{0.006,0.006,0.006,0.006,0.006,0.006,0.005,0.006,0.006,0.006,0.006,0.006},
			{0.005,0.005,0.006,0.005,0.005,0.006,0.006,0.005,0.005,0.005,0.005,0.006},
			{0.006,0.006,0.006,0.006,0.006,0.006,0.006,0.006,0.006,0.006,0.007,0.006},
			{0.008,0.010,0.008,0.006,0.008,0.008,0.006,0.006,0.008,0.005,0.009,0.007},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.008,0.008,0.008,0.007,0.008,0.008,0.007,0.006,0.006,0.006,0.008,0.009},
			{0.006,0.006,0.005,0.006,0.006,0.006,0.006,0.006,0.006,0.005,0.007,0.006},
			{0.005,0.006,0.005,0.005,0.005,0.006,0.005,0.005,0.005,0.006,0.005,0.006},
			{0.006,0.006,0.006,0.006,0.006,0.006,0.006,0.006,0.006,0.006,0.006,0.006},
			{0.009,0.009,0.009,0.009,0.010,0.008,0.009,0.009,0.011,0.009,0.005,0.011}};

		static const double barrel_2015_J_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.980,0.949,0.969,0.975,0.969,0.984},
			{0.990,0.983,0.990,0.991,0.992,0.989},
			{0.982,0.951,0.985,0.963,0.975,0.975},
			{0.989,0.950,0.987,0.991,0.983,0.967},
			{0.987,0.982,0.988,0.991,0.988,0.990},
			{0.968,0.957,0.973,0.983,0.978,0.984}};

		static const double barrel_2015_J_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.006,0.007,0.007,0.006,0.007,0.006},
			{0.005,0.005,0.005,0.005,0.005,0.005},
			{0.005,0.005,0.005,0.005,0.005,0.005},
			{0.005,0.005,0.005,0.005,0.005,0.005},
			{0.005,0.005,0.005,0.005,0.005,0.005},
			{0.007,0.007,0.007,0.006,0.006,0.006}};

		static const double endcap_2015_J_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.985,0.990,0.992,0.987,0.984,0.995,0.977,0.990,0.988,0.979,0.995,0.985},
			{0.991,0.989,0.990,0.992,0.989,0.984,0.993,0.993,0.986,0.991,0.989,0.988},
			{0.993,0.993,0.989,0.995,0.995,0.994,0.991,0.994,0.993,0.994,0.994,0.988},
			{0.997,0.988,0.994,0.992,0.994,0.995,0.987,0.992,0.990,0.991,0.988,0.989},
			{0.984,0.975,0.980,0.997,0.985,0.988,0.996,0.995,0.989,0.998,0.977,0.994},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.987,0.987,0.981,0.991,0.984,0.985,0.988,0.994,0.996,0.994,0.985,0.982},
			{0.995,0.993,0.997,0.991,0.995,0.995,0.990,0.993,0.994,0.997,0.989,0.992},
			{0.991,0.992,0.994,0.994,0.995,0.990,0.995,0.995,0.994,0.992,0.993,0.991},
			{0.990,0.991,0.990,0.991,0.989,0.983,0.989,0.994,0.988,0.982,0.987,0.985},
			{0.982,0.987,0.983,0.989,0.984,0.992,0.986,0.984,0.982,0.987,1.000,0.978}};

		static const double endcap_2015_J_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.008,0.008,0.007,0.007,0.009,0.006,0.012,0.008,0.008,0.011,0.006,0.009},
			{0.005,0.005,0.005,0.005,0.005,0.006,0.005,0.005,0.006,0.005,0.005,0.005},
			{0.005,0.005,0.005,0.005,0.005,0.005,0.005,0.005,0.005,0.005,0.005,0.005},
			{0.005,0.006,0.005,0.005,0.005,0.005,0.006,0.006,0.006,0.006,0.006,0.006},
			{0.008,0.009,0.008,0.005,0.007,0.007,0.006,0.006,0.007,0.005,0.009,0.006},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.007,0.007,0.008,0.006,0.007,0.008,0.007,0.006,0.005,0.006,0.007,0.008},
			{0.005,0.005,0.005,0.006,0.005,0.005,0.006,0.005,0.005,0.005,0.006,0.005},
			{0.005,0.005,0.005,0.005,0.005,0.005,0.005,0.005,0.005,0.005,0.005,0.005},
			{0.005,0.005,0.005,0.005,0.005,0.006,0.005,0.005,0.005,0.006,0.005,0.006},
			{0.009,0.009,0.009,0.008,0.010,0.007,0.009,0.009,0.011,0.009,0.004,0.011}};

		static const double barrel_2016_A_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.968,0.958,0.962,0.978,0.977,0.985},
			{0.989,0.981,0.990,0.989,0.991,0.990},
			{0.986,0.950,0.985,0.955,0.973,0.976},
			{0.985,0.945,0.985,0.990,0.985,0.972},
			{0.991,0.983,0.988,0.990,0.990,0.990},
			{0.964,0.955,0.977,0.982,0.976,0.984}};

		static const double barrel_2016_A_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.005,0.005,0.006,0.004,0.004,0.003},
			{0.002,0.002,0.002,0.002,0.002,0.002},
			{0.002,0.003,0.002,0.003,0.003,0.003},
			{0.002,0.003,0.003,0.002,0.002,0.003},
			{0.002,0.002,0.002,0.002,0.002,0.002},
			{0.005,0.005,0.004,0.003,0.004,0.003}};

		static const double endcap_2016_A_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.991,0.981,0.988,0.979,0.993,0.990,0.989,0.990,0.982,0.989,0.979,0.992},
			{0.989,0.990,0.993,0.989,0.992,0.994,0.992,0.987,0.989,0.993,0.990,0.989},
			{0.994,0.994,0.995,0.992,0.994,0.992,0.993,0.993,0.993,0.993,0.991,0.993},
			{0.994,0.994,0.991,0.990,0.995,0.992,0.986,0.994,0.993,0.994,0.988,0.993},
			{0.993,0.989,0.989,0.996,0.974,0.986,0.990,0.987,0.984,0.995,0.984,0.996},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.995,0.987,0.972,0.988,0.980,0.991,0.991,0.993,1.000,0.994,0.988,0.993},
			{0.990,0.991,0.995,0.989,0.992,0.997,0.993,0.993,0.993,0.993,0.995,0.991},
			{0.993,0.995,0.993,0.992,0.990,0.993,0.992,0.993,0.994,0.992,0.993,0.994},
			{0.986,0.989,0.988,0.988,0.985,0.987,0.989,0.988,0.988,0.989,0.993,0.987},
			{0.986,0.992,0.981,0.991,0.986,0.993,0.998,0.995,0.990,0.990,0.980,0.978}};

		static const double endcap_2016_A_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.006,0.007,0.006,0.008,0.004,0.005,0.006,0.005,0.007,0.007,0.008,0.005},
			{0.002,0.003,0.002,0.002,0.002,0.002,0.002,0.003,0.003,0.002,0.002,0.003},
			{0.002,0.002,0.001,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002},
			{0.003,0.002,0.003,0.003,0.002,0.003,0.004,0.003,0.003,0.002,0.003,0.003},
			{0.003,0.004,0.004,0.003,0.006,0.005,0.004,0.004,0.005,0.003,0.006,0.003},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.003,0.004,0.007,0.004,0.006,0.004,0.004,0.004,0.001,0.003,0.005,0.004},
			{0.003,0.003,0.002,0.003,0.003,0.002,0.003,0.002,0.003,0.003,0.002,0.003},
			{0.002,0.001,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002},
			{0.003,0.002,0.003,0.003,0.003,0.003,0.002,0.003,0.003,0.002,0.002,0.003},
			{0.007,0.005,0.008,0.005,0.006,0.004,0.002,0.003,0.006,0.005,0.008,0.008}};

		static const double barrel_2016_B_val[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.968,0.958,0.962,0.978,0.977,0.985},
			{0.989,0.981,0.990,0.989,0.991,0.990},
			{0.986,0.950,0.985,0.955,0.973,0.976},
			{0.985,0.945,0.985,0.990,0.985,0.972},
			{0.991,0.983,0.988,0.990,0.990,0.990},
			{0.964,0.955,0.977,0.982,0.976,0.984}};

		static const double barrel_2016_B_err[nbins_eta_barrel][nbins_phi_barrel] = {
			{0.005,0.004,0.005,0.003,0.003,0.003},
			{0.002,0.002,0.002,0.002,0.001,0.002},
			{0.002,0.003,0.002,0.003,0.002,0.002},
			{0.002,0.003,0.002,0.001,0.002,0.002},
			{0.002,0.002,0.002,0.002,0.002,0.002},
			{0.005,0.005,0.004,0.003,0.004,0.003}};

		static const double endcap_2016_B_val[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.991,0.981,0.988,0.979,0.993,0.990,0.989,0.990,0.982,0.989,0.979,0.992},
			{0.989,0.990,0.993,0.989,0.992,0.994,0.992,0.987,0.989,0.993,0.990,0.989},
			{0.994,0.994,0.995,0.992,0.994,0.992,0.993,0.993,0.993,0.993,0.991,0.993},
			{0.994,0.994,0.991,0.990,0.995,0.992,0.986,0.994,0.993,0.994,0.988,0.993},
			{0.993,0.989,0.989,0.996,0.974,0.986,0.990,0.987,0.984,0.995,0.984,0.996},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.995,0.987,0.972,0.988,0.980,0.991,0.991,0.993,1.000,0.994,0.988,0.993},
			{0.990,0.991,0.995,0.989,0.992,0.997,0.993,0.993,0.993,0.993,0.995,0.991},
			{0.993,0.995,0.993,0.992,0.990,0.993,0.992,0.993,0.994,0.992,0.993,0.994},
			{0.986,0.989,0.988,0.988,0.985,0.987,0.989,0.988,0.988,0.989,0.993,0.987},
			{0.986,0.992,0.981,0.991,0.986,0.993,0.998,0.995,0.990,0.990,0.980,0.978}};

		static const double endcap_2016_B_err[nbins_eta_endcap][nbins_phi_endcap] = {
			{0.006,0.007,0.006,0.008,0.004,0.005,0.006,0.005,0.007,0.007,0.008,0.005},
			{0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.003,0.002,0.002,0.002,0.002},
			{0.001,0.001,0.001,0.002,0.001,0.002,0.002,0.002,0.002,0.002,0.002,0.002},
			{0.002,0.002,0.003,0.003,0.002,0.003,0.004,0.002,0.002,0.002,0.003,0.003},
			{0.003,0.004,0.004,0.003,0.006,0.005,0.004,0.004,0.005,0.003,0.005,0.003},
			{0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},
			{0.003,0.004,0.007,0.004,0.005,0.004,0.004,0.004,0.000,0.003,0.005,0.004},
			{0.003,0.003,0.002,0.003,0.002,0.002,0.002,0.002,0.003,0.003,0.002,0.003},
			{0.002,0.001,0.002,0.002,0.002,0.002,0.002,0.002,0.001,0.002,0.002,0.001},
			{0.003,0.002,0.002,0.002,0.003,0.003,0.002,0.002,0.002,0.002,0.002,0.003},
			{0.007,0.005,0.008,0.005,0.006,0.004,0.002,0.003,0.005,0.005,0.008,0.008}};

		unc = 0.;
		if(fabs(eta)<1.05) { // barrel
			int ieta = std::upper_bound(bins_eta_barrel,bins_eta_barrel+nbins_eta_barrel+1,eta) - bins_eta_barrel - 1;
			if(ieta<0 || ieta>=nbins_eta_barrel) return 0.;
			int iphi = std::upper_bound(bins_phi_barrel,bins_phi_barrel+nbins_phi_barrel+1,phi) - bins_phi_barrel - 1;
			if(iphi<0) iphi = nbins_phi_barrel-1;
			if(iphi>=nbins_phi_barrel) iphi = 0;
			unc = ::select_period_array(runnumber,barrel_2015_D_err,barrel_2015_E_err,barrel_2015_F_err,barrel_2015_G_err,barrel_2015_H_err,barrel_2015_J_err,barrel_2016_A_err,barrel_2016_B_err)[ieta][iphi];
			return ::select_period_array(runnumber,barrel_2015_D_val,barrel_2015_E_val,barrel_2015_F_val,barrel_2015_G_val,barrel_2015_H_val,barrel_2015_J_val,barrel_2016_A_val,barrel_2016_B_val)[ieta][iphi];
		} else { // endcap
			int ieta = std::upper_bound(bins_eta_endcap,bins_eta_endcap+nbins_eta_endcap+1,eta) - bins_eta_endcap - 1;
			if(ieta<0 || ieta>=nbins_eta_endcap) return 0.;
			int iphi = std::upper_bound(bins_phi_endcap,bins_phi_endcap+nbins_phi_endcap+1,phi) - bins_phi_endcap - 1;
			if(iphi<0) iphi = nbins_phi_endcap-1;
			if(iphi>=nbins_phi_endcap) iphi = 0;
			unc = ::select_period_array(runnumber,endcap_2015_D_err,endcap_2015_E_err,endcap_2015_F_err,endcap_2015_G_err,endcap_2015_H_err,endcap_2015_J_err,endcap_2016_A_err,endcap_2016_B_err)[ieta][iphi];
			return ::select_period_array(runnumber,endcap_2015_D_val,endcap_2015_E_val,endcap_2015_F_val,endcap_2015_G_val,endcap_2015_H_val,endcap_2015_J_val,endcap_2016_A_val,endcap_2016_B_val)[ieta][iphi];
		}
	}
}
